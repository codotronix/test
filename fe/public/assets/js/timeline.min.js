!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const i=["b","i","u","c","s","br","hr"];let o,c,s=window.$,l=window;l.rto=l.rto||{};let r,a=[];l.rto.copyToClipboard=h;const d=(e,t)=>({stID:e,selectedCID:t}),f=e=>l.DOMPurify.sanitize(e,{ALLOWED_TAGS:i});function u(){"function"==typeof r.timelineWillRender&&r.timelineWillRender();let e="";for(let t=0;t<a.length;t++){e+=p(a[t],t,t===a.length-1)}o.html(e),function(e=a.length-1){let t=o.find(".storyboard-item").eq(e);s("html, body").animate({scrollTop:(t&&t.offset()?t.offset().top:100)-100},500)}(),o.find(".choices .inner-container").each((function(){let e=s(this).find(".choice.selected");if(0===e.length)return;let t=e.eq(0).offset().left-41;s(this).scrollLeft(t)})),"function"==typeof r.timelineDidRender&&r.timelineDidRender()}function p(e,t,n){let i=c.storylets[e.stID],o=(s=i.choices,r=e.selectedCID,s.reduce((e,t,n)=>{let i=c.choices[t];return e+`\n <div class="choice ${t===r?"selected":""}" data-cid="${i.id}">\n <div class="c-i">\n Choice ${n+1}\n <span class="idchip">ID: ${i.id} <i class="far fa-copy ico-copy"></i></span>\n </div>\n <span class="c-text">${f(i.text)}</span>\n </div>\n `},""));var s,r;let a=function(e){return e.reduce((e,t,n)=>e+`\n <span class="c-i-ball">${n+1}</span>\n `,"")}(i.choices),d="function"==typeof l.rto.process?l.rto.process(i.text):i.text;return d=f(d),`\n <div class="storyboard-item" data-sbindx="${t}">\n <div class="storylet component-box ${n?"":"clps"}" data-stid="${i.id}">\n <div class="joiner"></div>\n <div class="name-label"> \n <i class="fas fa-chevron-up ico up"></i>\n <i class="fas fa-chevron-down ico down"></i>\n Storylet\n <span class="idchip">ID: ${i.id} <i class="far fa-copy ico-copy"></i></span>\n </div>\n <div class="wrap-text">\n <div class="st-text">${d}</div>\n </div>\n </div>\n <div class="choices component-box ${i.choices.length<=0?"hidden":""}">\n <div class="joiner"></div>\n <div class="name-label">Choices (${i.choices.length})</div>\n <div class="balls">${a}</div>\n <div class="inner-container">${o}</div>\n </div>\n </div>\n `}function h(e,t){var n=document.createElement("input");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),"function"==typeof l.notify&&l.notify(t||"Copied to clipboard ... ")}l.rto.createTimeline=(e,t,n={})=>{o=s("#"+e),c=t,r=n,a=r.preselectCIDs&&Array.isArray(r.preselectCIDs)&&r.preselectCIDs.length>0?function(e){let t,n=c.storylets[c.start],i=[];for(let o=0;o<e.length;++o){if(t=c.choices[e[o]],!n.choices.includes(t.id))return i;i.push(d(n.id,t.id)),n=c.storylets[t.next]}return i.push(d(n.id)),i}(r.preselectCIDs):[d(t.start)],o.addClass("reactive-timeline"),u(),o.off(),o.on("click",".storylet .name-label",(function(){s(this).closest(".storylet").toggleClass("clps")})),o.on("click",".choice",(function(){let e=s(this).attr("data-cid");!function(e,t,n){a=a.slice(0,t+1),a[t].selectedCID=n,a.push({stID:e}),u()}(c.choices[e].next,parseInt(s(this).closest(".storyboard-item").attr("data-sbindx")),e)})),o.on("click",".c-i-ball",(function(){let e=parseInt(s(this).text())-1,t=s(this).closest(".choices").find(".inner-container"),n=e*t.find(".choice ").width();t.animate({scrollLeft:n},500)})),o.on("click",".idchip",(function(e){e.stopPropagation(),e.preventDefault(),h(s(e.target).closest(".idchip").text().split(":")[1].trim(),"ID copied to clipboard ...")}))}}]); //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbmZpZy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJBTExPV0VEX1RBR1MiLCJjb250YWluZXIiLCJ0YWxlIiwiJCIsIndpbmRvdyIsInR3aW5kb3ciLCJydG8iLCJjZmciLCJzYiIsImNvcHlUb0NsaXBib2FyZCIsImNyZWF0ZVNiSSIsInN0SUQiLCJzZWxlY3RlZENJRCIsInNhbml0aXplIiwiZGlydHlIdG1sIiwiRE9NUHVyaWZ5IiwicmVuZGVyIiwidGltZWxpbmVXaWxsUmVuZGVyIiwiaHRtIiwibGVuZ3RoIiwiY3JlYXRlU2JpSHRtIiwiaHRtbCIsImluZGV4Iiwic2JJIiwiZmluZCIsImVxIiwiYW5pbWF0ZSIsInNjcm9sbFRvcCIsIm9mZnNldCIsInRvcCIsInNjcm9sbFRvU2JpIiwiZWFjaCIsImNoU2VsZWN0ZWQiLCJ0aGlzIiwic2hpZnRMZWZ0IiwibGVmdCIsInNjcm9sbExlZnQiLCJ0aW1lbGluZURpZFJlbmRlciIsImluZHgiLCJpc0xhc3RJdGVtIiwic3QiLCJzdG9yeWxldHMiLCJjaG9pY2VzSHRtIiwiY2hvaWNlSURBcnIiLCJjaG9pY2VzIiwicmVkdWNlIiwiY2lkIiwiaWQiLCJ0ZXh0IiwiY2hvaWNlQmFsbEh0bSIsImNyZWF0ZUNob2ljZUJhbGxzIiwic3RQcm9jZXNzZWRUeHQiLCJwcm9jZXNzIiwic3VjY2Vzc01zZyIsInRlbXBJbnB1dCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImJvZHkiLCJhcHBlbmRDaGlsZCIsInNlbGVjdCIsImV4ZWNDb21tYW5kIiwicmVtb3ZlQ2hpbGQiLCJub3RpZnkiLCJjcmVhdGVUaW1lbGluZSIsImVsZW1lbnRJRCIsInJ0bCIsImNvbmZpZyIsInByZXNlbGVjdENJRHMiLCJBcnJheSIsImlzQXJyYXkiLCJjaCIsInN0YXJ0Iiwic2JBcnIiLCJpbmNsdWRlcyIsInB1c2giLCJuZXh0IiwiY3JlYXRlU0JXaXRoUHJlQ0lEcyIsImFkZENsYXNzIiwib2ZmIiwib24iLCJjbG9zZXN0IiwidG9nZ2xlQ2xhc3MiLCJhdHRyIiwic2xpY2UiLCJhZGRTYmkiLCJwYXJzZUludCIsImNoQ29udGFpbmVyIiwibGVmdFNoaWZ0Iiwid2lkdGgiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJzcGxpdCIsInRyaW0iXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIs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LEVBQVErRCxTQUFTbEYsRUFBRThCLE1BQU1lLFFBQVUsRUFDbkNzQyxFQUFjbkYsRUFBRThCLE1BQU0rQyxRQUFRLFlBQVl4RCxLQUFLLG9CQUUvQytELEVBQVlqRSxFQURGZ0UsRUFBWTlELEtBQUssWUFBWWdFLFFBRTNDRixFQUFZNUQsUUFBUSxDQUFFVSxXQUFZbUQsR0FBYSxRQUVuRHRGLEVBQVU4RSxHQUFHLFFBQVMsV0FBVyxTQUFVVSxHQUN2Q0EsRUFBRUMsa0JBQ0ZELEVBQUVFLGlCQUVGbEYsRUFEYU4sRUFBRXNGLEVBQUVHLFFBQVFaLFFBQVEsV0FBV2hDLE9BQU82QyxNQUFNLEtBQUssR0FBR0MsT0FDM0MiLCJmaWxlIjoidGltZWxpbmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJleHBvcnQgY29uc3QgQUxMT1dFRF9UQUdTID0gWydiJywgJ2knLCAndScsICdjJywgJ3MnLCAnYnInLCAnaHInXTtcclxuIiwiaW1wb3J0IHsgQUxMT1dFRF9UQUdTIH0gZnJvbSAnLi9jb25maWcnO1xyXG5sZXQgJCA9IHdpbmRvdy4kO1xyXG5sZXQgdHdpbmRvdyA9IHdpbmRvdztcclxudHdpbmRvdy5ydG8gPSB0d2luZG93LnJ0byB8fCB7fTtcclxubGV0IGNvbnRhaW5lcjtcclxubGV0IHRhbGU7XHJcbmxldCBzYiA9IFtdO1xyXG5sZXQgY2ZnO1xyXG50d2luZG93LnJ0by5jb3B5VG9DbGlwYm9hcmQgPSBjb3B5VG9DbGlwYm9hcmQ7XHJcbmNvbnN0IGNyZWF0ZVNiSSA9IChzdElELCBzZWxlY3RlZENJRCkgPT4gKHsgc3RJRCwgc2VsZWN0ZWRDSUQgfSk7XHJcbmNvbnN0IHNhbml0aXplID0gKGRpcnR5SHRtbCkgPT4gdHdpbmRvdy5ET01QdXJpZnkuc2FuaXRpemUoZGlydHlIdG1sLCB7IEFMTE9XRURfVEFHUyB9KTtcclxudHdpbmRvdy5ydG8uY3JlYXRlVGltZWxpbmUgPSAoZWxlbWVudElELCBydGwsIGNvbmZpZyA9IHt9KSA9PiB7XHJcbiAgICBjb250YWluZXIgPSAkKCcjJyArIGVsZW1lbnRJRCk7XHJcbiAgICB0YWxlID0gcnRsO1xyXG4gICAgY2ZnID0gY29uZmlnO1xyXG4gICAgaWYgKGNmZy5wcmVzZWxlY3RDSURzICYmIEFycmF5LmlzQXJyYXkoY2ZnLnByZXNlbGVjdENJRHMpICYmIGNmZy5wcmVzZWxlY3RDSURzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBzYiA9IGNyZWF0ZVNCV2l0aFByZUNJRHMoY2ZnLnByZXNlbGVjdENJRHMpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgc2IgPSBbY3JlYXRlU2JJKHJ0bC5zdGFydCldO1xyXG4gICAgfVxyXG4gICAgY29udGFpbmVyLmFkZENsYXNzKCdyZWFjdGl2ZS10aW1lbGluZScpO1xyXG4gICAgcmVuZGVyKCk7XHJcbiAgICBpbml0RXZlbnRCaW5kaW5ncygpO1xyXG59O1xyXG5mdW5jdGlvbiBjcmVhdGVTQldpdGhQcmVDSURzKHByZXNlbGVjdENJRHMpIHtcclxuICAgIGxldCBzdCA9IHRhbGUuc3RvcnlsZXRzW3RhbGUuc3RhcnRdO1xyXG4gICAgbGV0IGNoO1xyXG4gICAgbGV0IHNiQXJyID0gW107XHJcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcHJlc2VsZWN0Q0lEcy5sZW5ndGg7ICsraW5kZXgpIHtcclxuICAgICAgICBjaCA9IHRhbGUuY2hvaWNlc1twcmVzZWxlY3RDSURzW2luZGV4XV07XHJcbiAgICAgICAgaWYgKHN0LmNob2ljZXMuaW5jbHVkZXMoY2guaWQpKSB7XHJcbiAgICAgICAgICAgIHNiQXJyLnB1c2goY3JlYXRlU2JJKHN0LmlkLCBjaC5pZCkpO1xyXG4gICAgICAgICAgICBzdCA9IHRhbGUuc3RvcnlsZXRzW2NoLm5leHRdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNiQXJyO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHNiQXJyLnB1c2goY3JlYXRlU2JJKHN0LmlkKSk7XHJcbiAgICByZXR1cm4gc2JBcnI7XHJcbn1cclxuZnVuY3Rpb24gcmVuZGVyKCkge1xyXG4gICAgaWYgKHR5cGVvZiAoY2ZnLnRpbWVsaW5lV2lsbFJlbmRlcikgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBjZmcudGltZWxpbmVXaWxsUmVuZGVyKCk7XHJcbiAgICB9XHJcbiAgICBsZXQgaHRtID0gJyc7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNiLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbGV0IHNiSSA9IHNiW2ldO1xyXG4gICAgICAgIGh0bSArPSBjcmVhdGVTYmlIdG0oc2JJLCBpLCBpID09PSAoc2IubGVuZ3RoIC0gMSkpO1xyXG4gICAgfVxyXG4gICAgY29udGFpbmVyLmh0bWwoaHRtKTtcclxuICAgIHNjcm9sbFRvU2JpKCk7XHJcbiAgICBzY3JvbGxUb1NlbGVjdGVkQ2hvaWNlcygpO1xyXG4gICAgaWYgKHR5cGVvZiAoY2ZnLnRpbWVsaW5lRGlkUmVuZGVyKSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIGNmZy50aW1lbGluZURpZFJlbmRlcigpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZVNiaUh0bShzYkksIGluZHgsIGlzTGFzdEl0ZW0pIHtcclxuICAgIGxldCBzdCA9IHRhbGUuc3RvcnlsZXRzW3NiSS5zdElEXTtcclxuICAgIGxldCBjaG9pY2VzSHRtID0gY3JlYXRlQ2hvaWNlc0h0bShzdC5jaG9pY2VzLCBzYkkuc2VsZWN0ZWRDSUQpO1xyXG4gICAgbGV0IGNob2ljZUJhbGxIdG0gPSBjcmVhdGVDaG9pY2VCYWxscyhzdC5jaG9pY2VzKTtcclxuICAgIGxldCBzdFByb2Nlc3NlZFR4dCA9ICh0eXBlb2YgKHR3aW5kb3cucnRvLnByb2Nlc3MpID09PSBcImZ1bmN0aW9uXCIpID8gdHdpbmRvdy5ydG8ucHJvY2VzcyhzdC50ZXh0KSA6IHN0LnRleHQ7XHJcbiAgICBzdFByb2Nlc3NlZFR4dCA9IHNhbml0aXplKHN0UHJvY2Vzc2VkVHh0KTtcclxuICAgIGxldCBjbHBzQ2xhc3MgPSAhaXNMYXN0SXRlbSA/ICdjbHBzJyA6ICcnO1xyXG4gICAgcmV0dXJuIChgXHJcbiAgICAgICAgPGRpdiBjbGFzcz1cInN0b3J5Ym9hcmQtaXRlbVwiIGRhdGEtc2JpbmR4PVwiJHtpbmR4fVwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3RvcnlsZXQgY29tcG9uZW50LWJveCAke2NscHNDbGFzc31cIiBkYXRhLXN0aWQ9XCIke3N0LmlkfVwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImpvaW5lclwiPjwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm5hbWUtbGFiZWxcIj4gXHJcbiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYXMgZmEtY2hldnJvbi11cCBpY28gdXBcIj48L2k+XHJcbiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYXMgZmEtY2hldnJvbi1kb3duIGljbyBkb3duXCI+PC9pPlxyXG4gICAgICAgICAgICAgICAgICAgIFN0b3J5bGV0XHJcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJpZGNoaXBcIj5JRDogJHtzdC5pZH0gPGkgY2xhc3M9XCJmYXIgZmEtY29weSBpY28tY29weVwiPjwvaT48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ3cmFwLXRleHRcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3QtdGV4dFwiPiR7c3RQcm9jZXNzZWRUeHR9PC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjaG9pY2VzIGNvbXBvbmVudC1ib3ggJHtzdC5jaG9pY2VzLmxlbmd0aCA8PSAwID8gJ2hpZGRlbicgOiAnJ31cIj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJqb2luZXJcIj48L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJuYW1lLWxhYmVsXCI+Q2hvaWNlcyAoJHtzdC5jaG9pY2VzLmxlbmd0aH0pPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmFsbHNcIj4ke2Nob2ljZUJhbGxIdG19PC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW5uZXItY29udGFpbmVyXCI+JHtjaG9pY2VzSHRtfTwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICBgKTtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVDaG9pY2VzSHRtKGNob2ljZUlEQXJyLCBzZWxlY3RlZENJRCkge1xyXG4gICAgcmV0dXJuIGNob2ljZUlEQXJyLnJlZHVjZSgoaHRtLCBjaWQsIGkpID0+IHtcclxuICAgICAgICBsZXQgYyA9IHRhbGUuY2hvaWNlc1tjaWRdO1xyXG4gICAgICAgIHJldHVybiBodG0gKyBgXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjaG9pY2UgJHtjaWQgPT09IHNlbGVjdGVkQ0lEID8gJ3NlbGVjdGVkJyA6ICcnfVwiIGRhdGEtY2lkPVwiJHtjLmlkfVwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImMtaVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIENob2ljZSAke2kgKyAxfVxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiaWRjaGlwXCI+SUQ6ICR7Yy5pZH0gPGkgY2xhc3M9XCJmYXIgZmEtY29weSBpY28tY29weVwiPjwvaT48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiYy10ZXh0XCI+JHtzYW5pdGl6ZShjLnRleHQpfTwvc3Bhbj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgYDtcclxuICAgIH0sICcnKTtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVDaG9pY2VCYWxscyhjaG9pY2VJREFycikge1xyXG4gICAgcmV0dXJuIGNob2ljZUlEQXJyLnJlZHVjZSgoaHRtLCBjaWQsIGkpID0+IHtcclxuICAgICAgICByZXR1cm4gaHRtICsgYFxyXG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImMtaS1iYWxsXCI+JHtpICsgMX08L3NwYW4+XHJcbiAgICAgICAgYDtcclxuICAgIH0sICcnKTtcclxufVxyXG5mdW5jdGlvbiBzY3JvbGxUb1NiaShpbmRleCA9IHNiLmxlbmd0aCAtIDEpIHtcclxuICAgIGxldCBzYkkgPSBjb250YWluZXIuZmluZCgnLnN0b3J5Ym9hcmQtaXRlbScpLmVxKGluZGV4KTtcclxuICAgICQoJ2h0bWwsIGJvZHknKS5hbmltYXRlKHtcclxuICAgICAgICBzY3JvbGxUb3A6ICgoc2JJICYmIHNiSS5vZmZzZXQoKSkgPyBzYkkub2Zmc2V0KCkudG9wIDogMTAwKSAtIDEwMFxyXG4gICAgfSwgNTAwKTtcclxufVxyXG5mdW5jdGlvbiBzY3JvbGxUb1NlbGVjdGVkQ2hvaWNlcygpIHtcclxuICAgIGNvbnRhaW5lci5maW5kKCcuY2hvaWNlcyAuaW5uZXItY29udGFpbmVyJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IGNoU2VsZWN0ZWQgPSAkKHRoaXMpLmZpbmQoJy5jaG9pY2Uuc2VsZWN0ZWQnKTtcclxuICAgICAgICBpZiAoY2hTZWxlY3RlZC5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICBsZXQgc2hpZnRMZWZ0ID0gY2hTZWxlY3RlZC5lcSgwKS5vZmZzZXQoKS5sZWZ0IC0gNDE7XHJcbiAgICAgICAgJCh0aGlzKS5zY3JvbGxMZWZ0KHNoaWZ0TGVmdCk7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBhZGRTYmkoc3RJRCwgaW5keCwgc2VsZWN0ZWRDSUQpIHtcclxuICAgIHNiID0gc2Iuc2xpY2UoMCwgaW5keCArIDEpO1xyXG4gICAgc2JbaW5keF0uc2VsZWN0ZWRDSUQgPSBzZWxlY3RlZENJRDtcclxuICAgIHNiLnB1c2goeyBzdElEIH0pO1xyXG4gICAgcmVuZGVyKCk7XHJcbn1cclxuZnVuY3Rpb24gaW5pdEV2ZW50QmluZGluZ3MoKSB7XHJcbiAgICBjb250YWluZXIub2ZmKCk7XHJcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJy5zdG9yeWxldCAubmFtZS1sYWJlbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKHRoaXMpLmNsb3Nlc3QoJy5zdG9yeWxldCcpLnRvZ2dsZUNsYXNzKCdjbHBzJyk7XHJcbiAgICB9KTtcclxuICAgIGNvbnRhaW5lci5vbignY2xpY2snLCAnLmNob2ljZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgY2lkID0gJCh0aGlzKS5hdHRyKCdkYXRhLWNpZCcpO1xyXG4gICAgICAgIGxldCBjID0gdGFsZS5jaG9pY2VzW2NpZF07XHJcbiAgICAgICAgbGV0IHN0SUQgPSBjLm5leHQ7XHJcbiAgICAgICAgbGV0IGluZHggPSBwYXJzZUludCgkKHRoaXMpLmNsb3Nlc3QoJy5zdG9yeWJvYXJkLWl0ZW0nKS5hdHRyKCdkYXRhLXNiaW5keCcpKTtcclxuICAgICAgICBhZGRTYmkoc3RJRCwgaW5keCwgY2lkKTtcclxuICAgIH0pO1xyXG4gICAgY29udGFpbmVyLm9uKCdjbGljaycsICcuYy1pLWJhbGwnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IGluZGV4ID0gcGFyc2VJbnQoJCh0aGlzKS50ZXh0KCkpIC0gMTtcclxuICAgICAgICBsZXQgY2hDb250YWluZXIgPSAkKHRoaXMpLmNsb3Nlc3QoJy5jaG9pY2VzJykuZmluZCgnLmlubmVyLWNvbnRhaW5lcicpO1xyXG4gICAgICAgIGxldCBjaFdpZHRoID0gY2hDb250YWluZXIuZmluZCgnLmNob2ljZSAnKS53aWR0aCgpO1xyXG4gICAgICAgIGxldCBsZWZ0U2hpZnQgPSBpbmRleCAqIGNoV2lkdGg7XHJcbiAgICAgICAgY2hDb250YWluZXIuYW5pbWF0ZSh7IHNjcm9sbExlZnQ6IGxlZnRTaGlmdCB9LCA1MDApO1xyXG4gICAgfSk7XHJcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJy5pZGNoaXAnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGNvbnN0IHN0aWQgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCcuaWRjaGlwJykudGV4dCgpLnNwbGl0KCc6JylbMV0udHJpbSgpO1xyXG4gICAgICAgIGNvcHlUb0NsaXBib2FyZChzdGlkLCBcIklEIGNvcGllZCB0byBjbGlwYm9hcmQgLi4uXCIpO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gY29weVRvQ2xpcGJvYXJkKHZhbHVlLCBzdWNjZXNzTXNnKSB7XHJcbiAgICB2YXIgdGVtcElucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgdGVtcElucHV0LnZhbHVlID0gdmFsdWU7XHJcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRlbXBJbnB1dCk7XHJcbiAgICB0ZW1wSW5wdXQuc2VsZWN0KCk7XHJcbiAgICBkb2N1bWVudC5leGVjQ29tbWFuZChcImNvcHlcIik7XHJcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRlbXBJbnB1dCk7XHJcbiAgICBpZiAodHlwZW9mICh0d2luZG93Lm5vdGlmeSkgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICB0d2luZG93Lm5vdGlmeShzdWNjZXNzTXNnIHx8ICdDb3BpZWQgdG8gY2xpcGJvYXJkIC4uLiAnKTtcclxuICAgIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9
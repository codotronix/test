{"version":3,"sources":["components/layout/header/style.module.css","types/enums.ts","redux/actionTypes.js","redux/reducers/userReducer.ts","redux/reducers/uiReducer.js","redux/reducers/wipTaleReducer.js","redux/reducers/odReducer.js","redux/reducers/rootReducer.js","redux/configStore.js","utils/theme.js","utils/urls.js","services/session.service.js","utils/constants.js","utils/ajax.js","components/layout/header/Header.js","redux/actionCreators/createTaleActions.js","components/common/modal/SimpleModal.js","services/offlinesavedtales.service.js","components/common/modal/LogOutModal.js","components/layout/sidebar/Sidebar.js","components/layout/footer/Footer.js","components/layout/wrapper/Wrapper.js","services/home.service.js","components/common/cards/InfoCard.js","components/common/cards/ComplexCard.js","components/page-modules/home/Home.tsx","components/common/reactos/reactosDef.js","components/common/reactos/TabViewReactos.js","components/common/reactos/TabTryReactos.js","components/common/misc/Li.js","components/common/misc/Accordion.js","components/common/reactos/TabCreateReactos.js","components/common/reactos/ReactoModal.js","components/page-modules/createEditCommon/ExportTaleModal.js","components/page-modules/createEditCommon/ImportTaleModal.js","components/page-modules/createEditCommon/CreateTaleIntro.js","components/common/storylet/Choice.js","components/common/icons/ReactoIcon.js","components/common/storylet/Storylet.js","components/common/modal/FullScreenModal.js","utils/util.js","components/common/modal/FullScreenEdit.js","components/page-modules/createEditCommon/CreateTaleBody.tsx","components/page-modules/createEditCommon/exportFeatureText.js","components/page-modules/createEditCommon/CreateTaleFinish.tsx","components/page-modules/createEditCommon/Toolbelt.js","components/page-modules/createEditCommon/TopButtons.js","services/user.service.ts","redux/actionCreators/userActions.ts","components/page-modules/createEditCommon/CreateEditCommon.tsx","components/page-modules/createTale/CreateTale.js","components/page-modules/editTale/EditTale.js","components/page-modules/talesFlow/controlPanel/ControlPanel.js","components/page-modules/talesFlow/controlPanel/JoyStick.js","components/page-modules/talesFlow/FlowST.js","components/page-modules/talesFlow/FlowConnector.js","components/page-modules/talesFlow/ModalEditChoice.js","components/page-modules/talesFlow/controlModals/ModalCreateComponent.js","components/page-modules/talesFlow/flowMaker.js","types/TNotification.ts","components/page-modules/talesFlow/TalesFlow.js","components/page-modules/myTales/MyLocalTales.js","components/page-modules/myTales/MyOnlineTales.js","components/page-modules/myTales/MyTales.js","components/page-modules/read/Banner.js","components/page-modules/read/PreviewTale.js","components/page-modules/myProfile/MyProfile.js","components/page-modules/notifications/Notifications.tsx","utils/routes.js","components/common/login/login.service.js","utils/enums.js","components/common/login/LoginModal.js","App.js","index.tsx"],"names":["module","exports","E_SAVE_TYPES","E_FSE_MODE","initState","firstname","lastname","username","pswd","aboutme","email","imgUrl","gender","dob","lang1","lang2","lang3","country","facebookID","twitterID","history","prefs","defaultSave","EXPORT","userReducer","state","action","type","user","payload","partialPrefs","isSidebarOpen","isLoginModalOpen","loginActiveTab","isReactoModalOpen","notifications","uiReducer","tabIndex","isNaN","createStorylet","st","id","title","text","choices","createChoice","c","next","wipTaleReducer","isPublished","start","info","name","description","genre","lang","tags","authorEmail","originalAuthor","storyUrl","desiredUrl","idCounter","storylets","reactos","vars","storyboard","storyID","Date","getTime","Math","random","toString","replace","newST","wipTale","stID","cID","filter","fieldName","value","sbI","nextStID","isRemoveOnly","newSB","slice","push","selectedCID","fromStID","toStID","fromST","padStart","toST","newChoice","indexOf","splice","myTales","odReducer","rootReducer","combineReducers","ui","od","persistConfig","key","storage","storageSession","persistedReducer","persistReducer","store","createStore","composeWithDevTools","applyMiddleware","thunk","persistor","persistStore","theme","createMuiTheme","palette","primary","light","main","dark","contrastText","secondary","typography","fontFamily","join","props","MuiButton","size","console","log","process","env","root","ext","config","GET_LOGGEDIN_USER","GET_STORY","GET_MYSTORY","DELETE_MYTALE","GET_MYSTORIES","CREATE_TALE","LOGIN","SIGNUP","VERIFY_EMAIL","ALLTALES","PUB_UNPUB","RESEND_OTP","UPDATE_NEWPSWD","UPDATE_USERNAME","UPDATE_MYPROFILE","UPDATE_MYPREFERENCES","UPLOAD_BANNER","EXEC_LINK_A_TALE","rtlsession","JSON","parse","window","sessionStorage","getItem","__save","setItem","stringify","COUNTRIES","LANGUAGES","GENRES","ALLOWED_TAGS","CONST_TITLE","getToken","localStorage","ajaxPost","url","jsonData","axios","post","headers","ajaxGet","params","get","ajaxGetWPathParams","paramsArr","forEach","p","useStyles","makeStyles","menuButton","marginRight","spacing","toolbar","padding","greet","width","fontSize","textAlign","overflow","textOverflow","marginLeft","profileLink","color","textDecoration","connect","dispatch","openSidebar","updateUser","classes","useEffect","showLoader","then","res","data","status","msg","catch","err","finally","hideLoader","className","AppBar","position","Toolbar","IconButton","edge","onClick","aria-label","styles","logoContainer","src","alt","logoImg","href","notify","actionCreateChoice","Error","getState","actionUpdateCText","actionSetTaleAsWIP","tale","titleBar","margin","backgroundColor","pxToRem","minWidth","modalBody","closeIco","top","right","boxSizing","cursor","SimpleModal","isOpen","handleClose","children","clsx","Dialog","open","onClose","aria-labelledby","DialogTitle","DialogContent","getOfflineSavedTales","getOneOfflineSavedTales","taleId","deleteOneOfflineSavedTales","taleID","allReactales","_saveAllOfflineSavedTales","LogOutModal","logOut","useState","doDeleteOfflineTales","setDoDeleteOfflineTales","Box","my","FormControl","component","FormLabel","RadioGroup","onChange","e","target","FormControlLabel","control","Radio","label","mt","Button","variant","list","fullList","listItem","borderBottom","icoInList","ico","faIco","navs","iconClass","closeSidebar","openLoginModal","resetWIPTale","resetUser","resetFetchedTales","isLogoutModalOpen","setIsLogoutModalOpen","purgePersistedData","useHistory","showLogoutConfirmModal","Drawer","role","onKeyDown","List","map","nav","index","to","includes","preventDefault","stopPropagation","location","origin","beforeYouGo","ListItem","button","ListItemText","ListItemIcon","links","iconLinks","display","Footer","Grid","container","item","xs","md","Typography","gutterBottom","Wrapper","talesForHome","getTalesForHome","a","length","tales","height","flexDirection","maxWidth","borderTop","flexGrow","marginBottom","InfoCard","Card","card","media","paddingTop","desc","expand","transform","transition","transitions","create","duration","shortest","expandOpen","avatar","red","btnLeft","justifyContent","ComplexCard","expandable","handleEdit","handleDelete","handleReadTale","pageID","React","expanded","setExpanded","CardHeader","Avatar","subheader","authorDisplayName","CardMedia","image","CardContent","CardActions","disableSpacing","aria-expanded","groups","setGroups","document","groupByGenre","reduce","acc","t","URLSearchParams","search","newSearchString","pathname","setTimeout","pb","Object","keys","g","i","mr","goToTale","allReactos","cats","border","borderRadius","lineHeight","background","indieReacto","boxShadow","fontWeight","alignItems","invisible","left","TabViewReactos","tryOut","catList","setCatList","rtoCatWise","setRtoCatWise","activeCat","setActiveCat","inputRef","createRef","reactoCategoryWise","r","cat","token","substr","substring","px","ref","rto","current","select","setSelectionRange","execCommand","startIcon","test","endIcon","textField","interpretedTxt","whiteSpace","TabTryReactos","rTxt","reactiveTxt","setReactiveTxt","setInterpretedTxt","TextField","multiline","rows","fullWidth","py","Li","body","borderTopLeftRadius","borderTopRightRadius","Accordion","setOpen","liOfRVars","paddingRight","rVars","updateReactoVars","rvars","initRVar","val","userCustomizable","helptext","newRVar","setNewRVar","handleChangeNewRVar","k","v","required","helperText","Checkbox","checked","modal","marginTop","visibleTabIndex","setVisibleTab","setRTxt","mb","rel","Paper","square","Tabs","indicatorColor","textColor","centered","Tab","rtxt","ExportTaleModal","expTaleContent","textFieldRef","textRef","getElementsByTagName","clickToCopy","LZString","ImportTaleModal","setForEditing","importedTxt","setImportedTxt","encType","accept","file","files","reader","FileReader","onload","result","readAsText","handleFileSelect","align","decompressFromEncodedURIComponent","imgUploadSec","maxHeight","userEmail","typingVal","oldInfo","updateTaleInfo","updateImgUrl","actionUpdateImgUrl","imgFile","setImgFile","previewImgUrl","setPreviewImgUrl","sm","InputProps","endAdornment","InputAdornment","InputLabel","Select","MenuItem","l","placeholder","disabled","getElementById","click","formData","FormData","append","newFileName","uploadImg","fileList","URL","createObjectURL","choiceBox","selectChoice","choiceText","idTag","btnPanel","zIndex","verticalAlign","typingChoiceText","updateChoiceText","handleSelection","isSelected","inputProps","ReactoIcon","box","orange","userSelect","joiner","borderLeft","choiceContainer","flexWrap","addChoiceBtn","alignSelf","typingStValue","UpdateStField","createAChoice","sbItem","openFSE","openReactoModal","pt","icon","faEye","faPencilAlt","noValidate","autoComplete","Fab","appBar","minHeight","flex","Transition","forwardRef","Slide","direction","FullScreenModal","btnText","btnClick","cancelText","fullScreen","TransitionComponent","isEmailValid","xScroller","formatterBtns","overflowX","overflowY","editForm","previewBody","wordBreak","saveStValue","actionUpdateSTAllText","saveChValue","MODES","activeMode","theForm","currentActiveMode","setCurrentActiveMode","currentComp","setCurrentComp","save","compText","elements","compTitle","changeModeTo","mode","formatText","el","startIndex","selectionStart","endIndex","selectionEnd","currentText","startTag","closeTag","focus","Container","faBold","faItalic","faUnderline","faStrikethrough","faAlignCenter","defaultValue","trim","dangerouslySetInnerHTML","txt","dirtyHtml","__html","DOMPurify","sanitize","getPreviewHTML","fseParam","setFSEParam","EDIT","isVisible","exportTale","features","saveLocal","saveOnline","cardHeaders","cardContainer","cardInfo","pubSec","btnContainer","publish","unpublish","exportWIPTale","saveTaleOnline","saveTaleLocal","saveDefault","markSaveDefault","featureText","OFFLINE","ONLINE","borderBottomLeftRadius","opacity","Toolbelt","setVisibility","openImportModal","previewTale","doSaveDefault","goToTalesFlow","handleClick","fn","TopButtons","updateUserPrefs","actionLogin","tok","saveUserPref","_","debounce","_wipTale","_authorEmail","_userPrefs","setTaleAsWIP","actionUpdateUserPrefs","pageTitle","isLocalEdit","isImportModalOpen","setIsImportModalOpen","expTale","setExpTale","isExpTaleModalVisible","setExpTModalVis","goTo","getWIPTale","areFieldsValid","content","compressToEncodedURIComponent","filename","element","createElement","setAttribute","style","appendChild","removeChild","downloadAsFile","rtl","saveOneOfflineSavedTales","needsRedirection","submittedTale","newValue","saveType","_id","createNewTale","_storyUrl","setIsLocalEdit","match","theTale","panel","backgroundImage","btnPane","A400","fa","autoMagic","toggleJStick","ControlPanel","deleteComponent","paintFlowboard","openCreateComponent","faMagic","btn","up","down","JoyStick","moveLeft","moveRight","moveUp","moveDown","cg","knot","fill","strokeWidth","stroke","selectedKnot","selectedEl","rect","selectedST","stid","FlowST","transformStyle","selectedObj","handleMouseDown","handleMouseUp","handleMouseMove","markSelected","onMouseDown","onMouseUp","onMouseMove","x","y","cx","FLOW_ST_WIDTH","cy","FLOW_ST_HEIGHT","connector","cid","selectedConnector","FlowConnector","x1","y1","x2","y2","modelST","modelCon","ModalEditChoice","handleSave","setTxt","initData","compType","fromSTID","toSTID","ModalCreateComponent","openEditChoiceModal","createNewChoice","setData","handleChange","labelId","values","createFlowboard","levelsSTMap","isAutoFormatting","level","stxy","maxRecInALevel","maxLength","longestRowWidth","recsInThisLevel","hGap","getTransformStyle","setTransformStyle","setStoryletXY","entryStIDs","allStIDs","idx","getEntryStIDs","putStIntoLevels","currentLevel","alreadyFoundStIDs","levelsDecending","sort","reverse","Array","from","Set","createLevelSTMap","fbi","E_NOTIF_TYPE","E_NOTIF_NAME","MODAL_IDS","outerContainer","svgContainer","mainSVG","joystick","bottom","initStoryboard","deleteStorylet","deleteChoice","fb","setFb","fbC","setFbC","isJStickVis","setJStickVis","draggedStID","setDraggedStID","prevMPos","setPrevMPos","setSelectedObj","editChoiceData","setEditChoiceData","visibleModalID","setVisibleModalID","useCallback","flowBoard","flowConnectors","connectorsObj","ch","fromX","fromY","toX","toY","ftid","createFlowConnectors","markDraggedStID","ev","pageX","pageY","unmarkDraggedStID","moveST","xDisplace","yDisplace","newFBI","newFB","newFBC","ftidParts","split","updateConnectors","moveDraggetST","throttle","mouseDiffX","mouseDiffY","moveWithJStick","comName","confirm","toLowerCase","MyLocalTales","localTales","setLocalTales","filterTxt","setFilterTxt","localLocalTales","toLocaleLowerCase","lg","deleteTale","myOnlineTales","cacheMyTales","refreshOnlineTales","goToEditTale","event","bannerImg","titleLine","listStyle","descSec","Banner","isDescOpen","setDescOpen","isCutomizable","onCustomize","isArray","tag","backBtn","PreviewTale","setTale","customVars","setCustomVars","isCstmModalVisible","setIsCstmModalVisible","modifiedVars","setModifiedVars","onChangeMVar","addStoredReactos","customizableVars","setAllVars","createTimeline","goBack","cv","sectionHead","usernameTextboxWrap","tempUser","setTempUser","isUncollapsed","setIsUnCollapsed","toggleCollapse","class","Tooltip","disableFocusListener","newUsername","updatedUserData","notifBox","routes","path","Home","exact","MyProfile","CreateTale","EditTale","TalesFlow","MyTales","notifs","setNotifs","executeLinkATale","execCode","n","notif","elevation","LINK_A_TALE_REQUEST","dateInMs","d","getDate","getMonth","getFullYear","formatDate","doC","requestorID","requestorName","fromStoryName","fromUrl","choiceTxt","toUrl","verfyEmail","otp","resendOTP","otpType","updateNewPswd","pswdchangeotp","newpswd","OTP_TYPES","heading","fontWeightRegular","changeTab","doLogin","u","doSignup","actionSignup","localUser","setLocalUser","emailVerifyMSG","isEmailPswdValid","isPasswordValid","handleLogin","handleSignup","updateLocalUser","onSubmit","AccordionSummary","expandIcon","AccordionDetails","emailverifyotp","newpswd1","purge","App","ThemeProvider","loading","basename","Sidebar","ReactDOM","render"],"mappings":"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","file":"static/js/main.2b36aa2f.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"logoContainer\":\"style_logoContainer__2gHHN\",\"logoImg\":\"style_logoImg__uKyb1\"};","\r\n// String enums are great when I want to save it in DB\r\n// In all other cases, nomral enums are fine\r\n\r\n\r\nexport enum E_SAVE_TYPES {\r\n    ONLINE=\"ONLINE\", \r\n    OFFLINE=\"OFFLINE\", \r\n    EXPORT=\"EXPORT\"\r\n}\r\n\r\nexport enum E_FSE_MODE {\r\n    EDIT, PREVIEW\r\n}","// ALL UI MANIPULATION ACTION TYPES\r\nexport const UI_SIDEBAR_OPEN = \"UI_SIDEBAR_OPEN\"\r\nexport const UI_SIDEBAR_CLOSE = \"UI_SIDEBAR_CLOSE\"\r\nexport const UI_LOGIN_MODAL_OPEN = \"UI_LOGIN_MODAL_OPEN\"\r\nexport const UI_LOGIN_MODAL_CLOSE = \"UI_LOGIN_MODAL_CLOSE\"\r\nexport const UI_LOGIN_SET_ACT_TAB = \"UI_LOGIN_SET_ACT_TAB\"\r\nexport const UI_REACTO_MODAL_OPEN = \"UI_REACTO_MODAL_OPEN\"\r\nexport const UI_REACTO_MODAL_CLOSE = \"UI_REACTO_MODAL_CLOSE\"\r\n\r\nexport const USER_UPDATE = \"USER_UPDATE\"\r\nexport const USER_PREFS_UPDATE = \"USER_PREFS_UPDATE\"\r\nexport const USER_RESET = \"USER_RESET\"\r\n\r\nexport const ONLINE_DATA_SAVE_MY_TALES = \"ONLINE_DATA_SAVE_MY_TALES\"\r\nexport const ONLINE_DATA_CLEAR_TALES = \"ONLINE_DATA_CLEAR_TALES\"\r\n\r\nexport const TALE_CREATE = \"TALE_CREATE\"\r\nexport const TALE_SET_AS_WIP = \"TALE_SET_AS_WIP\"    // Set the given tale as WIP tale\r\nexport const TALE_UPDATE_INFO = \"TALE_UPDATE_INFO\"\r\nexport const TALE_STATE_CLEANUP = \"TALE_STATE_CLEANUP\"\r\nexport const TALE_UPDATE_REACTO_VARS = \"TALE_UPDATE_REACTO_VARS\"\r\nexport const TALE_PUBLISH = \"TALE_PUBLISH\"\r\nexport const TALE_UNPUBLISH = \"TALE_UNPUBLISH\"\r\n\r\n// export const STORYLET_CREATE = \"STORYLET_CREATE\"\r\nexport const STORYLET_UPDATE_FIELD = \"STORYLET_UPDATE_FIELD\"\r\nexport const STORYLET_UPDATE_ALL_TEXT = \"STORYLET_UPDATE_ALL_TEXT\"\r\nexport const STORYLET_DELETE = \"STORYLET_DELETE\"\r\n\r\nexport const STORYBOARD_INIT = \"STORYBOARD_INITIALIZE\"\r\nexport const STORYBOARD_ADD_SINGLE = \"STORYBOARD_ADD_SINGLE\"\r\nexport const STORYBOARD_INSERT_AT = \"STORYBOARD_INSERT_AT\"\r\nexport const STORYBOARD_SELECT_CHOICE = \"STORYBOARD_SELECT_CHOICE\"\r\n\r\nexport const CHOICE_CREATE = \"CHOICE_CREATE\"\r\nexport const CHOICE_DELETE = \"CHOICE_DELETE\"\r\nexport const CHOICE_UPDATE_TEXT = \"CHOICE_UPDATE_TEXT\"\r\nexport const ADD_CID_TO_STID = \"ADD_CID_TO_STID\"\r\n\r\n","import { TUser, TUserPrefs } from '../../types'\r\nimport { E_SAVE_TYPES } from '../../types/enums'\r\nimport {\r\n    USER_UPDATE,\r\n    USER_PREFS_UPDATE,\r\n    USER_RESET\r\n} from '../actionTypes'\r\n\r\nconst initState: TUser = {\r\n    firstname: '',\r\n    lastname: '',\r\n    username: '',\r\n    pswd: '',\r\n    aboutme: '',\r\n    email: '',\r\n    imgUrl: '',\r\n    gender: '',\r\n    dob: '',\r\n    lang1: '',\r\n    lang2: '',\r\n    lang3: '',\r\n    country: '',\r\n    facebookID: '',\r\n    twitterID: '',\r\n    history: [],\r\n    prefs: { \r\n        defaultSave: E_SAVE_TYPES.EXPORT\r\n    }\r\n}\r\n\r\nconst userReducer = (state=initState, action: any) => {\r\n    switch (action.type) {\r\n\r\n        case USER_UPDATE:\r\n            const { user } = action.payload\r\n            return { ...state, ...user }\r\n\r\n        case USER_PREFS_UPDATE:\r\n            const partialPrefs = action.payload as TUserPrefs\r\n            return {\r\n                ...state,\r\n                prefs: {\r\n                    ...state.prefs,\r\n                    ...partialPrefs\r\n                }\r\n            }\r\n\r\n        case USER_RESET: \r\n            return {...initState}\r\n\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport default userReducer","import {\r\n    UI_SIDEBAR_OPEN, \r\n    UI_SIDEBAR_CLOSE,\r\n    UI_LOGIN_MODAL_OPEN,\r\n    UI_LOGIN_MODAL_CLOSE,\r\n    UI_LOGIN_SET_ACT_TAB,\r\n    UI_REACTO_MODAL_OPEN,\r\n    UI_REACTO_MODAL_CLOSE\r\n} from '../actionTypes'\r\n\r\nconst initState = {\r\n    isSidebarOpen: false,\r\n    isLoginModalOpen: false,\r\n    loginActiveTab: 0,\r\n    isReactoModalOpen: false,\r\n    notifications: {}\r\n}\r\n\r\nconst uiReducer = (state=initState, action) => {\r\n    switch (action.type) {\r\n\r\n        case UI_SIDEBAR_OPEN:\r\n            return { ...state, isSidebarOpen: true }\r\n        \r\n        case UI_SIDEBAR_CLOSE:\r\n            return { ...state, isSidebarOpen: false }\r\n        \r\n        case UI_LOGIN_MODAL_OPEN:\r\n            return { ...state, isLoginModalOpen: true }\r\n\r\n        case UI_LOGIN_MODAL_CLOSE:\r\n            return { ...state, isLoginModalOpen: false }\r\n\r\n        case UI_REACTO_MODAL_OPEN:\r\n            return { ...state, isReactoModalOpen: true }\r\n\r\n        case UI_REACTO_MODAL_CLOSE:\r\n            return { ...state, isReactoModalOpen: false }\r\n        \r\n        case UI_LOGIN_SET_ACT_TAB:\r\n            const {tabIndex} = action.payload\r\n            if (!isNaN(tabIndex) && tabIndex < 3 && tabIndex > -1) {\r\n                return { ...state, loginActiveTab: tabIndex }\r\n            }\r\n            return state\r\n        \r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport default uiReducer","/**\r\n * This is hold and manage the state of the current WIP Tale\r\n * id: StoryID\r\n * start: Start Storylet ID\r\n */\r\nimport { \r\n    TALE_CREATE, \r\n    TALE_SET_AS_WIP,\r\n    TALE_UPDATE_INFO,\r\n    TALE_STATE_CLEANUP,\r\n    TALE_UPDATE_REACTO_VARS,\r\n    // STORYLET_CREATE,\r\n    STORYLET_DELETE,\r\n    STORYLET_UPDATE_FIELD,\r\n    STORYLET_UPDATE_ALL_TEXT,\r\n    STORYBOARD_INIT,\r\n    STORYBOARD_ADD_SINGLE,\r\n    STORYBOARD_INSERT_AT,\r\n    STORYBOARD_SELECT_CHOICE,\r\n    CHOICE_CREATE,\r\n    CHOICE_DELETE,\r\n    CHOICE_UPDATE_TEXT,\r\n    ADD_CID_TO_STID,\r\n    TALE_PUBLISH,\r\n    TALE_UNPUBLISH\r\n} from '../actionTypes'\r\n\r\nconst START_ST_ID = 'ST000' // BY MY STRICTEST CONVENTION \r\n\r\nconst getInitTaleState = () => ({\r\n    id: null,\r\n    isPublished: false,\r\n    start: null,\r\n    info: {\r\n        name: '',\r\n        description: '',\r\n        genre: 'Other',\r\n        lang: 'English',\r\n        tags: '',\r\n        authorEmail: '',\r\n        originalAuthor: '',\r\n        storyUrl: '',           // The PKey\r\n        desiredUrl: '',         // For local modification only, until storyUrl is got from Server on 1st Online Save\r\n        imgUrl: ''\r\n    },\r\n    idCounter: 0,\r\n    storylets: {},\r\n    choices: {},\r\n    reactos: { vars: {} },   //to contain all customizable vars objects, each var object = {name:string, val:string, userCustomizable:boolean}\r\n    storyboard: []  // sbI = { stID, selectedCID }  StoryBoardItems[],\r\n})\r\n\r\nconst createStorylet = st => {\r\n    st = st || {}\r\n    return {\r\n        id: st.id,\r\n        title: st.title || '',\r\n        text: st.text || '',\r\n        choices: st.choices || [] // This will hold only Choice IDs\r\n    }\r\n}\r\n\r\nconst createChoice = c => {\r\n    c = c || {}\r\n    return {\r\n        id: c.id,\r\n        text: c.text || '',\r\n        next: c.next || null\r\n    }\r\n}\r\n\r\nconst wipTaleReducer = (state=getInitTaleState(), action) => {\r\n    switch (action.type) {\r\n\r\n        /**\r\n         * Create a new Tale, START Storylet ID will always be \"st0\"\r\n         */\r\n        case TALE_CREATE: {\r\n            const storyID = 'R' + (new Date()).getTime() + Math.random().toString().replace('.','') // required for local-file-naming-collision-avoid etc\r\n            const newST = createStorylet({id: START_ST_ID})\r\n            let wipTale = {\r\n                ...state,\r\n                id: storyID,\r\n                start: START_ST_ID,\r\n                storylets: { \r\n                    [START_ST_ID]: newST\r\n                },\r\n                storyboard: [{stID: START_ST_ID}]\r\n            }\r\n            return wipTale\r\n        }\r\n\r\n        /**\r\n         * To work on an existing Tale, we need to set it as WIP Tale\r\n         */\r\n        case TALE_SET_AS_WIP: {\r\n            return {\r\n                ...action.payload,\r\n                storyboard: [{stID: START_ST_ID}]\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Only initialize the storyboard\r\n         */\r\n        case STORYBOARD_INIT: {\r\n            return {\r\n                ...state,\r\n                storyboard: [{stID: START_ST_ID}]\r\n            }\r\n        }\r\n\r\n        /**\r\n         * To update (add / edit / delete) reactos\r\n         */\r\n        case TALE_UPDATE_REACTO_VARS: {\r\n            return {\r\n                ...state,\r\n                reactos: {\r\n                    ...state.reactos,\r\n                    vars: action.payload\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Update the \"info\" object of Tale, while typing in text fields \r\n         */\r\n        case TALE_UPDATE_INFO: {\r\n            return {\r\n                ...state,\r\n                info: action.payload\r\n            }\r\n        }\r\n\r\n        /**\r\n         * isPublished is a dynamic key, for now, so not present during init (i.e. 0 or false or Unpublished)\r\n         * We are updating this state only for UI purpose\r\n         */\r\n        case TALE_PUBLISH: {\r\n            return {\r\n                ...state,\r\n                isPublished: true\r\n            }\r\n        }\r\n\r\n        /**\r\n         * isPublished is a dynamic key, for now, so not present during init (i.e. 0 or false or Unpublished)\r\n         * We are updating this state only for UI purpose\r\n         */\r\n        case TALE_UNPUBLISH: {\r\n            return {\r\n                ...state,\r\n                isPublished: false\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Before leaving the Tale creation / edit page, it's good\r\n         * to reset the state\r\n         */\r\n        case TALE_STATE_CLEANUP: {\r\n            return getInitTaleState()\r\n        }\r\n\r\n        /**\r\n         * If already exists a storylet with STID, do nothing\r\n         * Else create one\r\n         * \r\n         * !IMPORTANT EDIT! -- !DELETING!\r\n         * Deleting, because it is NEVER actually directly used on its own.\r\n         * We always create a Choice/Connector from an existing storylet\r\n         * And the NEW ONE is AUTOMATICALLY Created\r\n         */\r\n        // case STORYLET_CREATE: {\r\n        //     const stID = action.payload.stID\r\n        //     if (state.storylets[stID]) {\r\n        //         return state\r\n        //     }\r\n        //     else {\r\n        //         const newST = createStorylet({id: stID})\r\n        //         return {\r\n        //             ...state,\r\n        //             idCounter: state.idCounter + 1,\r\n        //             storylets: {\r\n        //                 ...state.storylets, \r\n        //                 [stID]: newST\r\n        //             }\r\n        //         }\r\n        //     }\r\n        // }\r\n\r\n        /**\r\n         * Delete the storylet of given stID as payload\r\n         * Delete all its choices\r\n         * Loop thru all storylets and delete all choices pointing to this one\r\n         * \r\n         * So basically, when we delete a storylet, we also delete all \r\n         * incoming and outgoing connectors (choice)\r\n         * i.e. deleting 1 storylet and lots of choices\r\n         */\r\n        case STORYLET_DELETE: {\r\n            let stID = action.payload\r\n            let st = state.storylets[stID]\r\n            let storylets = {...state.storylets}\r\n            let choices = {...state.choices}\r\n            // Delete all outgoing choices\r\n            for(let cID of st.choices) {\r\n                delete choices[cID]\r\n            }\r\n\r\n            // Now loop thru all the storylets, except this one\r\n            // And delete choices which point to this storylet\r\n            for(let id in storylets) {\r\n                if (id === stID) continue\r\n                storylets[id].choices = storylets[id].choices.filter(cID => {\r\n                    let ch = choices[cID]\r\n                    if(ch.next === stID) {\r\n                        delete choices[cID]\r\n                        return false\r\n                    }\r\n                    return true\r\n                })\r\n            }\r\n\r\n            // Finally delete this ST\r\n            delete storylets[stID]\r\n\r\n            let newState = {\r\n                ...state,\r\n                storylets,\r\n                choices\r\n            }\r\n            // console.log(newState)\r\n            return newState\r\n        }\r\n\r\n        /**\r\n         * Update the given storylet field of given STID as typed\r\n         */\r\n        case STORYLET_UPDATE_FIELD: {\r\n            const {stID, fieldName, value} = action.payload\r\n            const newST = {...state.storylets[stID]}\r\n            newST[fieldName] = value\r\n            return {\r\n                ...state,\r\n                storylets: {\r\n                    ...state.storylets,\r\n                    [stID]: newST\r\n                }\r\n            }\r\n        }\r\n\r\n        case STORYLET_UPDATE_ALL_TEXT: {\r\n            const { stID, title, text } = action.payload\r\n            const newST = {\r\n                ...state.storylets[stID],\r\n                title, text\r\n            }\r\n            return {\r\n                ...state,\r\n                storylets: {\r\n                    ...state.storylets,\r\n                    [stID]: newST\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * ADD a single Storyboard Item to Storyboard array\r\n         * Each Storyboard Item will be an object with STID, selectedCID (optional) etc\r\n         */\r\n        case STORYBOARD_ADD_SINGLE: {\r\n            return {\r\n                ...state,\r\n                storyboard: [...state.storyboard, {stID: action.payload.stID}]\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Add s SBI to a particular spot of SB\r\n         * If isRemoveOnly=true, that means user has deselected a Choice checkbox \r\n         * but nothing is selected\r\n         */\r\n        case STORYBOARD_INSERT_AT: {\r\n            const {sbI, nextStID, isRemoveOnly} = action.payload\r\n            let newSB = [...state.storyboard]\r\n            newSB = newSB.slice(0, sbI+1)\r\n            if (!isRemoveOnly) {\r\n                newSB.push({stID: nextStID})\r\n            }            \r\n            return {\r\n                ...state,\r\n                storyboard: newSB\r\n            }\r\n        }\r\n        \r\n        /**\r\n         * Select a particular Choice of a Storylet, means for that particular\r\n         * SBI we need to mark the CID as selected\r\n         */\r\n        case STORYBOARD_SELECT_CHOICE: {\r\n            const {sbI, cID} = action.payload\r\n            let newSB = [...state.storyboard]\r\n            newSB[sbI] = {\r\n                ...newSB[sbI],\r\n                selectedCID: cID\r\n            }\r\n            return {\r\n                ...state,\r\n                storyboard: newSB\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Create a new choice with the given data,\r\n         * Parameters in action.payload contains\r\n         * fromStID { mandatory }\r\n         * toStID { optional }\r\n         * text { optional }\r\n         * \r\n         * !IMPORTANT! When we create a choice/connector from a storylet,\r\n         * if toStorylet is not provided, it automatically creates a NEW ONE\r\n         */\r\n        case CHOICE_CREATE: {\r\n            let {fromStID, toStID, text} = action.payload\r\n            let fromST = {...state.storylets[fromStID]}\r\n            let idCounter = state.idCounter\r\n\r\n            // if toStID was not provided, create it\r\n            toStID = toStID || ('S' + (++idCounter).toString().padStart(3, '0'))\r\n\r\n            // if toST does not exist create it\r\n            let toST = state.storylets[toStID] ? {...state.storylets[toStID]} : createStorylet({id: toStID})\r\n\r\n            // Now create the Choice\r\n            let cID = 'C' + (++idCounter).toString().padStart(3, '0')\r\n            text = text || ('Choice - ' + cID)\r\n            const newChoice = createChoice({id: cID, next: toStID, text})\r\n            fromST.choices = [...fromST.choices, cID]\r\n\r\n            return {\r\n                ...state,\r\n                idCounter: idCounter,\r\n                choices: {\r\n                    ...state.choices,\r\n                    [cID]: newChoice\r\n                },\r\n                storylets: {\r\n                    ...state.storylets,\r\n                    [toStID]: toST,\r\n                    [fromStID]: fromST\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Update the given choice text as typed\r\n         */\r\n        case CHOICE_UPDATE_TEXT: {\r\n            const {cID, value} = action.payload\r\n            const newChoice = {...state.choices[cID]}\r\n            newChoice.text = value\r\n            return {\r\n                ...state,\r\n                choices: {\r\n                    ...state.choices,\r\n                    [cID]: newChoice\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * CHOICE_DELETE => delete a choice of given ID\r\n         */\r\n        case CHOICE_DELETE: {\r\n            const cID = action.payload\r\n            let choices = {...state.choices}\r\n            // Go thru all the storylets\r\n            // And delete this cID from whoever has this choice\r\n            // Note: each choice is unique, one to one connector\r\n            // i.e. one choice belongs to 1 storylet only\r\n            // and it points to only 1 storylet with its next\r\n            let st;\r\n            for(let id in state.storylets) {\r\n                if(state.storylets[id].choices.indexOf(cID) > -1) {\r\n                    st = {...state.storylets[id]}\r\n                    break\r\n                }\r\n            }\r\n            // remove this cID from its parent st\r\n            st.choices = [...st.choices]\r\n            st.choices.splice(st.choices.indexOf(cID), 1)\r\n\r\n            // now delete this choice\r\n            delete choices[cID]\r\n\r\n            return {\r\n                ...state,\r\n                storylets: {\r\n                    ...state.storylets,\r\n                    [st.id]: st\r\n                },\r\n                choices\r\n            }\r\n\r\n        }\r\n        \r\n        /**\r\n         * Add the given choice to the given Storylet's choices array\r\n         */\r\n        case ADD_CID_TO_STID: {\r\n            const {stID, cID} = action.payload\r\n            const newST = {...state.storylets[stID]}\r\n            newST.choices = [...newST.choices, cID]\r\n            return {\r\n                ...state,\r\n                storylets: {\r\n                    ...state.storylets,\r\n                    [stID]: newST\r\n                }\r\n            }\r\n        }\r\n\r\n        default: {\r\n            return state\r\n        }\r\n    }\r\n}\r\n\r\nexport default wipTaleReducer","/**\r\n * odReducer => Online Data Reducer is nothing but a cache for saving data read from api\r\n */\r\nimport {\r\n    ONLINE_DATA_SAVE_MY_TALES,\r\n    ONLINE_DATA_CLEAR_TALES\r\n}\r\nfrom '../actionTypes'\r\nconst initState = {\r\n    myTales: []\r\n}\r\n\r\nconst odReducer = (state = initState, action) => {\r\n    switch (action.type) {\r\n\r\n        case ONLINE_DATA_SAVE_MY_TALES: {\r\n            return {\r\n                ...state,\r\n                myTales: action.payload\r\n            }\r\n        }\r\n\r\n        case ONLINE_DATA_CLEAR_TALES: {\r\n            return { myTales: [] }\r\n        }\r\n\r\n        default:\r\n            return state\r\n\r\n    }\r\n}\r\n\r\nexport default odReducer","import { combineReducers } from 'redux'\r\nimport userReducer from './userReducer'\r\nimport uiReducer from './uiReducer'\r\nimport wipTaleReducer from './wipTaleReducer'\r\nimport odReducer from './odReducer'\r\n\r\nconst rootReducer = combineReducers({\r\n    ui: uiReducer,\r\n    user: userReducer,\r\n    wipTale: wipTaleReducer,\r\n    od: odReducer\r\n})\r\n\r\nexport default rootReducer","import { createStore, applyMiddleware } from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport { persistStore, persistReducer } from 'redux-persist'\r\nimport { composeWithDevTools } from 'redux-devtools-extension'\r\nimport rootReducer from './reducers/rootReducer'\r\n// import storage from 'redux-persist/lib/storage'\r\nimport storageSession from 'redux-persist/lib/storage/session'\r\n\r\nconst persistConfig = {\r\n    key: 'rtlroot',\r\n    // storage\r\n    storage: storageSession,\r\n    // whitelist: ['wipTale'] // only navigation will be persisted\r\n}\r\n\r\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\r\n\r\nconst store = createStore(persistedReducer, composeWithDevTools(\r\n    applyMiddleware(thunk)\r\n))\r\n\r\nlet persistor = persistStore(store)\r\n\r\nexport { store, persistor }","import { createMuiTheme } from '@material-ui/core/styles';\r\n\r\n// TEST AND PLAY BELOW\r\n// https://material-ui.com/customization/color/#playground\r\n// https://material.io/resources/color/#!/?view.left=0&view.right=0&primary.color=D50000&secondary.color=EF5350\r\n// https://codepen.io/codotronix/pen/NWRXjVp\r\n\r\n\r\n// $themeColor: #d50000; // #d50000 red accent-4 // #e65100 orange darken-4   // #f44336 red;\r\n// $themeColorAlpha: rgba(213, 0, 0, 0.3);          //#e6510080;    // themeColor appended with 80. for .5 alpha\r\n// $themeColorDisabled: #ff9e80; //deep-orange accent-1\r\n// $themeColorLight: #ffcdd2;  // red lighten-4\r\n// $themeColorDark: darkred;\r\n// $themeColorDarker: rgb(113, 0, 0);\r\n// $textLight: #e57373; // red lighten-2\r\n// $iconColor: #ff7043; //deep-orange lighten-1 //#ef5350; // red lighten-1 // used for many things, not only icons\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      light: '#dd3333',\r\n      main: '#d50000',\r\n      dark: '#950000',\r\n      contrastText: '#fff',\r\n    },\r\n    secondary: {\r\n      light: '#ff6333',\r\n      main: '#ff3d00',\r\n      dark: '#b22a00',\r\n      contrastText: '#fff',\r\n    },\r\n  },\r\n  typography: {\r\n    fontFamily: [\r\n      '\"Exo\"',\r\n      'sans-serif'\r\n    ].join(','),\r\n  },\r\n  props: {\r\n    MuiButton: {\r\n      size: 'small',\r\n    },\r\n  }\r\n});\r\n\r\nexport default theme","console.log(\"NODE_ENV = \", process.env.NODE_ENV)\r\n\r\nexport const env = process.env.NODE_ENV\r\n\r\nconst root = {\r\n    \"production\": \"\",\r\n    \"development\": \"http://localhost:9090\"            // node-express backend\r\n}\r\n\r\nconst ext = {\r\n    \"production\": \"\",\r\n    \"development\": \"\",\r\n    \"c\": \".json\"            // needed incase of JSON stubbing\r\n}\r\n\r\nexport const config = {\r\n    origin: 'https://reactale.github.io',\r\n    appType: 'HYBRIDNODE',       // 'APP' or 'HYBRIDNODE' or 'WEB'\r\n\r\n    defaultImg: '/r/assets/img/bg/small/storytelling-4203628_640.jpg'\r\n}\r\n\r\nexport const getRoot = () => root[env]\r\n\r\n\r\nexport const GET_APP_VER = `${root[env]}/rtale/api/getappver${ext[env]}`\r\nexport const GET_LOGGEDIN_USER = `${root[env]}/rtale/api/v2/getloggedinuser${ext[env]}`\r\nexport const GET_STORY = `${root[env]}/rtale/api/v2/getstory${ext[env]}`\r\nexport const GET_MYSTORY = `${root[env]}/rtale/api/v2/getmystory${ext[env]}`\r\nexport const DELETE_MYTALE = `${root[env]}/rtale/api/v2/deletemytale${ext[env]}`\r\nexport const GET_MYSTORIES = `${root[env]}/rtale/api/v2/getmystories${ext[env]}`\r\nexport const CREATE_STORYURL = `${root[env]}/rtale/api/v2/uploadstorybanner${ext[env]}`\r\nexport const CREATE_TALE = `${root[env]}/rtale/api/v2/createstory${ext[env]}`\r\nexport const CREATE_STORYIMG = `${root[env]}/rtale/api/v2/createstory${ext[env]}`\r\nexport const LOGIN = `${root[env]}/rtale/api/v2/signin${ext[env]}`\r\nexport const SIGNUP = `${root[env]}/rtale/api/v2/signup${ext[env]}`\r\nexport const VERIFY_EMAIL = `${root[env]}/rtale/api/v2/verifyemail${ext[env]}`\r\nexport const LOGOUT = `${root[env]}/rtale/api/v2/signout${ext[env]}`\r\nexport const ALLTALES = `${root[env]}/rtale/api/v2/getallstories${ext[env]}`\r\nexport const PUB_UNPUB = `${root[env]}/rtale/api/v2/publish${ext[env]}`\r\nexport const RESEND_OTP = `${root[env]}/rtale/api/v2/resendotp${ext[env]}`\r\nexport const UPDATE_NEWPSWD = `${root[env]}/rtale/api/v2/updatenewpswd${ext[env]}`\r\nexport const UPDATE_USERNAME = `${root[env]}/rtale/api/v2/updateusername${ext[env]}`\r\nexport const UPDATE_MYPROFILE = `${root[env]}/rtale/api/v2/updatemyprofile${ext[env]}`\r\nexport const UPDATE_MYPREFERENCES = `${root[env]}/rtale/api/v2/updatemypreferences${ext[env]}`\r\nexport const UPLOAD_BANNER = `${root[env]}/rtale/api/v2/uploadstorybanner${ext[env]}`\r\nexport const EXEC_LINK_A_TALE = `${root[env]}/rtale/api/v2/execlinkatale${ext[env]}`","const RTLSESSION = 'RTLSESSION'\r\n\r\n// The local variable to store the full of session object\r\nlet rtlsession = JSON.parse(window.sessionStorage.getItem(RTLSESSION) || '{}')\r\n\r\n// Internal Function to SaveAll\r\nconst __save = () => window.sessionStorage.setItem(RTLSESSION, JSON.stringify(rtlsession))\r\n\r\nexport const getFromSession = key => rtlsession[key]\r\n\r\nexport const setToSession = (key, val) => { \r\n    rtlsession[key] = val\r\n    __save()\r\n}\r\n\r\nexport const delFromSession = key => {\r\n    delete rtlsession[key]\r\n    __save()\r\n}\r\n\r\nexport const clearSession = () => {\r\n    rtlsession = {}\r\n    __save()\r\n}","export const FLOW_ST_WIDTH = 150\r\nexport const FLOW_ST_HEIGHT = 50\r\nexport const FLOW_KNOW_RAD = 6\r\nexport const FLOW_KNOT_IN_X = FLOW_ST_WIDTH / 2\r\nexport const FLOW_KNOT_IN_Y = -(FLOW_KNOW_RAD/2)\r\nexport const FLOW_KNOT_OUT_X = FLOW_ST_WIDTH / 2\r\nexport const FLOW_KNOT_OUT_Y = FLOW_ST_HEIGHT + (FLOW_KNOW_RAD/2)\r\nexport const FLOW_WIRE_SHIFT_X = FLOW_ST_WIDTH / 2\r\nexport const FLOW_WIRE_SHIFT_FROM_Y = FLOW_ST_HEIGHT + (FLOW_KNOW_RAD/2)\r\nexport const FLOW_WIRE_SHIFT_TO_Y = -(FLOW_KNOW_RAD/2)\r\nexport const FLOW_H_GAP = 50    // Gap between 2 ST\r\nexport const FLOW_V_GAP = 80    // Gap between 2 ST\r\nexport const FLOW_H_SHIFT = 20  // to move the entire setup by a constant amount without breaking anything\r\nexport const FLOW_V_SHIFT = 30  // to move the entire setup by a constant amount without breaking anything\r\nexport const FLOW_SPEED = 10\r\nexport const LOCAL_TALE_IDENTIFIER = \"__local__\"\r\n\r\n\r\nexport const COUNTRIES = [\"Afghanistan\",\"Albania\",\"Algeria\",\"Andorra\",\"Angola\",\"Antigua and Barbuda\",\"Argentina\",\"Armenia\",\"Australia\",\"Austria\",\"Azerbaijan\",\"Bahamas\",\"Bahrain\",\"Bangladesh\",\"Barbados\",\"Belarus\",\"Belgium\",\"Belize\",\"Benin\",\"Bhutan\",\"Bolivia\",\"Bosnia and Herzegovina\",\"Botswana\",\"Brazil\",\"Brunei\",\"Bulgaria\",\"Burkina Faso\",\"Burundi\",\"Cabo Verde\",\"Cambodia\",\"Cameroon\",\"Canada\",\"Central African Republic (CAR)\",\"Chad\",\"Chile\",\"China\",\"Colombia\",\"Comoros\",\"Congo, Democratic Republic of the\",\"Congo, Republic of the\",\"Costa Rica\",\"Cote d'Ivoire\",\"Croatia\",\"Cuba\",\"Cyprus\",\"Czechia\",\"Denmark\",\"Djibouti\",\"Dominica\",\"Dominican Republic\",\"Ecuador\",\"Egypt\",\"El Salvador\",\"Equatorial Guinea\",\"Eritrea\",\"Estonia\",\"Eswatini (formerly Swaziland)\",\"Ethiopia\",\"Fiji\",\"Finland\",\"France\",\"Gabon\",\"Gambia\",\"Georgia\",\"Germany\",\"Ghana\",\"Greece\",\"Grenada\",\"Guatemala\",\"Guinea\",\"Guinea-Bissau\",\"Guyana\",\"Haiti\",\"Honduras\",\"Hungary\",\"Iceland\",\"India\",\"Indonesia\",\"Iran\",\"Iraq\",\"Ireland\",\"Israel\",\"Italy\",\"Jamaica\",\"Japan\",\"Jordan\",\"Kazakhstan\",\"Kenya\",\"Kiribati\",\"Kosovo\",\"Kuwait\",\"Kyrgyzstan\",\"Laos\",\"Latvia\",\"Lebanon\",\"Lesotho\",\"Liberia\",\"Libya\",\"Liechtenstein\",\"Lithuania\",\"Luxembourg\",\"Madagascar\",\"Malawi\",\"Malaysia\",\"Maldives\",\"Mali\",\"Malta\",\"Marshall Islands\",\"Mauritania\",\"Mauritius\",\"Mexico\",\"Micronesia\",\"Moldova\",\"Monaco\",\"Mongolia\",\"Montenegro\",\"Morocco\",\"Mozambique\",\"Myanmar (formerly Burma)\",\"Namibia\",\"Nauru\",\"Nepal\",\"Netherlands\",\"New Zealand\",\"Nicaragua\",\"Niger\",\"Nigeria\",\"North Korea\",\"North Macedonia (formerly Macedonia)\",\"Norway\",\"Oman\",\"Pakistan\",\"Palau\",\"Palestine\",\"Panama\",\"Papua New Guinea\",\"Paraguay\",\"Peru\",\"Philippines\",\"Poland\",\"Portugal\",\"Qatar\",\"Romania\",\"Russia\",\"Rwanda\",\"Saint Kitts and Nevis\",\"Saint Lucia\",\"Saint Vincent and the Grenadines\",\"Samoa\",\"San Marino\",\"Sao Tome and Principe\",\"Saudi Arabia\",\"Senegal\",\"Serbia\",\"Seychelles\",\"Sierra Leone\",\"Singapore\",\"Slovakia\",\"Slovenia\",\"Solomon Islands\",\"Somalia\",\"South Africa\",\"South Korea\",\"South Sudan\",\"Spain\",\"Sri Lanka\",\"Sudan\",\"Suriname\",\"Sweden\",\"Switzerland\",\"Syria\",\"Taiwan\",\"Tajikistan\",\"Tanzania\",\"Thailand\",\"Timor-Leste\",\"Togo\",\"Tonga\",\"Trinidad and Tobago\",\"Tunisia\",\"Turkey\",\"Turkmenistan\",\"Tuvalu\",\"Uganda\",\"Ukraine\",\"United Arab Emirates (UAE)\",\"United Kingdom (UK)\",\"United States of America (USA)\",\"Uruguay\",\"Uzbekistan\",\"Vanuatu\",\"Vatican City (Holy See)\",\"Venezuela\",\"Vietnam\",\"Yemen\",\"Zambia\",\"Zimbabwe\"]\r\nexport const LANGUAGES = [\"Algerian Arabic\", \"Amharic\", \"Assamese\", \"Bengali\", \"Bhojpuri\", \"Burmese\", \"Cebuano\", \"Chhattisgarhi\", \"Chittagonian\", \"Czech\", \"Deccan\", \"Dutch\", \"Eastern Punjabi\", \"Egyptian Arabic\", \"English\", \"French\", \"Gan\", \"German\", \"Greek\", \"Gujarati\", \"Hakka\", \"Hausa\", \"Hejazi Arabic\", \"Hindi\", \"Hungarian\", \"Igbo\", \"Indonesian\", \"Iranian Persian\", \"Italian\", \"Japanese\", \"Javanese\", \"Jinyu\", \"Kannada\", \"Kazakh\", \"Khmer\", \"Kinyarwanda\", \"Korean\", \"Magahi\", \"Maithili\", \"Malay\", \"Malayalam\", \"Mandarin\", \"Marathi\", \"Mesopotamian Arabic\", \"Min Bei Chinese\", \"Min Dong Chinese\", \"Min Nan\", \"Moroccan Arabic\", \"Nepali\", \"Nigerian Fulfulde\", \"North Levantine Arabic\", \"Northern Kurdish\", \"Northern Pashto\", \"Northern Uzbek\", \"Odia\", \"Polish\", \"Portuguese\", \"Romanian\", \"Rundi\", \"Russian\", \"Sanaani Spoken Arabic\", \"Saraiki\", \"Saidi Arabic\", \"Sindhi\", \"Sinhala\", \"Somali\", \"South Azerbaijani\", \"South Levantine Arabic\", \"Southern Pashto\", \"Spanish\", \"Sudanese Arabic\", \"Sunda\", \"Sylheti\", \"Tagalog\", \"Tamil\", \"Taizzi-Adeni Arabic\", \"Telugu\", \"Thai\", \"Tunisian Arabic\", \"Turkish\", \"Ukrainian\", \"Urdu\", \"Uyghur\", \"Vietnamese\", \"Western Punjabi\", \"Wu\", \"Xiang Chinese\", \"Yoruba\", \"Yue\", \"Zulu\", \"Other\"]\r\nexport const GENRES = [\"Absurdist\", \"Action\", \"Adventure\", \"Comedy\", \"Crime\", \"Drama\", \"Fantasy\", \"Historical\", \"Historical fiction\", \"Horror\", \"Magical realism\", \"Mystery\", \"Paranoid fiction\", \"Philosophical\", \"Political\", \"Romance\", \"Saga\", \"Satire\", \"Science fiction\", \"Social\", \"Speculative\", \"Surreal\", \"Thriller\", \"Urban\", \"Western\", \"Whimsical\", \"Other\"]\r\n\r\n/**\r\n * Allowed tags for DOMPurify Sanitization,\r\n * b = bold, i = italics, u = underline, c = center, s = strikethru\r\n */\r\nexport const ALLOWED_TAGS = ['b', 'i', 'u', 'c', 's', 'br', 'hr']\r\n\r\nexport const CONST_SESSION_USER = 'SESSION_AUTH_DATA'\r\n\r\nexport const CONST_TITLE = \"Reactale - Readers Act, Tales React - World's First Dynamic Story Reading / Writing Platform\"","import axios from 'axios'\r\nimport { getFromSession } from '../services/session.service'\r\nimport { CONST_SESSION_USER } from './constants'\r\n\r\nlet tok = window.localStorage.getItem('rtltok')\r\n\r\nexport const getToken = () => (getFromSession(CONST_SESSION_USER) || {})['tok']\r\n\r\nexport const ajaxPost = (url, jsonData) => {\r\n    return axios.post(url, jsonData, {\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': 'Bearer ' + getToken()\r\n        }\r\n    })\r\n}\r\n\r\nexport const ajaxGet = (url, params) => {\r\n    return axios.get(url, {\r\n        params,\r\n        headers: {\r\n            'Authorization': 'Bearer ' + getToken()\r\n        }\r\n    })\r\n}\r\n\r\n/**\r\n * \r\n * @param {String} url | the url without path params\r\n * @param {String} paramsArr | array of path-params in exact sequence in which they should appear in path\r\n */\r\nexport const ajaxGetWPathParams = (url, paramsArr) => {\r\n    paramsArr.forEach(p => url += '/' + p);\r\n    return ajaxGet(url)\r\n}","import React, { useEffect } from 'react'\r\nimport { makeStyles, AppBar, Toolbar, IconButton } from '@material-ui/core'\r\nimport MenuIcon from '@material-ui/icons/Menu'\r\n// import logoImg from '../../../assets/img/logo/Reactale-logo-50h-white-bg.png'\r\nimport styles from './style.module.css'\r\nimport { connect } from 'react-redux'\r\nimport { UI_SIDEBAR_OPEN, USER_UPDATE } from '../../../redux/actionTypes'\r\nimport { GET_LOGGEDIN_USER } from '../../../utils/urls'\r\n// import axios from 'axios'\r\nimport { ajaxGet } from '../../../utils/ajax'\r\nconst notify = window['notify']\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    menuButton: {\r\n        marginRight: theme.spacing(2),\r\n    },\r\n    toolbar: {\r\n        padding: '0 10px'\r\n    },\r\n    greet: {\r\n        width: 63,\r\n        fontSize: 13,\r\n        textAlign: 'center',\r\n        overflow: 'hidden',\r\n        textOverflow: 'ellipsis',\r\n        marginLeft: 7\r\n    },\r\n    profileLink: {\r\n        color: '#fff',\r\n        textDecoration: 'none'\r\n    }\r\n}))\r\n\r\nconst Header = props => {\r\n    const classes = useStyles()\r\n    const { openSidebar, user, updateUser } = props\r\n\r\n    useEffect(() => {\r\n        window.showLoader()\r\n        if (!user.email) {\r\n            ajaxGet(GET_LOGGEDIN_USER)\r\n            .then(res => {\r\n                const { status, msg, user } = res.data\r\n                if(status === 200) {\r\n                    updateUser(user)\r\n                }\r\n                else {\r\n                    // notify(msg)  // Nothing to do, it's ok if user is not logged in \r\n                }\r\n            })\r\n            .catch(err => { \r\n                //console.log(err)\r\n            })\r\n            .finally(() => window.hideLoader())\r\n        }\r\n    }, [])\r\n\r\n    // console.log(styles)\r\n    return (\r\n        <div className=\"flex-grow-1\">\r\n            <AppBar position=\"static\">\r\n                <Toolbar className={classes.toolbar}>\r\n                    <IconButton edge=\"start\" onClick={openSidebar} className={classes.menuButton} color=\"inherit\" aria-label=\"menu\">\r\n                        <MenuIcon />\r\n                    </IconButton>\r\n                    <div className={styles.logoContainer}>\r\n                        <img src=\"/r/assets/img/logo/Reactale-logo-50h-white-bg.png\" alt=\"Reactale Logo\" className={styles.logoImg} />\r\n                    </div>\r\n                    {/* <Button color=\"inherit\" onClick={openLoginModal}>Login</Button> */}\r\n                    <div className={classes.greet}>\r\n                        {!user.firstname && <span title=\"Welcome Guest\">Welcome Guest!</span>}\r\n                        {user.firstname && \r\n                            <a href=\"#/profile\" className={classes.profileLink}>\r\n                                <span title={'Welcome ' + user.firstname}>Welcome {user.firstname}!</span>\r\n                            </a>}\r\n                    </div>\r\n                </Toolbar>\r\n            </AppBar>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    user: state.user\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    openSidebar: () => dispatch({ type: UI_SIDEBAR_OPEN }),\r\n    updateUser: user => dispatch({ type: USER_UPDATE, payload: {user} })\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Header)\r\n","import axios from 'axios'\r\nimport { ajaxPost } from '../../utils/ajax'\r\nimport {\r\n    CREATE_TALE\r\n} from '../../utils/urls'\r\nimport {\r\n    TALE_CREATE,\r\n    TALE_SET_AS_WIP,\r\n    TALE_STATE_CLEANUP,\r\n    STORYLET_UPDATE_ALL_TEXT,\r\n    CHOICE_CREATE,\r\n    CHOICE_UPDATE_TEXT\r\n} from '../actionTypes'\r\nconst notify = window['notify']\r\n\r\nexport const actionCreateNewTale = () => {\r\n    return (dispatch, getState) => {\r\n        dispatch({type: TALE_CREATE})\r\n    }\r\n}\r\n\r\nexport const actionUpdateImgUrl = imgUrl => {\r\n    window.showLoader()\r\n    return (dispatch, getState) => {\r\n        const { storyboard, ...tale } = getState().wipTale\r\n        tale.info.imgUrl = imgUrl\r\n        console.log(\"tale.info.imgUrl = \", tale.info.imgUrl)\r\n        console.log(\"imgUrl = \", imgUrl)\r\n\r\n        ajaxPost(CREATE_TALE, tale)\r\n        .then(res => {\r\n            console.log(res.data)\r\n            let {status, tale, msg } = res.data\r\n            if(status === 200) {\r\n                notify(\"Image uploaded successfully\")\r\n                tale = JSON.parse(tale)\r\n                dispatch({\r\n                    type: TALE_SET_AS_WIP,\r\n                    payload: tale\r\n                })\r\n            }\r\n            else {\r\n                notify(msg)\r\n            }\r\n        })\r\n        .catch(err => notify('Some error occured. Please try again later ...'))\r\n        .finally(() => window.hideLoader())\r\n        dispatch({type: TALE_CREATE})\r\n    }\r\n}\r\n\r\nexport const actionSaveTaleAndReset = () => {\r\n    return (dispatch, getState) => {\r\n        //TODO: Dispatch a save command\r\n        //Then, reset the wipTale state\r\n        dispatch({type: TALE_STATE_CLEANUP})\r\n    }\r\n}\r\n\r\nexport const actionUpdateSTAllText = (stID, title, text) => {\r\n    return dispatch => dispatch({\r\n        type: STORYLET_UPDATE_ALL_TEXT,\r\n        payload: { stID, title, text }\r\n    })\r\n}\r\n\r\nexport const actionCreateChoice = (fromStID, toStID, text) => {\r\n    if(!fromStID) {\r\n        throw (new Error(\"fromStID is mandatory while creating a new choice\"))\r\n    }\r\n    return (dispatch, getState) => {\r\n        dispatch({\r\n            type: CHOICE_CREATE,\r\n            payload: {fromStID, toStID, text}\r\n        })\r\n    }\r\n}\r\n\r\nexport const actionUpdateCText = (cID, value) => {\r\n    return (dispatch, getState) => {\r\n        dispatch({\r\n            type: CHOICE_UPDATE_TEXT,\r\n            payload: {cID, value}\r\n        })\r\n    }\r\n}\r\n\r\nexport const actionSetTaleAsWIP = tale => {\r\n    return dispatch => {\r\n        tale.idCounter = tale.idCounter || 100\r\n        // console.log(tale)\r\n        // SET THE WIP TALE\r\n        dispatch({\r\n            type: TALE_SET_AS_WIP,\r\n            payload: tale\r\n        })\r\n    }\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles, Dialog, DialogContent, DialogTitle } from '@material-ui/core'\r\nimport CancelIcon from '@material-ui/icons/Cancel'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  titleBar: {\r\n    margin: 0,\r\n    backgroundColor: theme.palette.primary.main,\r\n    color: '#fff',\r\n    padding: `${theme.spacing(.5)}px ${theme.spacing(1)}px`,\r\n    fontSize: theme.typography.pxToRem(20),\r\n    minWidth: 300\r\n  },\r\n  modalBody: {\r\n    padding: `${theme.spacing(2)}px`\r\n  },\r\n  closeIco: {\r\n    position: \"absolute\",\r\n    top: 3,\r\n    right: 2,\r\n    boxSizing: 'content-box',\r\n    padding: '5px 7px',\r\n    color: '#fff',\r\n    cursor: 'pointer'\r\n  }\r\n}))\r\n\r\nconst SimpleModal = props => {\r\n  const classes = useStyles();\r\n  const { isOpen, handleClose, title, children, className } = props\r\n\r\n  return (\r\n    <div className={clsx(className)}>\r\n      <Dialog open={isOpen} onClose={handleClose}\r\n        aria-labelledby={`form-dialog-${title}`}\r\n      >\r\n        <DialogTitle className={classes.titleBar}>\r\n          <CancelIcon className={classes.closeIco} onClick={handleClose}/>\r\n          {title}\r\n        </DialogTitle>\r\n        <DialogContent className={classes.modalBody}>\r\n          {children}\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SimpleModal\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// import React from 'react'\r\n// import { makeStyles } from '@material-ui/core/styles'\r\n// import clsx from 'clsx'\r\n// import CancelIcon from '@material-ui/icons/Cancel'\r\n// import Modal from '@material-ui/core/Modal'\r\n\r\n// const useStyles = makeStyles(theme => ({\r\n//   modalWrapper: {\r\n//     overflow: \"auto\"\r\n//   },\r\n//   modalBox: {\r\n//     position: 'relative',\r\n//     width: 'calc(100vw - 200px)',\r\n//     margin: 'calc(100vh / 5) auto',\r\n//     minWidth: 300,\r\n//     backgroundColor: theme.palette.background.paper,\r\n//     border: `5px double ${theme.palette.primary.main}`,\r\n//     boxShadow: theme.shadows[5]\r\n//   },\r\n//   titleBar: {\r\n//     margin: 0,\r\n//     backgroundColor: theme.palette.primary.main,\r\n//     color: '#fff',\r\n//     padding: `${theme.spacing(.5)}px ${theme.spacing(1)}px`,\r\n//     fontSize: theme.typography.pxToRem(20)\r\n//   },\r\n//   modalBody: {\r\n//     padding: `${theme.spacing(2)}px ${theme.spacing(1)}px`\r\n//   },\r\n//   closeIco: {\r\n//     position: \"absolute\",\r\n//     top: 0,\r\n//     right: 0,\r\n//     boxSizing: 'content-box',\r\n//     padding: '5px 7px',\r\n//     color: '#fff',\r\n//     cursor: 'pointer'\r\n//   }\r\n// }))\r\n\r\n// // const getDynamicStyle = () => ({\r\n// //   width: `${window.innerWidth - 200}px`,\r\n// //   margin: `${window.innerHeight / 5}px auto`\r\n// // })\r\n\r\n// const SimpleModal = props => {\r\n//   const classes = useStyles();\r\n//   const { isOpen, handleClose, title, children, className } = props\r\n  \r\n//   return (\r\n//       <Modal\r\n//         aria-labelledby={title}\r\n//         aria-describedby={title}\r\n//         className={classes.modalWrapper}\r\n//         open={!!isOpen}\r\n//         onClose={handleClose}\r\n//       >\r\n//         <div className={clsx(classes.modalBox, className)}>\r\n//           <CancelIcon className={classes.closeIco} onClick={handleClose}/>\r\n//           <h2 className={classes.titleBar}>{title}</h2>\r\n//           <div className={classes.modalBody}>\r\n//             {children}\r\n//           </div>\r\n//         </div>\r\n//       </Modal>\r\n//   );\r\n// }\r\n\r\n// export default SimpleModal\r\n","// LocalStorage Key\r\nconst OFFLINE_SAVE_KEY = \"allReactales\"\r\n\r\n// to get all offline reactales as { id1: tale1, id2: tale2 ... }\r\nexport const getOfflineSavedTales = () => JSON.parse(window.localStorage.getItem(OFFLINE_SAVE_KEY)) || {}\r\n\r\n// get only 1 tale\r\nexport const getOneOfflineSavedTales = taleId => getOfflineSavedTales()[taleId]\r\n\r\n// to delete all offline saved tales\r\nexport const clearOfflineSavedTales = () => window.localStorage.setItem(OFFLINE_SAVE_KEY, \"{}\")\r\n\r\n/**\r\n * to save a reactale offline (localStorage)\r\n * returns updated allReactales object\r\n * @param {*} tale | Reactale\r\n */\r\nexport const saveOneOfflineSavedTales = tale => {\r\n    const allReactales = getOfflineSavedTales()\r\n    allReactales[tale.id] = tale\r\n    window.localStorage.setItem(OFFLINE_SAVE_KEY, JSON.stringify(allReactales))\r\n    return allReactales\r\n}\r\n\r\n/**\r\n * Save the entire Reactale Object passed\r\n * *** DON'T USE FROM OUTSIDE\r\n * @param {*} allReactales \r\n */\r\nexport const _saveAllOfflineSavedTales = allReactales => window.localStorage.setItem(OFFLINE_SAVE_KEY, JSON.stringify(allReactales))\r\n\r\n/**\r\n * Delete one rectale from localstorage\r\n * Return the updated Object { id1: tale1, id2: tale2 ... }\r\n * @param {String} taleID | Offline Reactale Id\r\n */\r\nexport const deleteOneOfflineSavedTales = taleID => {\r\n    let allReactales = getOfflineSavedTales()\r\n    delete allReactales[taleID]\r\n    _saveAllOfflineSavedTales(allReactales)\r\n    return allReactales\r\n}","import React, { useState, useEffect } from 'react'\r\n// import clsx from 'clsx'\r\nimport { makeStyles, Box, Button, FormControl, FormLabel, \r\n  FormControlLabel, Radio, RadioGroup  } from '@material-ui/core'\r\nimport SimpleModal from './SimpleModal'\r\nimport { clearOfflineSavedTales } from '../../../services/offlinesavedtales.service'\r\nconst notify = window['notify']\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  titleBar: {\r\n    margin: 0,\r\n    backgroundColor: theme.palette.primary.main,\r\n    color: '#fff',\r\n    padding: `${theme.spacing(.5)}px ${theme.spacing(1)}px`,\r\n    fontSize: theme.typography.pxToRem(20),\r\n    minWidth: 300\r\n  },\r\n  modalBody: {\r\n    padding: `${theme.spacing(2)}px`\r\n  },\r\n  closeIco: {\r\n    position: \"absolute\",\r\n    top: 3,\r\n    right: 2,\r\n    boxSizing: 'content-box',\r\n    padding: '5px 7px',\r\n    color: '#fff',\r\n    cursor: 'pointer'\r\n  }\r\n}))\r\n\r\nconst LogOutModal = props => {\r\n  const classes = useStyles()\r\n  const { isOpen, handleClose, logOut } = props\r\n  const [doDeleteOfflineTales, setDoDeleteOfflineTales] = useState('-') // Y, N\r\n\r\n  /**\r\n   * Whenever closed and re-opened, \r\n   * user should CONFIRM their offline save preference again\r\n   */\r\n  useEffect(() => {\r\n    setDoDeleteOfflineTales('-')\r\n  }, [isOpen])\r\n\r\n  const handleOfflineTalesRadio = e => {\r\n    setDoDeleteOfflineTales(e.target.value)\r\n  }\r\n\r\n  const handleLogout = e => {\r\n    // Mandatory Check\r\n    if(doDeleteOfflineTales !== 'Y' && doDeleteOfflineTales !== 'N') {\r\n      notify('Select whether to keep or delete offline tales')\r\n    }\r\n    else {\r\n      if (doDeleteOfflineTales === 'Y') {\r\n        clearOfflineSavedTales()\r\n        notify(\"Offline tales deleted successfully\")\r\n      }\r\n      logOut()\r\n      handleClose()\r\n    }\r\n  }\r\n\r\n  return (\r\n    <SimpleModal\r\n      isOpen={isOpen}\r\n      handleClose={handleClose}\r\n      title=\"Please Confirm\"\r\n    >\r\n      <p>\r\n        Are you sure you want to logout ?\r\n      </p>\r\n      <p>\r\n        <b>Warning:</b> Since Offline Saved Tales are saved in common memory location, they can be seen/deleted by anyone using Reactale in this device (Safer options are saving online or export/import).\r\n      </p>\r\n      <Box my={3}>\r\n      <FormControl component=\"fieldset\">\r\n        <FormLabel component=\"legend\">So, do you want to delete offline tales ?</FormLabel>\r\n          <RadioGroup aria-label=\"gender\" name=\"gender1\" value={doDeleteOfflineTales} onChange={handleOfflineTalesRadio}>\r\n            <FormControlLabel value=\"Y\" control={<Radio />} label=\"Yes, delete offline tales\" />\r\n            <FormControlLabel value=\"N\" control={<Radio />} label=\"No, don't delete offline tales\" />\r\n            <FormControlLabel value=\"-\" control={<Radio />} label=\"Choose either of above 2 options\" />\r\n          </RadioGroup>\r\n        </FormControl>\r\n      </Box>\r\n      <Box mt={2} className=\"text-right\">\r\n        <Button \r\n            variant=\"outlined\"\r\n            color=\"primary\"\r\n            onClick={handleClose}\r\n        >\r\n          Cancel\r\n        </Button>\r\n        <Button \r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            onClick={handleLogout}\r\n            className=\"ml-5\"\r\n        >\r\n          Log out\r\n        </Button>\r\n      </Box>\r\n    </SimpleModal>\r\n  );\r\n}\r\n\r\nexport default LogOutModal\r\n","import React, { useState } from 'react'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport { makeStyles, Drawer, List, ListItem, ListItemIcon, ListItemText \r\n        } from '@material-ui/core'\r\nimport { connect } from 'react-redux'\r\nimport { UI_SIDEBAR_CLOSE, UI_LOGIN_MODAL_OPEN, USER_RESET, ONLINE_DATA_CLEAR_TALES } from '../../../redux/actionTypes'\r\n// import { actionLogout } from '../../../redux/actionCreators/userActions'\r\nimport { actionSaveTaleAndReset } from '../../../redux/actionCreators/createTaleActions'\r\nimport { env } from '../../../utils/urls'\r\nimport { clearSession } from '../../../services/session.service'\r\nimport LogOutModal from '../../common/modal/LogOutModal'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  list: {\r\n    width: 250,\r\n  },\r\n  fullList: {\r\n    width: 'auto',\r\n  },\r\n  listItem: {\r\n    borderBottom: \"1px solid \" + theme.palette.primary.main,\r\n    '& .ico': {\r\n      fontSize: 20,\r\n      color: theme.palette.primary.main,\r\n      marginRight: 10\r\n    }\r\n  },\r\n  icoInList: {\r\n    minWidth: 30,\r\n    \r\n  },\r\n  ico: {\r\n    fontSize: 30\r\n  },\r\n  faIco: {\r\n    fontSize: 27,\r\n    color: theme.palette.primary.main\r\n  }\r\n}))\r\n\r\nconst navs = [\r\n  {\r\n    name: \"Home\",\r\n    url: \"/\",\r\n    iconClass: \"fas fa-home ico\"\r\n  },\r\n  {\r\n    name: \"Gallery\",\r\n    url: \"/gallery\",\r\n    iconClass: \"fas fa-book-reader ico\"\r\n  },\r\n  {\r\n    name: \"Search\",\r\n    url: \"/search\",\r\n    iconClass: \"fas fa-search ico\"\r\n  },\r\n  {\r\n    name: \"Create Tale\",\r\n    url: \"/create-tale\",\r\n    iconClass: \"fas fa-plus-square ico\"\r\n  },\r\n  {\r\n    name: \"My Tales\",\r\n    url: \"/my-tales\",\r\n    iconClass: \"fas fa-briefcase ico\"\r\n  },\r\n  {\r\n    name: \"My Profile\",\r\n    url: \"/my-profile\",\r\n    iconClass: \"fas fa-user ico\"\r\n  },\r\n  {\r\n    name: \"Notifications\",\r\n    url: \"/notifications\",\r\n    iconClass: \"fas fa-bell ico\"\r\n  }\r\n]\r\n\r\nconst Sidebard = props => {\r\n  const classes = useStyles()\r\n  const [isLogoutModalOpen, setIsLogoutModalOpen] = useState(false)\r\n  const { openLoginModal, user, resetWIPTale, resetUser, \r\n    resetFetchedTales, purgePersistedData } = props\r\n\r\n  const history = useHistory()\r\n\r\n  const beforeYouGo = (e, url) => {\r\n    const serverSideUrls = [\r\n      \"/\",\r\n      \"/gallery\",\r\n      \"/search\"\r\n    ]\r\n    // Check If it is in Server Rendered Pages\r\n    if (serverSideUrls.includes(url)) {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        window.location.href = window.location.origin + url\r\n    }\r\n    else if (url === \"/create-tale\") {\r\n      // this is the best place to cleanup the current WIP tale\r\n      resetWIPTale()\r\n    }\r\n  }\r\n\r\n  const showLogoutConfirmModal = e => {\r\n    setIsLogoutModalOpen(true)\r\n  }\r\n\r\n  const logOut = e => {\r\n    try{\r\n      clearSession() // delete jwtToken\r\n      resetUser()   // reset the user\r\n      resetFetchedTales()  // delete previously fetched tales\r\n      purgePersistedData()\r\n      history.push('/')\r\n      window.notify(\"You are successfully signed out.\")\r\n    }\r\n    catch(err) {\r\n      window.notify(\"Some error occured while trying to sign out.\")\r\n    }\r\n  }\r\n\r\n  const sideList = side => (\r\n    <div\r\n      className={classes.list}\r\n      role=\"presentation\"\r\n      onClick={props.closeSidebar}\r\n      onKeyDown={props.closeSidebar}\r\n    >\r\n      <List>\r\n        {navs.map((nav, index) => (\r\n          <Link key={nav.name} to={nav.url} className=\"anchor-default-none\" onClick={e => beforeYouGo(e, nav.url)}>\r\n            <ListItem button className={classes.listItem}>\r\n                <i className={nav.iconClass}></i>\r\n                <ListItemText primary={nav.name} />\r\n            </ListItem>\r\n          </Link>\r\n        ))}\r\n        {!user.email && <ListItem button className={classes.listItem} onClick={openLoginModal}>\r\n         <i className=\"fas fa-sign-in-alt ico\"></i>\r\n          <ListItemText primary=\"Login\" />\r\n        </ListItem>}\r\n\r\n        {user.email && <ListItem button className={classes.listItem} onClick={showLogoutConfirmModal}>\r\n          <ListItemIcon className={classes.icoInList}>\r\n            {/* <nav.icon color=\"primary\" className={classes.ico} /> */}\r\n            <i className=\"fas fa-sign-in-alt ico\"></i>\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Logout\" />\r\n        </ListItem>}\r\n\r\n      </List>\r\n    </div>\r\n  )\r\n\r\n  return (\r\n    <div>\r\n      <Drawer open={props.isSidebarOpen} onClose={props.closeSidebar}>\r\n        {sideList('left')}\r\n      </Drawer>\r\n      <LogOutModal \r\n        isOpen={isLogoutModalOpen} \r\n        handleClose={() => setIsLogoutModalOpen(false)}\r\n        logOut={logOut}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  isSidebarOpen: state.ui.isSidebarOpen,\r\n  user: state.user\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  closeSidebar: () => dispatch({ type: UI_SIDEBAR_CLOSE }),\r\n  openLoginModal: () => dispatch({type: UI_LOGIN_MODAL_OPEN}),\r\n  resetWIPTale: () => dispatch(actionSaveTaleAndReset()),\r\n  resetUser: () => dispatch({ type: USER_RESET }),\r\n  resetFetchedTales: () => dispatch({ type: ONLINE_DATA_CLEAR_TALES })\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Sidebard)\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles, Typography, Box, Grid } from '@material-ui/core'\r\nimport FacebookIcon from '@material-ui/icons/Facebook';\r\nimport TwitterIcon from '@material-ui/icons/Twitter';\r\nimport EmailIcon from '@material-ui/icons/Email';\r\nimport AndroidIcon from '@material-ui/icons/Android';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        backgroundColor: theme.palette.primary.dark,\r\n        color: '#fff',\r\n        padding: `${theme.spacing(5)}px ${theme.spacing(4)}px`\r\n    },\r\n    links: {\r\n        '& a': {\r\n            textDecoration: 'none',\r\n            color: '#fff !important'\r\n        }\r\n    },\r\n    iconLinks: {\r\n        display: 'flex',\r\n        '& svg': {\r\n            fontSize: 27,\r\n            marginRight: theme.spacing(1)\r\n        }\r\n    }\r\n}))\r\n\r\nconst Footer = props => {\r\n    const classes = useStyles()\r\n    return (\r\n        <Box className={classes.root}>\r\n            <Grid container spacing={3}>\r\n                <Grid item xs={12} md={8}>\r\n                    <p className=\"mt-0\">\r\n                        Reactale is what happens when literature embraces technology and comes to life. When a reader reads a Reactale (a.k.a Reactive Tale), the Reactale also reads back its reader and then reacts by magically altering itself depending on the reader's actions / decisions / sorroundings and other learnings that are made available to it about its reader.\r\n                    </p>\r\n                    <p>\r\n                        REACTALE marks the birth of a NEW ERA of story telling, in search of a new way, a very REACTIVE one, where no longer will an immersive tale ONLY ENGAGE its readers, but it will INTERACT, and most importantly, it will REACT...\r\n                    </p>\r\n                </Grid>\r\n                <Grid item xs={12} md={4}>\r\n                    <Box>\r\n                        <Typography variant=\"h5\" gutterBottom>\r\n                            Connect\r\n                        </Typography>\r\n                        <ul className={clsx(classes.links, classes.iconLinks)}>\r\n                            <li><a href=\"https://www.facebook.com/reactale\"><FacebookIcon /></a></li>\r\n                            <li><a href=\"https://twitter.com/ReactiveTales\"><TwitterIcon /></a></li>\r\n                            <li><a href=\"mailto:hello@reactale.com\"><EmailIcon /></a></li>\r\n                            <li title=\"Android app coming soon\"><a><AndroidIcon /></a></li>\r\n                        </ul>\r\n                    </Box>\r\n                    <Box mt={2}>\r\n                        <Typography variant=\"h5\" gutterBottom>\r\n                            Links\r\n                        </Typography>\r\n                        <ul className={classes.links}>\r\n                            <li>\r\n                                <a href=\"https://reacto.reactale.com/\">Reacto</a>\r\n                            </li>\r\n                            <li>\r\n                                <a href=\"https://reactale.com/rtale/privacy-policy\">Privacy Policy</a>\r\n                            </li>\r\n                            <li>\r\n                                <a href=\"https://reactale.com/rtale/terms-and-conditions\">Terms and Conditions</a>\r\n                            </li>\r\n                        </ul>\r\n                    </Box>\r\n                </Grid>\r\n            </Grid>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default Footer","import React from 'react'\r\n\r\nconst Wrapper = props => {\r\n    const { children } = props\r\n    \r\n    \r\n    return (\r\n        // <ReusableContext.Provider value={reusbales}>\r\n        <div>\r\n            {children}\r\n        </div>\r\n            \r\n        // </ReusableContext.Provider>\r\n    )\r\n}\r\nexport default Wrapper","import { ALLTALES } from '../utils/urls'\r\nimport { ajaxGet } from '../utils/ajax'\r\nconst notify = window.notify;\r\n\r\nlet talesForHome = []\r\n\r\nexport const getTalesForHome = async () => {\r\n    if (talesForHome.length > 0) return talesForHome\r\n\r\n    try {\r\n        const res = await ajaxGet(ALLTALES)\r\n        const { status, tales, msg } = res.data\r\n        if(status === 200) {\r\n            talesForHome = tales\r\n        }\r\n        else {\r\n            notify(msg)\r\n        }\r\n    }\r\n    catch (err) { \r\n        // console.log(err) \r\n    }\r\n    finally {\r\n        return talesForHome\r\n    }\r\n    \r\n}","import React from 'react'\r\nimport { makeStyles, Card } from '@material-ui/core'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    padding: '8px 16px',\r\n    height: '100%',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    maxWidth: 500,\r\n    margin: '10px auto',\r\n    borderTop: `5px solid ${theme.palette.primary.main}`,\r\n    '& .fillmid': {\r\n        flexGrow: 1,\r\n        marginBottom: 10\r\n    }\r\n  }\r\n}));\r\n\r\nconst InfoCard = props => {\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <Card className={classes.root}>\r\n        {props.children}\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default InfoCard\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles, Card, CardHeader, CardMedia, CardContent, CardActions,\r\n  Avatar, IconButton, Typography } from '@material-ui/core'\r\nimport { red } from '@material-ui/core/colors';\r\nimport FavoriteIcon from '@material-ui/icons/Favorite';\r\nimport ShareIcon from '@material-ui/icons/Share';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport EditIcon from '@material-ui/icons/Edit'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\nimport { config } from '../../../utils/urls'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  card: {\r\n    maxWidth: 255,\r\n    minWidth: 245,\r\n    margin: \"0 auto\"\r\n  },\r\n  media: {\r\n    height: 0,\r\n    paddingTop: '56.25%', // 16:9\r\n  },\r\n  desc: {\r\n    height: 95,\r\n    overflow: 'hidden'\r\n  },\r\n  expand: {\r\n    transform: 'rotate(0deg)',\r\n    marginLeft: 'auto',\r\n    transition: theme.transitions.create('transform', {\r\n      duration: theme.transitions.duration.shortest,\r\n    }),\r\n  },\r\n  expandOpen: {\r\n    transform: 'rotate(180deg)',\r\n  },\r\n  avatar: {\r\n    backgroundColor: red[500],\r\n  },\r\n  btnLeft: {\r\n    justifyContent: 'flex-start',\r\n    flexGrow: 1,\r\n    '& svg': {\r\n      color: theme.palette.primary.dark\r\n    }\r\n  }\r\n}));\r\n\r\nconst ComplexCard = props => {\r\n  const classes = useStyles()\r\n  const { info, expandable, handleEdit, handleDelete, handleReadTale, pageID } = props\r\n  const [expanded, setExpanded] = React.useState(false);\r\n\r\n  const handleExpandClick = () => {\r\n    setExpanded(!expanded);\r\n  };\r\n\r\n  return (\r\n    <Card className={classes.card}>\r\n      <CardHeader\r\n        avatar={\r\n          <Avatar aria-label=\"recipe\" className={classes.avatar}>\r\n            S\r\n          </Avatar>\r\n        }\r\n        // action={\r\n        //   <IconButton aria-label=\"settings\">\r\n        //     <MoreVertIcon />\r\n        //   </IconButton>\r\n        // }\r\n        title={info.name}\r\n        subheader={\r\n          <span>\r\n            <span>\r\n              {info.genre}\r\n            </span>\r\n            {\r\n              info.authorDisplayName && <span>{' | ' + info.authorDisplayName}</span>\r\n            }\r\n          </span>\r\n        }\r\n      />\r\n      <CardMedia\r\n        className={classes.media}\r\n        onClick={handleReadTale}\r\n        image={info.imgUrl ? `/ups/banners/${info.imgUrl}`: config.defaultImg}\r\n        title=\"Story Image\"\r\n      />\r\n      <CardContent>\r\n        <Typography variant=\"body2\" className={classes.desc} color=\"textSecondary\" component=\"p\">\r\n          {info.description}\r\n        </Typography>\r\n      </CardContent>\r\n      <CardActions disableSpacing>\r\n        <div className={classes.btnLeft}>\r\n          {pageID !== 'HOME' &&\r\n          <IconButton \r\n            aria-label=\"delete\"\r\n            onClick={handleDelete}\r\n          >\r\n            <DeleteIcon />\r\n          </IconButton>}\r\n        </div>\r\n        <IconButton aria-label=\"add to favorites\">\r\n          <FavoriteIcon />\r\n        </IconButton>\r\n        {/* <IconButton aria-label=\"share\">\r\n          <ShareIcon />\r\n        </IconButton> */}\r\n        {pageID !== 'HOME' &&\r\n         <IconButton aria-label=\"edit\" onClick={handleEdit} >\r\n          <EditIcon />\r\n        </IconButton>}\r\n\r\n        {expandable && \r\n            <IconButton\r\n                className={clsx(classes.expand, {\r\n                    [classes.expandOpen]: expanded,\r\n                })}\r\n                onClick={handleExpandClick}\r\n                aria-expanded={expanded}\r\n                aria-label=\"show more\"\r\n            >\r\n                <ExpandMoreIcon />\r\n            </IconButton>\r\n        }\r\n      </CardActions>\r\n      {/* <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n        <CardContent>\r\n          <Typography paragraph>Method:</Typography>\r\n          <Typography paragraph>\r\n            Heat 1/2 cup of the broth in a pot until simmering, add saffron and set aside for 10\r\n            minutes.\r\n          </Typography>\r\n          <Typography paragraph>\r\n            Heat oil in a (14- to 16-inch) paella pan or a large, deep skillet over medium-high\r\n            heat. Add chicken, shrimp and chorizo, and cook, stirring occasionally until lightly\r\n            browned, 6 to 8 minutes. Transfer shrimp to a large plate and set aside, leaving chicken\r\n            and chorizo in the pan. Add pimentn, bay leaves, garlic, tomatoes, onion, salt and\r\n            pepper, and cook, stirring often until thickened and fragrant, about 10 minutes. Add\r\n            saffron broth and remaining 4 1/2 cups chicken broth; bring to a boil.\r\n          </Typography>\r\n          <Typography paragraph>\r\n            Add rice and stir very gently to distribute. Top with artichokes and peppers, and cook\r\n            without stirring, until most of the liquid is absorbed, 15 to 18 minutes. Reduce heat to\r\n            medium-low, add reserved shrimp and mussels, tucking them down into the rice, and cook\r\n            again without stirring, until mussels have opened and rice is just tender, 5 to 7\r\n            minutes more. (Discard any mussels that dont open.)\r\n          </Typography>\r\n          <Typography>\r\n            Set aside off of the heat to let rest for 10 minutes, and then serve.\r\n          </Typography>\r\n        </CardContent>\r\n      </Collapse> */}\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default ComplexCard\r\n","import React, { Dispatch, useEffect, useState } from 'react'\r\nimport { Box } from '@material-ui/core'\r\nimport { connect } from 'react-redux'\r\nimport { config } from '../../../utils/urls'\r\nimport { getTalesForHome } from '../../../services/home.service'\r\nimport { ComplexCard } from '../../common/cards'\r\nimport { UI_LOGIN_MODAL_OPEN } from '../../../redux/actionTypes'\r\nimport { TReactale, TGroupRtlByGenre, TUser, TWindow } from '../../../types'\r\nimport { RouteComponentProps } from 'react-router-dom'\r\nimport { CONST_TITLE } from '../../../utils/constants'\r\n\r\nconst { showLoader, hideLoader }  = window as TWindow\r\n\r\ntype HomeProps = RouteComponentProps & {\r\n    openLoginModal: Function;\r\n    user: TUser\r\n}\r\n\r\nconst Home: React.FC<HomeProps> = (props: HomeProps) => {\r\n    // const [tales, setTales] = useState([])\r\n    const [groups, setGroups] = useState({} as TGroupRtlByGenre)\r\n    const { history, location, openLoginModal, user } = props\r\n\r\n    // Update the Page Title    \r\n    useEffect(() => {\r\n        document.title = 'Home | ' + CONST_TITLE\r\n    }, [])\r\n    \r\n    useEffect(() => {\r\n        showLoader()\r\n        getTalesForHome()\r\n        .then((tales: Array<TReactale>) => {\r\n            // Let's group tales by genre\r\n            let groupByGenre = tales.reduce((acc: TGroupRtlByGenre, t: TReactale) => {\r\n                acc[t.info.genre] = acc[t.info.genre] || []\r\n                acc[t.info.genre].push(t)\r\n                return acc\r\n            }, {})\r\n            setGroups(groupByGenre)\r\n        })\r\n        .catch(err => console.log(err))\r\n        .finally(() => hideLoader())\r\n\r\n        // See if Login Modal needs to be opened ...\r\n        const params = new URLSearchParams(location.search); \r\n        const openLogin = params.get('openLogin')\r\n\r\n        if(openLogin === 'true') {\r\n            console.log('show login modal')\r\n            const newSearchString = location.search.replace('openLogin=true', '')\r\n            history.push(`${location.pathname}${newSearchString}`)\r\n            setTimeout(() => {\r\n                // Open autoLoginModal only if user not signed in already\r\n                if(!user || !user.email) openLoginModal()\r\n            }, 300)\r\n        }\r\n    }, [history, location, openLoginModal, user])\r\n    \r\n\r\n    const goToTale = (storyUrl: string) => {\r\n        // if it an App, go to preview url i.e. SPA way\r\n        if(config.appType === 'APP') {\r\n            history.push(`/preview/${storyUrl}`)\r\n        }\r\n        // else go to NODE View\r\n        else {\r\n            let url = window.location.origin + '/read/' + storyUrl\r\n            // let url = getRoot() + '/read/' + storyUrl\r\n            window.location.href = url\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Box pb={5} className=\"home-page\">\r\n            {\r\n                Object.keys(groups).length <= 0 &&\r\n                <h2 className=\"mt-25\">\r\n                    Oops! looks like an issue. We could not fetch any tales at the moment. :(\r\n                </h2>\r\n            }\r\n            <Box>\r\n            {\r\n                Object.keys(groups).map((g,i) => \r\n                <Box key={g} mt={i===0 ? 0 : 4}>\r\n                    <h1 className=\"category mb-5\">\r\n                        <span className=\"name\">{g}</span>\r\n                    </h1>\r\n                    <div className=\"talecards-holder\">\r\n                    {\r\n                        groups[g].map(t => \r\n                        <Box key={t.info.storyUrl} mr={2}>\r\n                            <ComplexCard\r\n                                // id={t.storyUrl}\r\n                                info={t.info} \r\n                                expandable={false} \r\n                                pageID='HOME'\r\n                                handleReadTale={() => goToTale(t.info.storyUrl)}\r\n                                // handleEdit={goToEditTale}\r\n                                // handleDelete={deleteTale}  \r\n                            />\r\n                        </Box>)\r\n                    }\r\n                    </div>\r\n                </Box>)\r\n            }\r\n            </Box>\r\n        </Box>\r\n    )\r\n}\r\nconst mapStateToProps = (state: { user: TUser }) => ({\r\n    user: state.user\r\n})\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>)  => ({\r\n    openLoginModal: () => dispatch({type: UI_LOGIN_MODAL_OPEN})\r\n  })\r\n  \r\nexport default connect(mapStateToProps, mapDispatchToProps)(Home)","const allReactos =\r\n[\r\n    {\r\n        \"token\": \"((r.dt.year))\",\r\n        \"desc\": \"Shows current year e.g. 2019, 2022 etc\",\r\n        \"test\": \"Current year is ((r.dt.year))\"\r\n    },\r\n    {\r\n        \"token\": \"((r.dt.month))\",\r\n        \"desc\": \"Shows current month e.g. February, November etc\",\r\n        \"test\": \"Current month is ((r.dt.month))\"\r\n    },\r\n    {\r\n        \"token\": \"((r.dt.day))\",\r\n        \"desc\": \"Shows current day e.g. Sunday, Friday etc\",\r\n        \"test\": \"Today is ((r.dt.day))\"\r\n    },\r\n    {\r\n        \"token\": \"((r.dt.date))\",\r\n        \"desc\": \"Shows today's date e.g. 9, 21 etc\",\r\n        \"test\": \"Today is ((r.dt.date))th day of ((r.dt.month))\"\r\n    },\r\n    {\r\n        \"token\": \"((r.dt.hour))\",\r\n        \"desc\": \"Shows current hour in 12 hours format e.g. 7, 11 etc\",\r\n        \"test\": \"Current time is ((r.dt.hour)):((r.dt.min)):((r.dt.sec))\"\r\n    },\r\n    {\r\n        \"token\": \"((r.dt.hour24))\",\r\n        \"desc\": \"Shows current hour in 24 hours format e.g. 19, 22 etc\",\r\n        \"test\": \"Current time in 24 hour format is ((r.dt.hour24)):((r.dt.min)):((r.dt.sec))\"\r\n    },\r\n    {\r\n        \"token\": \"((r.dt.min))\",\r\n        \"desc\": \"Shows current min e.g. 32, 55 etc\",\r\n        \"test\": \"It is currently ((r.dt.min)) minutes past ((r.dt.hour))\"\r\n    },\r\n    {\r\n        \"token\": \"((r.dt.sec))\",\r\n        \"desc\": \"Shows current sec e.g. 3, 19 etc\",\r\n        \"test\": \"Current time is ((r.dt.hour):((r.dt.min):((r.dt.sec))\"\r\n    },\r\n    {\r\n        \"token\": \"((r.cfg.langSwitch.L))\",\r\n        \"desc\": \"Changes the Reactos language. L=en, beng or any language code, e.g ((r.cfg.langSwitch.beng)) for Bengali etc\",\r\n        \"test\": `In Bengali today is ((r.cfg.langSwitch.beng))((r.dt.day))\r\n        in English today is ((r.cfg.langSwitch.en))((r.dt.day))`\r\n    },\r\n    {\t\r\n        \"token\": \"((r.var.k1=v1))\",\r\n        \"desc\": \"To set any custom variable (e.g reader's name / hobby / choice-selection etc) to be used later\",\r\n        \"test\": `Set the variables and then Get the variables. \r\n        ((r.var.name=Barry Allen))((r.var.superheroName=The Flash))((r.var.tagLine=The Fastest man alive)) \r\n        \r\n        Hello ((r.var.name)), I know you are ((r.var.tagLine))! \r\n        You are ((r.var.superheroName))...`\r\n    },\r\n    {\t\r\n        \"token\": \"((r.var.name1))\",\r\n        \"desc\": \"To get any previously SET value\",\r\n        \"test\": `Set the variables and then Get the variables. \r\n        ((r.var.name=Tony Stark))((r.var.superheroName=Iron Man))((r.var.tagLine=genius billionaire playboy philanthropist)) \r\n        \r\n        Hello ((r.var.name)), I know you are a ((r.var.tagLine))! You are ((r.var.superheroName))...`\r\n    },\r\n    {\t\r\n        \"token\": \"((r.if. n1 = n2))\",\r\n        \"desc\": \"n1, n2 can be numbers or reactos. Equality operator can be anyone of =, !=, >, !>, <, !<. If the condition is true then the following reacto or body text inside double curly braces i.e. {{ ... }} will be executed, else not\",\r\n        \"test\":               \r\n        `   ((r.if. 5 > 9)) {{ This line should not be shown }}\r\n            ((r.if. 9 < r.dt.year ))\r\n            {{ Yes, ((r.dt.year)) is always Greater than 9. ((r.var.secret_message = Reacto is Awesome )) }}\r\n            ((r.if. 2 = 2)) \r\n            {{ Number comparison successful }}\r\n            ((r.if. r.var.secret_message = Reacto is Awesome)) \r\n            {{ Text comparison successful }}\r\n        `\r\n    },\r\n    {\t\r\n        \"token\": \"((r.calc. n1 + n2))\",\r\n        \"desc\": \"n1, n2 can be numbers or reactos. Maths operator can be anyone of the basic four, i.e. + , - , * and / \",\r\n        \"test\":               \r\n        `   4 + 5 = ((r.calc. 4 + 5))\r\n            5 - 3 = ((r.calc. 5 - 3))\r\n            3 * 2 = ((r.calc. 3 * 2))\r\n            20 / 5 = ((r.calc. 20 / 5))\r\n        `\r\n    }\r\n]\r\n\r\nexport default allReactos","import React, { useState, useEffect, createRef } from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles, Box, Button } from '@material-ui/core'\r\nimport allReactos from './reactosDef'\r\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\r\nimport DoubleArrowIcon from '@material-ui/icons/DoubleArrow';\r\nconst notify = window['notify']\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        position: 'relative'\r\n    },\r\n    cats: {\r\n        border: `1px solid ${theme.palette.primary.main}`,\r\n        display: 'inline-block',\r\n        fontSize: 15,\r\n        margin: 3,\r\n        padding: '5px 10px',\r\n        borderRadius: 2,\r\n        lineHeight: '15px',\r\n        cursor: 'default',\r\n        // color: '#fff',\r\n        // background: '#fff',\r\n        '&.selected': {\r\n            background: theme.palette.primary.main,\r\n            color: '#fff'\r\n        }\r\n    },\r\n    indieReacto: {\r\n        boxShadow: '0px 1px 3px 1px #a9a9a9',\r\n        padding: 15,\r\n        margin: '20px 0',\r\n        '& .desc': {\r\n            color: 'rgba(0, 0, 0, .6)'\r\n        },\r\n        '& .reacto': {\r\n            fontSize: 16,\r\n            fontWeight: 700,\r\n            fontFamily: '\"Courier New\", Courier, monospace',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            '& .token': {\r\n                // color: theme.palette.primary.main,\r\n                color: 'rgba(0, 0, 0, .8)',\r\n                marginRight: 5\r\n            }\r\n        }\r\n    },\r\n    invisible: {\r\n        position: 'absolute',\r\n        left: -1000\r\n    }\r\n}))\r\n\r\nconst TabViewReactos = props => {\r\n    const classes = useStyles()\r\n    const { tryOut } = props\r\n    const [catList, setCatList] = useState([])\r\n    const [rtoCatWise, setRtoCatWise] = useState({})\r\n    const [activeCat, setActiveCat] = useState('All')\r\n\r\n    const inputRef = createRef() \r\n    \r\n    useEffect(() => {\r\n        let catList = ['All']\r\n        let reactoCategoryWise = { 'All': [] }\r\n\r\n        for (let r of allReactos) {\r\n            let cat = r.token.substr(4)\r\n            cat = cat.substring(0, cat.indexOf('.'))\r\n            if (catList.indexOf(cat) < 0) catList.push(cat)\r\n\r\n            //add reacto to categoryWise storage\r\n            reactoCategoryWise[cat] = reactoCategoryWise[cat] || []\r\n            reactoCategoryWise[cat].push(r)\r\n\r\n            //all will have a ref to all of those reactos\r\n            reactoCategoryWise['All'].push(r)\r\n        }\r\n\r\n        setCatList(catList)\r\n        setRtoCatWise(reactoCategoryWise)\r\n    }, [])\r\n\r\n    const copyReacto = rto => {\r\n        console.log(rto)\r\n        console.log(inputRef)\r\n        inputRef.current.value = rto\r\n        inputRef.current.select()\r\n        inputRef.current.setSelectionRange(0, 99999)\r\n        document.execCommand(\"copy\")\r\n\r\n        notify('Reacto copied to clipboard')\r\n\r\n    }\r\n\r\n    return (\r\n        <Box px={1} className={classes.root}>\r\n            <input type=\"text\" ref={inputRef} className={classes.invisible} />\r\n\r\n            <Box mt={2}>\r\n            {\r\n                catList.length > 0 && catList.map(c =>\r\n                    <span key={c}\r\n                        onClick={() => setActiveCat(c)}\r\n                        className={clsx(classes.cats, (activeCat === c) && 'selected')}\r\n                    >\r\n                        {c}\r\n                    </span>\r\n                )\r\n            }\r\n            </Box>\r\n\r\n            <p>Showing \"{`${activeCat}`}\" Reactos</p>\r\n\r\n            <Box>\r\n                {\r\n                    rtoCatWise[activeCat] && rtoCatWise[activeCat].map(r =>\r\n                        <div className={classes.indieReacto} key={r.token}>\r\n                            <div className=\"reacto\">\r\n                                <span className=\"token\">{r.token}</span>\r\n                            </div>\r\n                            <hr />\r\n                            <div className=\"desc\">{r.desc}</div>\r\n                            <div className=\"text-right mt-15\">\r\n                                <Button\r\n                                    variant=\"outlined\"\r\n                                    color=\"primary\"\r\n                                    size=\"small\"\r\n                                    onClick={()=>copyReacto(r.token)}\r\n                                    startIcon={<FileCopyIcon />}\r\n                                >\r\n                                    Copy \r\n                                </Button>\r\n                                <Button\r\n                                    variant=\"outlined\"\r\n                                    color=\"primary\"\r\n                                    size=\"small\"\r\n                                    className=\"ml-5\"\r\n                                    onClick={() => tryOut(r.test.replace(/ +/g, ' '))}\r\n                                    endIcon={<DoubleArrowIcon />}\r\n                                >\r\n                                    Try \r\n                                </Button>\r\n                            </div>\r\n                            \r\n                        </div>\r\n                    )\r\n                }\r\n            </Box>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default TabViewReactos","import React, { useState, useEffect } from 'react'\r\nimport { makeStyles, Box, TextField, Button, Grid } from '@material-ui/core'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    textField: {\r\n        fontFamily: '\"Courier New\", Courier, monospace',\r\n    },\r\n    interpretedTxt: {\r\n        whiteSpace: 'pre-wrap'\r\n    }\r\n}))\r\n\r\nconst TabTryReactos = props => {\r\n    const classes = useStyles()\r\n    const { rTxt } = props\r\n    const [reactiveTxt, setReactiveTxt] = useState('')\r\n    const [interpretedTxt, setInterpretedTxt] = useState('')\r\n\r\n    useEffect(() => {\r\n        setReactiveTxt(rTxt)\r\n    }, [rTxt])\r\n\r\n    const interpretReacto = () => {\r\n        setInterpretedTxt(window.rto.process(reactiveTxt))\r\n    }\r\n\r\n    return (\r\n        <Box>\r\n            <p>Paste any text containing reactos and click \"Interpret\"</p>\r\n\r\n            <Box>\r\n                <TextField\r\n                    label=\"Reactive Text\"\r\n                    multiline\r\n                    rows=\"6\"\r\n                    variant=\"outlined\"\r\n                    fullWidth\r\n                    className={classes.textField}\r\n                    value={reactiveTxt}\r\n                    onChange={e => setReactiveTxt(e.target.value)}\r\n                />\r\n\r\n                <Grid container spacing={1}>\r\n                    <Grid item xs>\r\n                        <Button \r\n                            variant=\"contained\" \r\n                            color=\"primary\"\r\n                            className=\"mt-15\"\r\n                            fullWidth\r\n                            size=\"small\"\r\n                            onClick={() => {setReactiveTxt(''); setInterpretedTxt('')} }\r\n                        >\r\n                            Clear\r\n                        </Button>\r\n                    </Grid>\r\n                    <Grid item xs>\r\n                        <Button \r\n                            variant=\"contained\" \r\n                            color=\"primary\"\r\n                            className=\"mt-15\"\r\n                            fullWidth\r\n                            size=\"small\"\r\n                            onClick={interpretReacto}\r\n                        >\r\n                            Convert\r\n                        </Button>\r\n                    </Grid>\r\n                </Grid>\r\n\r\n                <Box py={3}>\r\n                    { interpretedTxt && \r\n                    <div><b><u>Interpreted Text</u></b></div>}\r\n                    <div className={classes.interpretedTxt}>{interpretedTxt || 'Converted text will appear here ...'}</div>\r\n                </Box>\r\n            </Box>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default TabTryReactos","import React from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport DoubleArrowIcon from '@material-ui/icons/DoubleArrow'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        position: 'relative',\r\n        padding: '5px 5px 5px 18px'\r\n    },\r\n    ico: {\r\n        position: 'absolute',\r\n        left: -2,\r\n        top: 7,\r\n        color: theme.palette.primary.main,\r\n        fontSize: 16\r\n    }\r\n}))\r\n\r\nconst Li = props => {\r\n    const classes = useStyles()\r\n    const { text, children } = props\r\n    return (\r\n        <li className={classes.root}>\r\n            <DoubleArrowIcon className={classes.ico}/>\r\n            {text || children}\r\n        </li>\r\n    )\r\n}\r\n\r\nexport default Li","import React, { useState } from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles, Box } from '@material-ui/core'\r\nimport Up from '@material-ui/icons/ExpandLess'\r\nimport Down from '@material-ui/icons/ExpandMore'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    title: {\r\n        background: theme.palette.primary.main,\r\n        color: '#fff',\r\n        padding: '5px 10px',\r\n        position: 'relative',\r\n        '& .ocico': {\r\n            position: 'absolute',\r\n            right: 15,\r\n            top: 4\r\n        }\r\n    },\r\n    body: {\r\n        border: `5px double ${theme.palette.primary.main}`,\r\n        borderTop: \"none\",\r\n        borderRadius: 4,\r\n        borderTopLeftRadius: 0,\r\n        borderTopRightRadius: 0,\r\n        padding: 15\r\n    }\r\n}))\r\n\r\nconst Accordion = props => {\r\n    const classes = useStyles()\r\n    const { isOpen, title, children, className } = props\r\n    const [open, setOpen] = useState(!!isOpen)\r\n\r\n    return (\r\n        <Box className={className}>\r\n            <div className={classes.title} onClick={() => setOpen(!open)}>\r\n                <span className=\"ocico\">\r\n                    { open && <Up /> }\r\n                    { !open && <Down /> }\r\n                </span>\r\n                {title}\r\n            </div>\r\n            <div className={clsx(classes.body, !open && 'hidden')}>\r\n                {children}\r\n            </div>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default Accordion","import React, { useState } from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles, Box, TextField, Button, Grid, Checkbox } from '@material-ui/core'\r\nimport { Accordion } from '../misc'\r\nimport { connect } from 'react-redux'\r\nimport { TALE_UPDATE_REACTO_VARS } from '../../../redux/actionTypes'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nconst notify = window['notify']\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    liOfRVars: {\r\n        borderBottom: `1px dotted ${theme.palette.primary.main}`,\r\n        padding: '5px 10px',\r\n        overflow: 'hidden',\r\n        textOverflow: 'ellipsis',\r\n        paddingRight: 60,\r\n        fontFamily: '\"Courier New\", Courier, monospace',\r\n    }\r\n}))\r\n\r\nconst TabCreateReactos = props => {\r\n    const classes = useStyles()\r\n    const { rVars, updateReactoVars } = props\r\n    const initRVar = { name: '', val: '', userCustomizable: false, helptext: '' }\r\n    const [newRVar, setNewRVar] = useState({ ...initRVar })\r\n    // const [rVars, setRVars] = useState({})  // kv pair of all reacto-vars\r\n\r\n\r\n    const handleChangeNewRVar = e => {\r\n        let k = e.target.name\r\n        let v = e.target.value\r\n\r\n        if (k === 'name' && !(/^[A-Za-z0-9]{0,}$/g.test(v))) {\r\n            return\r\n        }\r\n        setNewRVar({\r\n            ...newRVar,\r\n            [k]: v\r\n        })\r\n    }\r\n\r\n    const setCustomizable = e => {\r\n        setNewRVar({\r\n            ...newRVar,\r\n            userCustomizable: e.target.checked\r\n        })\r\n    }\r\n\r\n    const AddRVar = () => {\r\n        if (!newRVar.name || !newRVar.val) {\r\n            notify('Please fill both variable-name and variable-value fields')\r\n            return\r\n        }\r\n        // setRVars({\r\n        //     ...rVars,\r\n        //     [newRVar.name]: newRVar.val\r\n        // })\r\n        updateReactoVars({\r\n            ...rVars,\r\n            [newRVar.name]: newRVar\r\n        })\r\n\r\n        setNewRVar({ ...initRVar })\r\n        notify(`Reacto variable ${newRVar.name} added successfully ...`)\r\n    }\r\n    return (\r\n        <Box>\r\n            <p>\r\n                Let's create some user customizable (or may be not!) reactos ...\r\n            </p>\r\n\r\n            <Box>\r\n                <Accordion title=\"Create Reactos\">\r\n                    <div>Add a Reacto Variable</div>\r\n                    <TextField\r\n                        label=\"Name of the Variable\"\r\n                        variant=\"outlined\"\r\n                        name=\"name\"\r\n                        fullWidth\r\n                        required\r\n                        size=\"small\"\r\n                        helperText=\"Use only alphabets and numbers, no space\"\r\n                        className=\"mt-25\"\r\n                        value={newRVar.name}\r\n                        onChange={handleChangeNewRVar}\r\n                    />\r\n\r\n                    <TextField\r\n                        label=\"Value of the Variable\"\r\n                        multiline\r\n                        name=\"val\"\r\n                        rows=\"6\"\r\n                        variant=\"outlined\"\r\n                        helperText=\"Incase of customizable reacto this will be used as default/fallback value\"\r\n                        required\r\n                        fullWidth\r\n                        className=\"mt-25\"\r\n                        value={newRVar.val}\r\n                        onChange={handleChangeNewRVar}\r\n                    />\r\n\r\n                    <FormControlLabel\r\n                        control={\r\n                            <Checkbox \r\n                                checked={newRVar.userCustomizable} \r\n                                onChange={setCustomizable} \r\n                                name=\"userCustomizable\" \r\n                            />\r\n                        }\r\n                        label=\"Reader customizable\"\r\n                    />\r\n\r\n                    <TextField\r\n                        label=\"Hint for reader\"\r\n                        multiline\r\n                        name=\"helptext\"\r\n                        rows=\"2\"\r\n                        variant=\"outlined\"\r\n                        required\r\n                        fullWidth\r\n                        helperText=\"Give some hint to the reader, e.g. Enter a name for the main character\"\r\n                        className={clsx('mt-25', !newRVar.userCustomizable && 'hidden')}\r\n                        value={newRVar.helptext}\r\n                        onChange={handleChangeNewRVar}\r\n                    />\r\n\r\n                    <Grid container spacing={1}>\r\n                        <Grid item xs>\r\n                            <Button\r\n                                variant=\"outlined\"\r\n                                color=\"primary\"\r\n                                className=\"mt-15\"\r\n                                fullWidth\r\n                                size=\"small\"\r\n                                onClick={() => setNewRVar({ ...initRVar })}\r\n                            >\r\n                                Reset\r\n                            </Button>\r\n                        </Grid>\r\n                        <Grid item xs>\r\n                            <Button\r\n                                variant=\"outlined\"\r\n                                color=\"primary\"\r\n                                className=\"mt-15\"\r\n                                fullWidth\r\n                                size=\"small\"\r\n                                onClick={AddRVar}\r\n                            >\r\n                                Add\r\n                            </Button>\r\n                        </Grid>\r\n                    </Grid>\r\n                </Accordion>\r\n            </Box>\r\n\r\n            {/* SHOW THE DECLARED VARS */}\r\n            <Box mt={1}>\r\n                <Accordion title=\"View Reactos Variables\">\r\n                    <div>Current reacto variables</div>\r\n                    <ul className=\"mt-15\">\r\n                        {\r\n                            rVars && Object.keys(rVars).map(r =>\r\n                                <li key={r} className={classes.liOfRVars}>\r\n                                    ((r.var.{r}))\r\n                                </li>\r\n                            )\r\n                        }\r\n                    </ul>\r\n                </Accordion>\r\n            </Box>\r\n\r\n        </Box>\r\n    )\r\n}\r\nconst mapStateToProps = state => ({\r\n    rVars: state.wipTale.reactos ? state.wipTale.reactos.vars : {}\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    updateReactoVars: rvars => dispatch({ type: TALE_UPDATE_REACTO_VARS, payload: rvars })\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TabCreateReactos)","import React, { useState } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { makeStyles, Box, Paper, Tab, Tabs } from '@material-ui/core'\r\nimport SimpleModal from '../modal/SimpleModal'\r\nimport { UI_REACTO_MODAL_CLOSE } from '../../../redux/actionTypes'\r\nimport TabViewReactos from './TabViewReactos'\r\nimport TabTryReactos from './TabTryReactos'\r\nimport TabCreateReactos from './TabCreateReactos'\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    modal: {\r\n        maxWidth: 600,\r\n        width: 'calc(100vw - 20px)',\r\n        marginTop: 100\r\n    }\r\n}))\r\n\r\nconst ReactoModal = props => {\r\n    const classes = useStyles()\r\n    const { isOpen, handleClose } = props\r\n    const [visibleTabIndex, setVisibleTab] = useState(0)\r\n    const [rTxt, setRTxt] = useState('')\r\n\r\n    const tryOut = rtxt => {\r\n        setRTxt(rtxt)\r\n        setVisibleTab(1)\r\n    }\r\n\r\n    return (\r\n        <SimpleModal\r\n            title=\"Reactos\"\r\n            {...props}\r\n            isOpen={isOpen} \r\n            handleClose = {handleClose}\r\n            className={classes.modal}\r\n            // preventAutoSize={true}\r\n        >\r\n            <Box>\r\n                <Box px={2} mb={2}>\r\n                    Check out the <a href=\"https://reacto.reactale.com/\" target=\"_blank\" rel=\"noopener noreferrer\">reacto website</a>\r\n                </Box>\r\n                <Paper square>\r\n                    <Tabs\r\n                        value={visibleTabIndex}\r\n                        indicatorColor=\"primary\"\r\n                        textColor=\"primary\"\r\n                        onChange={(e,i) => setVisibleTab(i)}\r\n                        centered\r\n                        aria-label=\"tabs to for View, try, create reactos\"\r\n                    >\r\n                        <Tab label=\"View\" />\r\n                        <Tab label=\"Try\" />\r\n                        <Tab label=\"Customize\" />\r\n                    </Tabs>\r\n                </Paper>\r\n\r\n                {/* View Reactos */}\r\n                <Box className={visibleTabIndex !== 0 ? 'hide' : ''}>\r\n                    <TabViewReactos tryOut={tryOut} />\r\n                </Box>\r\n\r\n                {/* Try Reactos */}\r\n                <Box className={visibleTabIndex !== 1 ? 'hide' : ''}>\r\n                    <TabTryReactos rTxt={rTxt} />\r\n                </Box>\r\n\r\n                {/* Create Reactos */}\r\n                <Box className={visibleTabIndex !== 2 ? 'hide' : ''}>\r\n                    <TabCreateReactos />\r\n                </Box>\r\n            </Box>\r\n        </SimpleModal>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    isOpen: state.ui.isReactoModalOpen\r\n})\r\n\r\nconst mapDispatchTorops = dispatch => ({\r\n    handleClose: () => dispatch({ type: UI_REACTO_MODAL_CLOSE }),\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchTorops)(ReactoModal)","import React from 'react'\r\nimport { Typography, TextField, Box, Button } from '@material-ui/core';\r\nimport SimpleModal from '../../common/modal/SimpleModal'\r\nconst notify = window['notify']\r\n\r\nconst ExportTaleModal = props => {\r\n    const { isOpen, handleClose, expTaleContent } = props\r\n    const textFieldRef = React.createRef()\r\n    \r\n    const clickToCopy = textRef => {\r\n        console.log(textRef)\r\n        const t = textRef.current.getElementsByTagName('input').item(0)\r\n        /* Select the text field */\r\n        t.select()\r\n        t.setSelectionRange(0, 999999999) /*For mobile devices*/\r\n    \r\n        /* Copy the text inside the text field */\r\n        document.execCommand(\"copy\")\r\n    \r\n        /* Alert the copied text */\r\n        setTimeout(()=>{\r\n            notify(\"Text copied to clipboard ...\")\r\n        }, 0)\r\n    }\r\n\r\n    return (\r\n        <SimpleModal \r\n            isOpen={isOpen} \r\n            handleClose = {handleClose}\r\n            title=\"Export Reactale\"\r\n        >\r\n        <Typography variant=\"body1\" gutterBottom>\r\n            Copy this text and paste it in a text file in case file download is not working (e.g. in mobile browsers)\r\n        </Typography>\r\n\r\n        <Box my={3}>\r\n            <TextField \r\n                label=\"Outlined\" \r\n                variant=\"outlined\" \r\n                value={expTaleContent}\r\n                fullWidth\r\n                ref={textFieldRef}\r\n            />\r\n        </Box>\r\n        <Button variant=\"outlined\" color=\"primary\" onClick={() => clickToCopy(textFieldRef)}>\r\n            Copy Reactale Text\r\n        </Button>\r\n        </SimpleModal>\r\n    )\r\n}\r\n\r\nexport default ExportTaleModal","import React, { useState } from 'react'\r\nimport { Typography, TextField, Box, Button } from '@material-ui/core';\r\nimport SimpleModal from '../../common/modal/SimpleModal'\r\nconst LZString = window['LZString']\r\n\r\nconst ImportTaleModal = props => {\r\n    const {isOpen, handleClose, setForEditing} = props\r\n    const [importedTxt, setImportedTxt] = useState('')\r\n    const importTale = () => {\r\n        // const tale = JSON.parse(decodeURIComponent(atob(importedTxt)))\r\n        const tale = JSON.parse(LZString.decompressFromEncodedURIComponent(importedTxt))\r\n        setForEditing(tale)\r\n        setImportedTxt('')\r\n    }\r\n\r\n    const handleFileSelect = e => {\r\n        let file = e.target.files[0]\r\n        console.log(file)\r\n\r\n        let reader = new FileReader();\r\n\r\n        // Closure to capture the file information.\r\n        reader.onload = (function(theFile) {\r\n            return e => setImportedTxt(e.target.result)\r\n        })(file);\r\n\r\n        // Read in the image file as a data URL.\r\n        reader.readAsText(file);\r\n    }\r\n\r\n    return (\r\n        <SimpleModal \r\n            isOpen={isOpen} \r\n            handleClose = {handleClose}\r\n            title=\"Import Reactale\"\r\n        >\r\n            <Typography variant=\"body1\" gutterBottom>\r\n                Import a previously exported Reactale file <b>OR</b> optionally you can paste the text from it if \"file import\" is not working in your browser\r\n            </Typography>\r\n\r\n            <Box mt={2}>\r\n                <form encType=\"multipart/form-data\">\r\n                    <input \r\n                        type=\"file\" \r\n                        accept=\"text/txt\" \r\n                        name=\"files[]\" \r\n                        size=\"30\" \r\n                        onChange={e => handleFileSelect(e)}\r\n                    />\r\n                </form>\r\n            </Box>\r\n\r\n            <Box align=\"center\" my={1}>\r\n                <Typography variant=\"h6\" gutterBottom>\r\n                    <b>OR</b>\r\n                </Typography>\r\n            </Box>\r\n\r\n            <Box>\r\n                <TextField\r\n                    label=\"Paste Content Here\"\r\n                    multiline\r\n                    rows=\"4\"\r\n                    fullWidth\r\n                    variant=\"outlined\"\r\n                    value = {importedTxt}\r\n                    onChange = { e => setImportedTxt(e.target.value)}\r\n                />\r\n            </Box>\r\n            \r\n            <Box mt={2} align=\"right\">\r\n                <Button \r\n                    size=\"small\"\r\n                    variant=\"contained\" \r\n                    color=\"primary\"\r\n                    onClick={importTale}\r\n                >\r\n                    Import\r\n                </Button>\r\n            </Box>\r\n\r\n            \r\n            \r\n        </SimpleModal>\r\n    )\r\n}\r\n\r\nexport default ImportTaleModal","import React, { useState, useEffect } from 'react'\r\n// import Paper from '@material-ui/core/Paper'\r\nimport clsx from 'clsx'\r\nimport { ajaxPost } from '../../../utils/ajax'\r\nimport { InputAdornment, Box, Grid, TextField, Select, Button,\r\n    FormControl, InputLabel, MenuItem, makeStyles } from '@material-ui/core'\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline'\r\nimport { connect } from 'react-redux'\r\nimport { TALE_UPDATE_INFO } from '../../../redux/actionTypes'\r\nimport { actionUpdateImgUrl } from '../../../redux/actionCreators/createTaleActions'\r\nimport { LANGUAGES, GENRES } from '../../../utils/constants'\r\nimport { config, UPLOAD_BANNER } from '../../../utils/urls'\r\n\r\nconst notify = window['notify']\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    imgUploadSec: {\r\n        display: 'flex',\r\n        '& .img-preview': {\r\n            height: 90,\r\n            width: 150,\r\n            border: '1px solid #bbb',\r\n            borderRadius: 4,\r\n            flexGrow: 1,\r\n            marginRight: 9,\r\n            textAlign: 'center',\r\n            overflow: 'hidden',\r\n            padding: 0.5,\r\n            '& img': {\r\n                maxWidth: '100%',\r\n                maxHeight: '100%'\r\n            }\r\n        },\r\n        '& .btns': {\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            justifyContent: 'space-evenly'\r\n        }\r\n    }\r\n}))\r\n\r\nconst updateTaleInfo = (dispatch, key, val, oldInfo) => {\r\n\r\n    // desiredUrl must contain only alpha num and hyphen\r\n    if (key === 'desiredUrl' && !(/^[A-Za-z0-9-]{0,}$/g.test(val)) ) {\r\n        return\r\n    }\r\n    dispatch({\r\n        type: TALE_UPDATE_INFO,\r\n        payload: {\r\n            ...oldInfo,\r\n            [key]: val\r\n        }\r\n    })\r\n}\r\n\r\nconst CreateTaleIntro = props => {\r\n    const classes = useStyles()\r\n    const { info, typingVal, userEmail, updateImgUrl } = props\r\n    const [imgFile, setImgFile] = useState(null)\r\n    const [previewImgUrl, setPreviewImgUrl] = useState(config.defaultImg)\r\n\r\n    useEffect(() => {\r\n        setPreviewImgUrl(info.imgUrl ? `/ups/banners/${info.imgUrl}`: config.defaultImg)\r\n    }, [info])\r\n\r\n    const loadImg = e => {\r\n        // return // FOR NOW, COMMENT OUT LATER\r\n        const fileList = e.target.files;\r\n        console.log(fileList)\r\n\r\n        // Though we are hiding the upload section until 1st save\r\n        if(!info.storyUrl) {\r\n            notify('The tale must be saved online atleast once before uploading banner image')\r\n            return\r\n        }\r\n    \r\n        if(fileList.length > 0) {\r\n            setImgFile(fileList[0])\r\n            setPreviewImgUrl(URL.createObjectURL(fileList[0]))\r\n        }\r\n    }\r\n\r\n    const uploadImg = oldInfo => {\r\n        // notify('Upload Image coming soon ...')\r\n        if(!imgFile) return notify ('Select an image first ...')\r\n\r\n        window.showLoader()\r\n        let formData = new FormData()\r\n        formData.append('storybanner', imgFile)\r\n        formData.append('storyUrl', info.storyUrl)\r\n        formData.append('email', userEmail)\r\n\r\n        ajaxPost(UPLOAD_BANNER, formData)\r\n        .then(res => {\r\n            notify(res.data.msg)\r\n            // if successful, update the local story imgUrl also\r\n            const { newFileName } = res.data\r\n            if(newFileName) {\r\n                // we can intelligently re-use the same function as others\r\n                // to update the redux state\r\n                typingVal('imgUrl', newFileName, oldInfo)\r\n            }\r\n        })\r\n        .catch(err => notify('Some error occurred ...'))\r\n        .finally(() => window.hideLoader())\r\n    }\r\n\r\n    return (\r\n        <Box py={3}>\r\n            <Grid container spacing={2}>\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    <TextField\r\n                        fullWidth\r\n                        variant=\"outlined\"\r\n                        value={info.name}\r\n                        label=\"Name of the Tale\"\r\n                        required\r\n                        onChange={e => typingVal('name', e.target.value, info)}\r\n                        InputProps={info.name.length <= 0 && {\r\n                            endAdornment: <InputAdornment position=\"end\"><ErrorOutlineIcon /></InputAdornment>,\r\n                        }}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel required>\r\n                            Genre\r\n                        </InputLabel>\r\n                        <Select\r\n                            value={info.genre}\r\n                            fullWidth\r\n                            onChange={e => typingVal('genre', e.target.value, info)}\r\n                        >\r\n                            {\r\n                                GENRES.map(g => (\r\n                                    <MenuItem value={g} key={g}>\r\n                                        {g}\r\n                                    </MenuItem>\r\n                                ))\r\n                            }\r\n                        </Select>\r\n                    </FormControl>\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    <TextField\r\n                        fullWidth\r\n                        variant=\"outlined\"\r\n                        value={info.tags}\r\n                        required\r\n                        label=\"Tags\"\r\n                        onChange={e => typingVal('tags', e.target.value, info)}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel required>\r\n                            Language\r\n                        </InputLabel>\r\n                        <Select\r\n                            value={info.lang}\r\n                            required\r\n                            label=\"Language\"\r\n                            fullWidth\r\n                            onChange={e => typingVal('lang', e.target.value, info)}\r\n                        >\r\n                            {\r\n                                LANGUAGES.map(l => (\r\n                                    <MenuItem value={l} key={l}>\r\n                                        {l}\r\n                                    </MenuItem>\r\n                                ))\r\n                            }\r\n                        </Select>\r\n                    </FormControl>\r\n                </Grid>\r\n                \r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    <TextField\r\n                        fullWidth\r\n                        variant=\"outlined\"\r\n                        label=\"Author Display Name\"\r\n                        placeholder=\"Original creator's name\"\r\n                        value={info.authorDisplayName}\r\n                        helperText=\"Write the name to display as author ...\"\r\n                        onChange={e => typingVal('authorDisplayName', e.target.value, info)}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    <TextField\r\n                        fullWidth\r\n                        variant=\"outlined\"\r\n                        label=\"Email\"\r\n                        disabled\r\n                        value={userEmail || 'Please login'}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    {!info.storyUrl &&\r\n                    <TextField\r\n                        fullWidth\r\n                        variant=\"outlined\"\r\n                        label=\"Custom URL\"\r\n                        value={info.desiredUrl}\r\n                        helperText=\"Only alphabets, numbers, hyphens (-) allowed. Can not be changed later\"\r\n                        onChange={e => typingVal('desiredUrl', e.target.value, info)}\r\n                    />}\r\n                    {info.storyUrl &&\r\n                        <TextField\r\n                            fullWidth\r\n                            variant=\"outlined\"\r\n                            label=\"Custom URL\"\r\n                            disabled\r\n                            value={'/' + info.storyUrl}\r\n                        />\r\n                    }\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={3} className={clsx(classes.imgUploadSec, !info.storyUrl && 'hide')}>\r\n                    <div className=\"img-preview\">\r\n                        { previewImgUrl && <img src={previewImgUrl} /> }\r\n                    </div>\r\n                    <div className=\"btns\">\r\n                        <Button \r\n                            variant=\"outlined\" \r\n                            color=\"primary\"\r\n                            onClick={() => document.getElementById('taleimgupload').click()}\r\n                        >\r\n                            Select\r\n                        </Button>\r\n                        <Button \r\n                            variant=\"contained\" \r\n                            color=\"primary\"\r\n                            onClick={() => uploadImg(info)}\r\n                        >\r\n                            Upload\r\n                        </Button>\r\n                        \r\n                        <input id=\"taleimgupload\" type=\"file\" name=\"storyimage\" accept=\"image/*\" onChange={loadImg} className=\"hide\" />\r\n                    </div>\r\n                    \r\n                </Grid>\r\n                <Grid item xs={12}>\r\n                    <TextField\r\n                        multiline\r\n                        rows=\"4\"\r\n                        fullWidth\r\n                        label=\"Brief description\"\r\n                        required\r\n                        variant=\"outlined\"\r\n                        value={info.description}\r\n                        onChange={e => typingVal('description', e.target.value, info)}\r\n                        InputProps={info.description.length <= 100 && {\r\n                            endAdornment: <InputAdornment position=\"end\"><ErrorOutlineIcon /></InputAdornment>,\r\n                        }}\r\n                    />\r\n                </Grid>\r\n            </Grid>\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    info: state.wipTale.info,\r\n    userEmail: state.user.email\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    typingVal: (key, val, oldInfo) => updateTaleInfo(dispatch, key, val, oldInfo),\r\n    updateImgUrl: imgUrl => dispatch(actionUpdateImgUrl(imgUrl))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateTaleIntro)","import React from 'react'\r\nimport { makeStyles, TextField, Box } from '@material-ui/core'\r\nimport {connect} from 'react-redux'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\nimport {\r\n    CHOICE_UPDATE_TEXT, \r\n    STORYBOARD_SELECT_CHOICE,\r\n    STORYBOARD_INSERT_AT\r\n} from '../../../redux/actionTypes'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    choiceBox: {\r\n        position: \"relative\",\r\n        margin: theme.spacing(1),\r\n        flexGrow: 1\r\n    },\r\n    selectChoice: {\r\n        position: \"absolute\",\r\n        top: -theme.spacing(1),\r\n        left: -theme.spacing(1)\r\n    },\r\n    choiceText: {\r\n        width: \"100%\",\r\n        '& > div': {\r\n            paddingTop: 30\r\n        }\r\n    },\r\n    idTag: {\r\n        fontSize: 13,\r\n        display: 'inline-block',\r\n        backgroundColor: '#eee',\r\n        padding: '1px 5px',\r\n        borderRadius: 2,\r\n        position: 'absolute',\r\n        top: theme.spacing(.5),\r\n        left: theme.spacing(3.5)\r\n        // '& input': {\r\n        //     fontSize: 14,\r\n        //     backgroundColor: 'inherit',\r\n        //     outline: 'none',\r\n        //     border: 'none',\r\n        //     width: 60\r\n        // }\r\n    },\r\n    btnPanel: {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        right: 0,\r\n        zIndex: 9,\r\n        '& .ico': {\r\n            boxSizing: 'content-box',\r\n            padding: \"5px 7px\",\r\n            color: theme.palette.primary.main,\r\n            cursor: 'pointer',\r\n            borderRadius: '50%',\r\n            verticalAlign: \"middle\",\r\n            fontSize: 16,\r\n            display: 'inline-block'\r\n        },\r\n        '& .ico:active': {\r\n            backgroundColor: '#eee'\r\n        }\r\n    }\r\n}))\r\n\r\nconst updateChoiceText = (dispatch, cID, value) => {\r\n    dispatch({\r\n        type: CHOICE_UPDATE_TEXT,\r\n        payload: {cID, value}\r\n    })\r\n}\r\n\r\nconst selectChoice = (dispatch, cID, isSelected, sbI, nextStID) => {\r\n    cID = isSelected ? cID : '' // blank if Deselcetd\r\n\r\n    // Select The Choice\r\n    dispatch({\r\n        type: STORYBOARD_SELECT_CHOICE,\r\n        payload: {sbI, cID}\r\n    })\r\n\r\n    // Update the storyboard\r\n    // Rollback upto this sbI (storyboard Index)\r\n    // And Insert nextStID\r\n    // Optionally pass isRemoveOnly for Deselection\r\n    dispatch({\r\n        type: STORYBOARD_INSERT_AT,\r\n        payload: { sbI, nextStID, isRemoveOnly: !isSelected }\r\n    })\r\n}\r\n\r\nconst Choice = props => {\r\n    const classes = useStyles()\r\n    const { c, stID, sbI } = props\r\n    if(!c) {\r\n        console.log(' returning from Choice, as Choice is undefined... ')\r\n        return <></>\r\n    }\r\n    return (\r\n        <Box className={classes.choiceBox}>\r\n            <div className={classes.idTag}>\r\n                <span>ID: {c.id}</span>\r\n            </div>\r\n            <div className={classes.btnPanel}>\r\n                {/* <FontAwesomeIcon icon={faTrashAlt} className=\"ico\" /> */}\r\n            </div>\r\n            <TextField\r\n                // label=\"Choice text\"\r\n                placeholder=\"Enter choice text here\"\r\n                multiline\r\n                rows=\"3\"\r\n                variant=\"outlined\"\r\n                className={classes.choiceText}\r\n                value={c.text}\r\n                onChange={e => props.typingChoiceText(c.id, e.target.value)}\r\n            />\r\n            <Checkbox\r\n                checked={props.isSelected}\r\n                onChange={(e) => props.handleSelection(stID, c.id, e.target.checked, sbI, c.next)}\r\n                value=\"primary\"\r\n                className={classes.selectChoice}\r\n                inputProps={{ 'aria-label': 'primary checkbox' }}\r\n            />\r\n        </Box>\r\n    )\r\n}\r\nconst mapDispatchToProps = dispatch => ({\r\n    typingChoiceText: (cID, value) => updateChoiceText(dispatch, cID, value),\r\n    handleSelection: (stID, cID, isSelected, sbI, nextStID) => selectChoice(dispatch, cID, isSelected, sbI, nextStID)\r\n})\r\nexport default connect(null, mapDispatchToProps)(Choice)","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        fontFamily: \"Georgia, serif\",\r\n        fontSize: 20,\r\n        fontWeight: 'bold',\r\n        // transform: 'scaleX(0.72)',\r\n        display: 'inline-block',\r\n        transition: \"fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms\"\r\n    }\r\n}))\r\n\r\nconst ReactoIcon = props => {\r\n    const classes = useStyles()\r\n    const { className } = props\r\n    return (\r\n        <span {...props} className={clsx(className, classes.root)}>((r))</span>\r\n    )\r\n}\r\n\r\nexport default ReactoIcon","import React from 'react'\r\nimport { TextField, Box, Fab, makeStyles } from '@material-ui/core'\r\nimport Choice from './Choice'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faEye, faPencilAlt } from '@fortawesome/free-solid-svg-icons'\r\nimport AddIcon from '@material-ui/icons/AddBox'\r\nimport ReactoIcon from '../../common/icons/ReactoIcon'\r\nimport { connect } from 'react-redux'\r\nimport { STORYLET_UPDATE_FIELD } from '../../../redux/actionTypes'\r\nimport { actionCreateChoice } from '../../../redux/actionCreators/createTaleActions'\r\nimport { orange } from '@material-ui/core/colors'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    textField: {\r\n        display: \"flex\",\r\n        marginTop: theme.spacing(2)\r\n    },\r\n    box: {\r\n        border: `5px double ${orange[500]}`,\r\n        borderRadius: 4,\r\n        position: \"relative\"\r\n    },\r\n    title: {\r\n        border: `5px double ${orange[500]}`,\r\n        position: \"absolute\",\r\n        background: '#fff',\r\n        padding: '0 5px',\r\n        borderRadius: 4,\r\n        top: -20,\r\n        left: 8,\r\n        fontSize: 14,\r\n        userSelect: 'none',\r\n        cursor: 'default'\r\n    },\r\n    joiner: {\r\n        position: \"absolute\",\r\n        height: theme.spacing(5),\r\n        borderLeft: `5px double ${orange[500]}`,\r\n        width: 1,\r\n        left: \"50%\",\r\n        top: -45\r\n    },\r\n    choiceContainer: {\r\n        display: \"flex\",\r\n        flexWrap: \"wrap\",\r\n        justifyContent: \"space-between\"\r\n    },\r\n    addChoiceBtn: {\r\n        alignSelf: \"center\",\r\n        height: 90,\r\n        borderRadius: 6,\r\n        margin: `0 ${theme.spacing(1)}px`,\r\n        textAlign: \"center\",\r\n        fontSize: 16,\r\n        lineHeight: \" 20px\",\r\n        '& span': {\r\n            display: \"block\"\r\n        },\r\n        '& svg': {\r\n            fontSize: 36\r\n        }\r\n    },\r\n    idTag: {\r\n        fontSize: 14,\r\n        display: 'inline-block',\r\n        backgroundColor: '#eee',\r\n        padding: '2px 5px',\r\n        borderRadius: 2,\r\n        '& .ico': {\r\n\r\n        }\r\n        // '& input': {\r\n        //     fontSize: 14,\r\n        //     backgroundColor: 'inherit',\r\n        //     outline: 'none',\r\n        //     border: 'none',\r\n        //     width: 60\r\n        // }\r\n    },\r\n    btnPanel: {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        right: 0,\r\n        '& .ico': {\r\n            boxSizing: 'content-box',\r\n            padding: \"15px 8px\",\r\n            color: theme.palette.primary.main,\r\n            borderRadius: '50%',\r\n            verticalAlign: \"middle\",\r\n            fontSize: 18,\r\n            display: 'inline-block',\r\n            cursor: 'default',\r\n            '&:hover': {\r\n                transform: 'scale(1.2)'\r\n            },\r\n            '&:active': {\r\n                transform: 'scale(.9)'\r\n            }\r\n        },\r\n    }\r\n}))\r\n\r\nconst Storylet = props => {\r\n    const classes = useStyles()\r\n    const { st, sbI, sbItem, createAChoice, choices, openFSE, openReactoModal } = props\r\n    return (\r\n        <div>\r\n            {/* STORYLET BOX -- STARTS HERE */}\r\n            <Box className={classes.box} px={1} pb={2} pt={2}>\r\n                {(sbI !== 0) && <span className={classes.joiner}></span>}\r\n                <span className={classes.title}>Storylet</span>\r\n                <div className={classes.idTag}>\r\n                    <span>ID: {st.id}</span>\r\n                    {/* <input type=\"text\" value={st.id} disabled /> */}\r\n                </div>\r\n                <div className={classes.btnPanel}>\r\n                    {/* <FontAwesomeIcon icon={faTrashAlt} className=\"ico\" /> */}\r\n                    <ReactoIcon className=\"ico\" onClick={openReactoModal} />\r\n                    <FontAwesomeIcon \r\n                        icon={faEye} \r\n                        className=\"ico\" \r\n                        title=\"Preview Storylet\"\r\n                        onClick={() => openFSE(st, 'PREVIEW')}\r\n                    />\r\n                    <FontAwesomeIcon\r\n                        icon={faPencilAlt}\r\n                        className=\"ico\"\r\n                        title=\"Full Screen Edit\"\r\n                        onClick={() => openFSE(st, 'EDIT')}\r\n                    />\r\n                </div>\r\n                <form noValidate autoComplete=\"off\">\r\n                    <TextField\r\n                        label=\"Storylet title\"\r\n                        variant=\"outlined\"\r\n                        className={classes.textField}\r\n                        value={st.title}\r\n                        onChange={e => props.typingStValue(st.id, \"title\", e.target.value)}\r\n                    />\r\n                    <TextField\r\n                        label=\"Storylet body\"\r\n                        multiline\r\n                        rows=\"6\"\r\n                        variant=\"outlined\"\r\n                        className={classes.textField}\r\n                        value={st.text}\r\n                        onChange={e => props.typingStValue(st.id, \"text\", e.target.value)}\r\n                    />\r\n                </form>\r\n            </Box>\r\n            {/* STORYLET BOX -- ENDS HERE */}\r\n\r\n            {/* CHOICES BOX -- STARTS HERE */}\r\n            <Box className={classes.box} pt={2} pb={2} my={5}>\r\n                <span className={classes.joiner}></span>\r\n                <span className={classes.title}>Choices</span>\r\n                <div className={classes.choiceContainer}>\r\n                    {\r\n                        st.choices && st.choices.map(cID => (\r\n                            <Choice\r\n                                c={choices[cID]}\r\n                                stID={st.id}\r\n                                sbI={sbI}\r\n                                isSelected={sbItem.selectedCID === cID}\r\n                                key={cID}\r\n                            />\r\n                        ))\r\n                    }\r\n                    <Fab className={classes.addChoiceBtn} variant=\"extended\" color=\"primary\" onClick={() => createAChoice(props.st.id)}>\r\n                        <AddIcon />\r\n                        <span className=\"txt\">Add Choice</span>\r\n                    </Fab>\r\n                </div>\r\n\r\n            </Box>\r\n            {/* CHOICES BOX -- ENDS HERE */}\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nconst UpdateStField = (stID, fieldName, value, dispatch) => {\r\n    dispatch({\r\n        type: STORYLET_UPDATE_FIELD,\r\n        payload: {\r\n            stID, fieldName, value\r\n        }\r\n    })\r\n}\r\nconst mapStateToProps = state => ({\r\n    choices: state.wipTale.choices\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    typingStValue: (stID, fieldName, value) => UpdateStField(stID, fieldName, value, dispatch),\r\n    createAChoice: stID => dispatch(actionCreateChoice(stID))\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Storylet)","import React from 'react';\r\nimport clsx from 'clsx'\r\nimport { makeStyles, Button, Dialog, AppBar, Toolbar, \r\n    Typography, Slide } from '@material-ui/core'\r\nimport DoneIcon from '@material-ui/icons/Done';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    appBar: {\r\n        position: 'fixed',\r\n        '& .MuiToolbar-regular': {\r\n            minHeight: 45\r\n        }\r\n    },\r\n    title: {\r\n        flex: 1,\r\n    },\r\n    body: {\r\n        padding: '45px 0 25px 0'\r\n    }\r\n}));\r\n\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n    return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\nconst FullScreenModal = props => {\r\n    const classes = useStyles();\r\n    const { isOpen, handleClose, title, children, className, btnText, btnClick, cancelText } = props\r\n\r\n    return (\r\n        <div className={clsx(className)}>\r\n            <Dialog fullScreen open={isOpen} onClose={handleClose} TransitionComponent={Transition}>\r\n                <AppBar className={classes.appBar}>\r\n                    <Toolbar>\r\n                        <Typography variant=\"h6\" className={classes.title}>\r\n                            {title}\r\n                        </Typography>\r\n                        {btnText &&\r\n                            <Button \r\n                                variant=\"contained\"\r\n                                onClick={btnClick || handleClose}\r\n                                size=\"small\"\r\n                                color=\"secondary\"\r\n                                startIcon={<DoneIcon />}\r\n                            >\r\n                                {btnText}\r\n                            </Button>\r\n                        }\r\n                        <Button \r\n                            color=\"inherit\" \r\n                            onClick={handleClose}\r\n                            size=\"small\"\r\n                        >\r\n                           { cancelText || \"Cancel\" }\r\n                        </Button>\r\n                    </Toolbar>\r\n                </AppBar>\r\n                <div className={classes.body}>\r\n                    {children}\r\n                </div>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n}\r\n\r\n\r\nexport default FullScreenModal","import { ALLOWED_TAGS } from './constants'\r\nexport {\r\n    startsWith,\r\n    downloadAsFile,\r\n    getLocalStorageSpace,\r\n    sanitize,\r\n    isEmailValid,\r\n    isPasswordValid\r\n}\r\n\r\nfunction startsWith (src, part) {\r\n    return src.substring(0, part.length) === part\r\n}\r\n\r\n\r\n/**\r\n * This is a static download functionality\r\n * i.e. provide a fulename and some text,\r\n * and this function will start a download a file of that filename \r\n * containing the provided text in the browser\r\n * @param {*} filename \r\n * @param {*} text \r\n */\r\nfunction downloadAsFile (filename, text) {\r\n    var element = document.createElement('a');\r\n    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + text);\r\n    element.setAttribute('download', filename);\r\n\r\n    element.style.display = 'none';\r\n    document.body.appendChild(element);\r\n\r\n    element.click();\r\n\r\n    document.body.removeChild(element);\r\n}\r\n\r\n/**\r\n * Returns an approximate size of total localstorage space\r\n */\r\nfunction getLocalStorageSpace () {\r\n    var allStrings = '';\r\n    for (var key in window.localStorage) {\r\n        if (window.localStorage.hasOwnProperty(key)) {\r\n            allStrings += window.localStorage[key];\r\n        }\r\n    }\r\n    return allStrings ? 3 + ((allStrings.length * 16) / (8 * 1024)) + ' KB' : 'Empty (0 KB)';\r\n}\r\n\r\n/**\r\n * Sanitize HTML\r\n * @param {*} dirtyHtml \r\n */\r\nconst sanitize = dirtyHtml => window.DOMPurify.sanitize(dirtyHtml, { ALLOWED_TAGS })\r\n\r\n\r\nconst isEmailValid = email => (/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(email))\r\n\r\n//\r\n// at least one lowercase letter, \r\n// one uppercase letter, one numeric digit, \r\n// and one special character\r\n// Length between 8 to 20\r\n// https://www.w3resource.com/javascript/form/password-validation.php\r\n//\r\nconst isPasswordValid = pswd => (/^(?=.*[0-9])(?=.*[- ?!@#$%^&*\\/\\\\])(?=.*[A-Z])(?=.*[a-z])[a-zA-Z0-9- ?!@#$%^&*\\/\\\\]{8,20}$/.test(pswd))","import React, { useState, useEffect, createRef } from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles, Container, TextField, Box } from '@material-ui/core'\r\nimport { connect } from 'react-redux'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faEye, faPencilAlt, faBold, faItalic, \r\n    faUnderline, faStrikethrough, faAlignCenter } \r\n    from '@fortawesome/free-solid-svg-icons'\r\n    \r\nimport FullScreenModal from './FullScreenModal'\r\nimport ReactoIcon from '../icons/ReactoIcon'\r\nimport {\r\n    actionUpdateSTAllText, actionUpdateCText\r\n} from '../../../redux/actionCreators/createTaleActions'\r\nimport { sanitize } from '../../../utils/util'\r\nconst notify = window['notify']\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    xScroller: {\r\n        width: '100%',\r\n        display: 'flex',\r\n        justifyContent: 'space-between',\r\n        padding: '0 5px'\r\n    },\r\n    formatterBtns: {\r\n        paddingTop: 5,\r\n        marginBottom: 5,\r\n        color: theme.palette.primary.main,\r\n        overflowX: 'auto',\r\n        overflowY: 'hidden',\r\n        '& .ico': {\r\n            padding: '13px 5px',\r\n            height: 47,\r\n            width: 47,\r\n            display: 'inline-flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'flex-end',\r\n            cursor: 'default',\r\n            '&:hover': {\r\n                transform: 'scale(1.2)'\r\n            }\r\n        },\r\n        '& .ico.reacto': {\r\n            padding: '13px 0',\r\n        }\r\n    },\r\n    textField: {\r\n        marginTop: 20,\r\n        '& .MuiInputBase-multiline': {\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            flexGrow: 1\r\n        },\r\n        '& textarea': {\r\n            // fontFamily: 'Georgia, serif',\r\n        }\r\n    },\r\n    editForm: {\r\n        minHeight: '90vh',\r\n        paddingTop: 5,\r\n    },\r\n    previewBody: {\r\n        whiteSpace: 'pre-wrap',\r\n        wordBreak: 'break-word',\r\n        textAlign: 'justify',\r\n        borderTop: '1px solid #ddd',\r\n        paddingTop: 15\r\n    }\r\n}))\r\n\r\nconst FullScreenEdit = props => {\r\n    const classes = useStyles()\r\n    const MODES = ['EDIT', 'PREVIEW']\r\n    const { component, activeMode, handleClose, saveStValue, saveChValue, openReactoModal } = props\r\n\r\n    const t = component && component.id[0] === 'S' ? 'Storylet' : 'Choice'  // t for type\r\n    const theForm = createRef()\r\n\r\n    const [currentActiveMode, setCurrentActiveMode] = useState(MODES[1])\r\n    const [currentComp, setCurrentComp] = useState(null)\r\n\r\n    // Once it will be set from outside\r\n    // later it can also be changed from inside,\r\n    // say toggling between Edit and Preview\r\n    useEffect(() => {\r\n        setCurrentActiveMode(activeMode)\r\n    },\r\n        [activeMode])\r\n\r\n    // Save the component in state\r\n    // It will required while toogling\r\n    useEffect(() => {\r\n        setCurrentComp(component)\r\n    },\r\n        [component])\r\n\r\n\r\n    const save = () => {\r\n        const compText = theForm.current.elements.compText.value\r\n        if (t === 'Storylet') {\r\n            const compTitle = theForm.current.elements.compTitle.value\r\n            saveStValue(component.id, compTitle, compText)\r\n\r\n            // also update the currentComp, as it is not directly tied to redux\r\n            // required for toggling mode\r\n            // Otherwise, Preview will not take up the latest Edits\r\n            setCurrentComp({\r\n                ...currentComp,\r\n                title: compTitle,\r\n                text: compText\r\n            })\r\n        }\r\n        else if (t === 'Choice') {\r\n            saveChValue(component.id, compText)\r\n        }\r\n    }\r\n\r\n    const saveAndClose = () => {\r\n        save()\r\n        handleClose()\r\n        setCurrentComp(null)\r\n    }\r\n\r\n    const getPreviewHTML = txt => {\r\n        const __html = sanitize(window.rto.process(txt))\r\n        return { __html }\r\n    }\r\n\r\n    /**\r\n     * Change from 'EDIT' to 'PREVIEW' or vice-versa\r\n     * This feature is ONLY AVAILABLE FOR STORYLETS\r\n     * @param {String} mode | 'EDIT' or 'PREVIEW'\r\n     */\r\n    const changeModeTo = mode => {\r\n        // Validate, mode must 1 of the MODES constants\r\n        if (!MODES.includes(mode)) return\r\n\r\n        // must save first if going from edit to preview\r\n        // this will dispatch a save to redux store\r\n        if (mode === 'PREVIEW') save()\r\n\r\n        // Change mode\r\n        setCurrentActiveMode(mode)\r\n    }\r\n\r\n    const formatText = type => {\r\n        const el = document.getElementById('comptextareaid')\r\n        const startIndex = el.selectionStart,\r\n            endIndex = el.selectionEnd\r\n\r\n        if (startIndex === endIndex) {\r\n            return notify('Select some text first ...')\r\n        }\r\n\r\n        const currentText = el.value\r\n\r\n        // Init with a default of BOLD\r\n        let startTag = '<b>',\r\n            closeTag = '</b>'\r\n\r\n        if (type === 'ITALIC') {\r\n            startTag = '<i>'\r\n            closeTag = '</i>'\r\n        }\r\n        else if (type === 'STRIKETHRU') {\r\n            startTag = '<s>'\r\n            closeTag = '</s>'\r\n        }\r\n        else if (type === 'UNDERLINE') {\r\n            startTag = '<u>'\r\n            closeTag = '</u>'\r\n        }\r\n        else if (type === 'CENTER') {\r\n            startTag = '<c>'\r\n            closeTag = '</c>'\r\n        }\r\n\r\n        theForm.current.elements.compText.value =\r\n            currentText.substring(0, startIndex)\r\n            + startTag\r\n            + currentText.substring(startIndex, endIndex)\r\n            + closeTag\r\n            + currentText.substring(endIndex)\r\n\r\n        // Restore selection, \r\n        // incase user wants to do further formatting\r\n        el.focus()\r\n        el.selectionStart = startIndex\r\n        el.selectionEnd = endIndex + startTag.length + closeTag.length\r\n    }\r\n\r\n    return (\r\n        <FullScreenModal\r\n            title={currentActiveMode + ' ' + t}\r\n            {...props}\r\n            btnText={currentActiveMode === 'EDIT' ? 'Update' : ''}\r\n            btnClick={saveAndClose}\r\n        >\r\n            <Container maxWidth=\"md\">\r\n\r\n                {/* THE EDIT SECTION */}\r\n                <Box className={clsx(currentActiveMode !== 'EDIT' && 'hide')}>\r\n                    {/* Format buttons */}\r\n\r\n                    <div className={classes.formatterBtns}>\r\n                        <div className={classes.xScroller}>\r\n                            <FontAwesomeIcon\r\n                                icon={faBold}\r\n                                className={clsx(\"ico\", t !== 'Storylet' && 'hide')}\r\n                                title=\"Bold\"\r\n                                onClick={() => formatText('BOLD')}\r\n                            />\r\n                            <FontAwesomeIcon\r\n                                icon={faItalic}\r\n                                className={clsx(\"ico\", t !== 'Storylet' && 'hide')}\r\n                                title=\"Italic\"\r\n                                onClick={() => formatText('ITALIC')}\r\n                            />\r\n                            <FontAwesomeIcon\r\n                                icon={faUnderline}\r\n                                className={clsx(\"ico\", t !== 'Storylet' && 'hide')}\r\n                                title=\"Underline\"\r\n                                onClick={() => formatText('UNDERLINE')}\r\n                            />\r\n                            <FontAwesomeIcon\r\n                                icon={faStrikethrough}\r\n                                className={clsx(\"ico\", t !== 'Storylet' && 'hide')}\r\n                                title=\"Strike Through\"\r\n                                onClick={() => formatText('STRIKETHRU')}\r\n                            />\r\n                            <FontAwesomeIcon\r\n                                icon={faAlignCenter}\r\n                                className={clsx(\"ico\", t !== 'Storylet' && 'hide')}\r\n                                title=\"Center\"\r\n                                onClick={() => formatText('CENTER')}\r\n                            />\r\n                            <ReactoIcon className=\"ico reacto\" onClick={openReactoModal} />\r\n                            <FontAwesomeIcon\r\n                                icon={faEye}\r\n                                className={clsx(\"ico\", t !== 'Storylet' && 'hide')}\r\n                                title=\"Preview Storylet\"\r\n                                onClick={() => changeModeTo('PREVIEW')}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <form noValidate autoComplete=\"off\"\r\n                        ref={theForm} className={clsx(classes.editForm, \"flex-full-height\")}\r\n                    >\r\n                        {(t === 'Storylet') && <TextField\r\n                            label=\"Storylet title\"\r\n                            variant=\"outlined\"\r\n                            defaultValue={currentComp && currentComp.title}\r\n                            fullWidth\r\n                            size=\"small\"\r\n                            name=\"compTitle\"\r\n                        />}\r\n                        <TextField\r\n                            label={t + \" body\"}\r\n                            multiline\r\n                            variant=\"outlined\"\r\n                            defaultValue={currentComp && currentComp.text}\r\n                            fullWidth\r\n                            className={clsx(classes.textField, \"flex-full-height\")}\r\n                            name=\"compText\"\r\n                            id=\"comptextareaid\"\r\n                        />\r\n                    </form>\r\n                </Box>\r\n\r\n                {/* THE PREVIEW SECTION */}\r\n                <Box className={clsx(currentActiveMode !== 'PREVIEW' && 'hide')}>\r\n                    {\r\n                        (!currentComp || currentComp.text.trim().length <= 0) &&\r\n                        <div>Preview will appear here ...</div>\r\n                    }\r\n                    {\r\n                        currentComp && currentComp.text.trim().length > 0 &&\r\n                        // <div className={classes.preview} dangerouslySetInnerHTML={ getPreviewHTML() } />\r\n                        <>\r\n                            {/* Format buttons */}\r\n                            <div className={clsx(classes.formatterBtns, 'text-right', 'overflow-none')}>\r\n                                <FontAwesomeIcon\r\n                                    icon={faPencilAlt}\r\n                                    className={clsx(\"ico\", t !== 'Storylet' && 'hide')}\r\n                                    title=\"Full Screen Edit\"\r\n                                    onClick={() => changeModeTo('EDIT')}\r\n                                />\r\n                            </div>\r\n                            <div\r\n                                dangerouslySetInnerHTML={getPreviewHTML(currentComp.text)}\r\n                                className={classes.previewBody}>\r\n                            </div>\r\n                        </>\r\n                    }\r\n                </Box>\r\n\r\n            </Container>\r\n        </FullScreenModal>\r\n    )\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    saveStValue: (stID, title, text) => dispatch(actionUpdateSTAllText(stID, title, text)),\r\n    saveChValue: (cID, value) => dispatch(actionUpdateCText(cID, value))\r\n})\r\n\r\nexport default connect(null, mapDispatchToProps)(FullScreenEdit)","import React, { Dispatch, useState } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { Box } from '@material-ui/core';\r\nimport Storylet from '../../common/storylet/Storylet'\r\nimport FullScreenEdit from '../../common/modal/FullScreenEdit'\r\nimport { UI_REACTO_MODAL_OPEN } from '../../../redux/actionTypes'\r\nimport { TStorylet, TChoice, TStoryBoardItem, TReactale } from '../../../types'\r\nimport { E_FSE_MODE } from '../../../types/enums'\r\n\r\ntype Props = {\r\n    openReactoModal: () => void\r\n    storylets: { [stID: string]: TStorylet }\r\n    storyboard: TStoryBoardItem[]\r\n}\r\n\r\ntype TFullScreenEditParams = {\r\n    isVisible: boolean\r\n    mode: E_FSE_MODE\r\n    component: TStorylet | TChoice\r\n}\r\n\r\nconst CreateTaleBody = (props: Props) => {\r\n    const [fseParam, setFSEParam] = useState({} as TFullScreenEditParams)    // Full Screen Edit \r\n    const { openReactoModal, storylets, storyboard } = props\r\n    const closeFSE = () => setFSEParam({} as TFullScreenEditParams)\r\n    // component is either a St or a Ch object\r\n    // mode can be \"EDIT\" / \"PREVIEW\"\r\n    const openFSE = (component: TStorylet | TChoice, mode=E_FSE_MODE.EDIT) => {\r\n        // console.log(component)\r\n        setFSEParam({\r\n            component, mode, isVisible: true\r\n        })\r\n    }\r\n\r\n    // useEffect(() => {\r\n    //     console.log('inside useEffect')\r\n    //     console.log('new storylets = ', storylets)\r\n    // }, [storylets])\r\n\r\n    /**\r\n     * Change from 'EDIT' to 'PREVIEW' or vice-versa\r\n     * We will allow this feture only for Storylets\r\n     * And NOT for Choices\r\n     * @param {String} mode | 'EDIT' or 'PREVIEW'\r\n     * @param {String} componentID | StoryletID\r\n     */\r\n    // const handleModeChange = (mode, stID) => {\r\n    //     console.log('inside handleModeChange')\r\n    //     // Get the updated component from the store\r\n    //     console.log('storylets = ', storylets)\r\n    //     const component = {...storylets[stID]}\r\n    //     setFSEParam({\r\n    //         component, mode, isVisible: true\r\n    //     })\r\n    // }\r\n\r\n    return (\r\n        <Box py={3}>\r\n            {\r\n                storyboard && storyboard.map( (sbItem, sbI) => {\r\n                    let st = storylets[sbItem.stID]\r\n                    return (\r\n                        <Storylet \r\n                            st={st} \r\n                            key={sbItem.stID} \r\n                            sbI={sbI} \r\n                            sbItem={sbItem} \r\n                            openFSE={openFSE}\r\n                            openReactoModal={openReactoModal}\r\n                        />\r\n                    )\r\n                })\r\n            }\r\n            <FullScreenEdit \r\n                isOpen={fseParam.isVisible}\r\n                activeMode={fseParam.mode}\r\n                handleClose={closeFSE}\r\n                component={fseParam.component}\r\n                openReactoModal={openReactoModal}\r\n                // onModeChange={handleModeChange}\r\n            />\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = (state: {wipTale: TReactale}) => ({\r\n    storyboard: state.wipTale.storyboard,\r\n    storylets: state.wipTale.storylets\r\n})\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => ({\r\n    openReactoModal: () => dispatch({type: UI_REACTO_MODAL_OPEN})\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateTaleBody as any)","export default {\r\n    exportTale: {\r\n        desc: \"Export this reactale\",\r\n        features: [\r\n            \"Export Reactale as both Text and File\",\r\n            \"Exported Reactale can be imported and worked on\",\r\n            \"Can be shared easily with reviewers and collaborator\",\r\n            \"Works offline (Internet not required)\",\r\n            \"People can see only if you share this file with them\"\r\n        ]\r\n    },\r\n    saveLocal: {\r\n        desc: \"Save reactale in this device\",\r\n        features: [\r\n            \"Will be saved in this device's memory\",\r\n            \"Will not be available in other devices\",\r\n            \"Great choice if you use this device only for writing Reactale\",\r\n            \"Works offline (Internet not required)\",\r\n            \"ANYONE using this device can see your story\"\r\n        ]\r\n    },\r\n    saveOnline: {\r\n        desc: \"Save this reactale online\",\r\n        features: [\r\n            \"Will be saved online in your logged in account\",\r\n            \"Availabe accross any device you login from\",\r\n            \"Great choice if you work from multiple devices\",\r\n            \"Internet is mandatory and must be logged in\",\r\n            \"People can see only when you publish your story\"\r\n        ]\r\n    }\r\n}","import React, { Dispatch } from 'react'\r\nimport clsx from 'clsx'\r\nimport { ajaxPost } from '../../../utils/ajax'\r\nimport { makeStyles, Container, Box, Grid, FormControlLabel, Checkbox, Button } from '@material-ui/core'\r\nimport { InfoCard } from '../../common/cards'\r\nimport featureText from './exportFeatureText'\r\nimport { Li } from '../../common/misc'\r\nimport { PUB_UNPUB } from '../../../utils/urls'\r\nimport { connect } from 'react-redux'\r\nimport { TALE_PUBLISH, TALE_UNPUBLISH } from '../../../redux/actionTypes'\r\nimport { TWindow, TReactale } from '../../../types'\r\nimport { E_SAVE_TYPES } from '../../../types/enums'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    cardHeaders: {\r\n        fontWeight: 500,\r\n        margin: 0,\r\n        textAlign: 'center',\r\n        color: theme.palette.primary.main\r\n    },\r\n    cardContainer: {\r\n        marginTop: theme.spacing(3)\r\n    },\r\n    cardInfo: {\r\n        padding: '0 10px',\r\n        marginTop: 3\r\n    },\r\n    pubSec: {\r\n        borderTop: `1px solid ${theme.palette.primary.main}`,\r\n        marginTop: 60,\r\n        paddingTop: 5\r\n    },\r\n    btnContainer: {\r\n        display: 'flex',\r\n        justifyContent: 'flex-end'\r\n    }\r\n}))\r\n\r\ntype Props = {\r\n    exportWIPTale: () => void\r\n    saveTaleOnline: () => void\r\n    saveTaleLocal: () => void\r\n    markSaveDefault: (saveType: E_SAVE_TYPES) => void\r\n    publish: () => void\r\n    unpublish: () => void\r\n    tale: TReactale\r\n    saveDefault: E_SAVE_TYPES\r\n}\r\n\r\nconst CreateTaleFinish = (props: Props) => {\r\n    const classes = useStyles()\r\n    const { exportWIPTale, saveTaleOnline, saveTaleLocal, saveDefault, \r\n        markSaveDefault, tale, publish, unpublish } = props\r\n    const { notify }  = window as TWindow\r\n\r\n    const togglePublish = () => {\r\n        if(!tale.info.storyUrl) {\r\n            notify('The story must be saved online once before publishing')\r\n            return\r\n        }\r\n\r\n        let data = {\r\n            storyUrl: tale.info.storyUrl,\r\n            isPublished: !tale.isPublished\r\n        }\r\n        ajaxPost(PUB_UNPUB, data)\r\n        .then(res => {\r\n            const { status, msg } = res.data\r\n            if(status === 200) {\r\n                if(data.isPublished) {\r\n                    publish()\r\n                    notify(\"Published successfully\")\r\n                }\r\n                else {\r\n                    unpublish()\r\n                    notify(\"Unpublished successfully\")\r\n                }\r\n            }\r\n            else {\r\n                notify(msg)\r\n            }\r\n        })\r\n        .catch(err => {\r\n            notify('Some error occured')\r\n            console.log(err)\r\n        })\r\n    }\r\n    \r\n    return (\r\n        <Box pb={10}>\r\n            <Container maxWidth=\"md\">\r\n                <Grid container spacing={2}>\r\n                    \r\n                    <Grid item xs={12} md={4} className={classes.cardContainer}>\r\n                        <InfoCard>\r\n                            <h2 className={classes.cardHeaders}>Save Offline</h2>\r\n                            <span className={classes.cardInfo}>{featureText.saveLocal.desc}</span>\r\n                            \r\n                            <Box my={1}>\r\n                                <FormControlLabel\r\n                                    control={<Checkbox checked={saveDefault === E_SAVE_TYPES.OFFLINE} onChange={() => markSaveDefault(E_SAVE_TYPES.OFFLINE)} name=\"OFFLINE\" />}\r\n                                    label=\"Set as default\"\r\n                                />\r\n                            </Box>\r\n\r\n                            <div className=\"fillmid\">\r\n                                <h3 className={classes.cardHeaders}>Pros &amp; Cons</h3>\r\n                                <ul className=\"\">\r\n                                    {\r\n                                        featureText.saveLocal.features.map( t => \r\n                                            <Li key={t}>{t}</Li>\r\n                                        )\r\n                                    }\r\n                                </ul>\r\n                            </div>\r\n\r\n                            <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={saveTaleLocal}\r\n                            >\r\n                                Save Offline\r\n                            </Button>\r\n                        </InfoCard>\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12} md={4} className={classes.cardContainer} >\r\n                        <InfoCard>\r\n                            <h2 className={classes.cardHeaders}>Save Online</h2>\r\n                            <span className={classes.cardInfo}>{featureText.saveOnline.desc}</span>\r\n                            \r\n                            <Box my={1}>\r\n                                <FormControlLabel\r\n                                    control={<Checkbox checked={saveDefault === E_SAVE_TYPES.ONLINE} onChange={() => markSaveDefault(E_SAVE_TYPES.ONLINE)} name=\"ONLINE\" />}\r\n                                    label=\"Set as default\"\r\n                                />\r\n                            </Box>\r\n\r\n                            <div className=\"fillmid\">\r\n                                <h3 className={classes.cardHeaders}>Pros &amp; Cons</h3>\r\n                                <ul className=\"\">\r\n                                    {\r\n                                        featureText.saveOnline.features.map( t => \r\n                                            <Li key={t}>{t}</Li>\r\n                                        )\r\n                                    }\r\n                                </ul>\r\n                            </div>\r\n\r\n                            <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={saveTaleOnline}\r\n                            >\r\n                                Save Online\r\n                            </Button>\r\n                        </InfoCard>\r\n                    </Grid>\r\n                    \r\n                    <Grid item xs={12} md={4} className={classes.cardContainer}>\r\n                        <InfoCard>\r\n                            <h2 className={classes.cardHeaders}>Export Reactale</h2>\r\n                            <span className={classes.cardInfo}>{featureText.exportTale.desc}</span>\r\n                            \r\n                            <Box my={1}>\r\n                                <FormControlLabel\r\n                                    control={<Checkbox checked={saveDefault === E_SAVE_TYPES.EXPORT} onChange={() => markSaveDefault(E_SAVE_TYPES.EXPORT)} name=\"EXPORT\" />}\r\n                                    label=\"Set as default\"\r\n                                />\r\n                            </Box>\r\n\r\n                            <div className=\"fillmid\">\r\n                                <h3 className={classes.cardHeaders}>Pros &amp; Cons</h3>\r\n                                <ul className=\"\">\r\n                                    {\r\n                                        featureText.exportTale.features.map( t => \r\n                                            <Li key={t}>{t}</Li>\r\n                                        )\r\n                                    }\r\n                                </ul>\r\n                            </div>\r\n\r\n                            <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={exportWIPTale}\r\n                            >\r\n                                Export\r\n                            </Button>\r\n                        </InfoCard>\r\n                    </Grid>\r\n                </Grid>\r\n            </Container>\r\n            <Box className={clsx(!tale.info.storyUrl && 'hidden', classes.pubSec)}>\r\n                <h2>Publish / Unpublish</h2>\r\n                <p>\r\n                Your story will be visible to others only when you publish it. You can publish / unpublish your story anytime you want after your first online save.\r\n                </p>\r\n                \r\n                <div className={classes.btnContainer}>\r\n                    <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        className=\"\"\r\n                        onClick={togglePublish}\r\n                    >\r\n                        { !tale.isPublished && <>Publish</> }\r\n                        { tale.isPublished && <>Un-publish</> }\r\n                    </Button>\r\n                </div>\r\n                \r\n            </Box>\r\n        </Box>\r\n    )\r\n}\r\nconst mapStateToProps = (state: { wipTale: TReactale }) => ({\r\n    tale: state.wipTale\r\n})\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => ({\r\n    publish: () => dispatch({type: TALE_PUBLISH}),\r\n    unpublish: () => dispatch({type: TALE_UNPUBLISH})\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateTaleFinish)","import React, { useState } from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport clsx from 'clsx'\r\nimport AccountTreeIcon from '@material-ui/icons/AccountTree'\r\nimport InputIcon from '@material-ui/icons/Input'\r\nimport VisibilityIcon from '@material-ui/icons/Visibility'\r\nimport SaveIcon from '@material-ui/icons/Save'\r\nimport MoreHorizIcon from '@material-ui/icons/MoreHoriz'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        position: 'fixed',\r\n        top: 79,\r\n        right: 0,\r\n        zIndex: 9,\r\n        '& ul': {\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            borderTopLeftRadius: 4,\r\n            borderBottomLeftRadius: 4,\r\n            overflow: 'hidden',\r\n            transition: 'all 300ms linear',\r\n            maxHeight: 24,\r\n            opacity: .7,\r\n            '&.visible': {\r\n                maxHeight: 180,\r\n                opacity: .9,\r\n            },\r\n            '& li': {\r\n                color: '#fff',\r\n                background: theme.palette.primary.main,\r\n                borderBottom: '1px solid #fff',\r\n                height: 36,\r\n                width: 36,\r\n                display: 'inline-flex',\r\n                justifyContent: 'center',\r\n                alignItems: 'center'\r\n            }\r\n        },\r\n        \r\n    }\r\n}))\r\n\r\n/**\r\n * This appear as a collapsible floating belt of tools \r\n * at the right of the Create/Edit Page\r\n * @param {*} props \r\n */\r\nconst Toolbelt = props => {\r\n    const classes = useStyles()\r\n    const [isVisible, setVisibility] = useState(false)\r\n\r\n    const { openImportModal, previewTale, doSaveDefault, goToTalesFlow } = props\r\n\r\n    /**\r\n     * Collapse the toolbet after each click\r\n     */\r\n    const handleClick = fn => {\r\n        setVisibility(false)\r\n        fn()\r\n    }\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <ul className={clsx(isVisible && 'visible')}>\r\n                <li title=\"Toggle Toolbelt\" onClick={() => setVisibility(!isVisible)}>\r\n                    <MoreHorizIcon />\r\n                </li>\r\n                <li title=\"Import\" onClick={() => handleClick(openImportModal)}>\r\n                    <InputIcon />\r\n                </li>\r\n                <li title=\"Preview\" onClick={() => handleClick(previewTale)}>\r\n                    <VisibilityIcon />\r\n                </li>\r\n                <li title=\"Save (default)\" onClick={() => handleClick(doSaveDefault)}>\r\n                    <SaveIcon />\r\n                </li>\r\n                <li title=\"TalesFlow\" onClick={() => handleClick(goToTalesFlow)}>\r\n                    <span className=\"talesflowicon\"><AccountTreeIcon /></span>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    )\r\n}\r\n\r\n// const mapStateToProps = state => ({\r\n//     user: state.user\r\n// })\r\n// const mapDispatchToProps = dispatch => ({\r\n//     openSidebar: () => dispatch({ type: UI_SIDEBAR_OPEN }),\r\n//     updateUser: user => dispatch({ type: USER_UPDATE, payload: {user} })\r\n// })\r\n\r\n// export default connect(mapStateToProps, mapDispatchToProps)(Header)\r\nexport default Toolbelt\r\n","import React from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport AccountTreeIcon from '@material-ui/icons/AccountTree'\r\nimport InputIcon from '@material-ui/icons/Input'\r\nimport VisibilityIcon from '@material-ui/icons/Visibility'\r\nimport SaveIcon from '@material-ui/icons/Save'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        marginBottom: 25,\r\n        '& ul': {\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            '& li': {\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                alignItems: 'center',\r\n                width: 70,\r\n                '& svg': {\r\n                    width: 40,\r\n                    height: 40,\r\n                    color: theme.palette.primary.main,\r\n                    boxShadow: '0 0 5px 2px #ababab',\r\n                    borderRadius: 4,\r\n                    marginBottom: 9,\r\n                    padding: 8\r\n                },\r\n                '& .label': {\r\n                    fontSize: 14\r\n                }\r\n            },\r\n            '& li:hover': {\r\n                transform: 'scale(1.1)'\r\n            }\r\n        }\r\n    }\r\n}))\r\n\r\n/**\r\n * This appear as a collapsible floating belt of tools \r\n * at the right of the Create/Edit Page\r\n * @param {*} props \r\n */\r\nconst TopButtons = props => {\r\n    const classes = useStyles()\r\n\r\n    const { openImportModal, previewTale, doSaveDefault, goToTalesFlow } = props\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <ul>\r\n                <li title=\"Import\" onClick={openImportModal}>\r\n                    <InputIcon />\r\n                    <span className=\"label\">Import</span>\r\n                </li>\r\n                <li title=\"Preview\" onClick={previewTale}>\r\n                    <VisibilityIcon />\r\n                    <span className=\"label\">Preview</span>\r\n                </li>\r\n                <li title=\"Save (default)\" onClick={doSaveDefault}>\r\n                    <SaveIcon />\r\n                    <span className=\"label\">Save</span>\r\n                </li>\r\n                <li title=\"TalesFlow\" onClick={goToTalesFlow}>\r\n                    <span className=\"talesflowicon\"><AccountTreeIcon /></span>\r\n                    <span className=\"label\">TalesFlow</span>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    )\r\n}\r\n\r\n// const mapStateToProps = state => ({\r\n//     user: state.user\r\n// })\r\n// const mapDispatchToProps = dispatch => ({\r\n//     openSidebar: () => dispatch({ type: UI_SIDEBAR_OPEN }),\r\n//     updateUser: user => dispatch({ type: USER_UPDATE, payload: {user} })\r\n// })\r\n\r\n// export default connect(mapStateToProps, mapDispatchToProps)(Header)\r\nexport default TopButtons\r\n","import { TUserPrefs } from '../types'\r\nimport { ajaxPost } from '../utils/ajax'\r\nimport { UPDATE_MYPREFERENCES } from '../utils/urls'\r\n\r\nexport const updateUserPrefs = async (email: string, partialPrefs: TUserPrefs) => \r\n    ajaxPost(UPDATE_MYPREFERENCES, { email, partialPrefs } )\r\n","import { LOGIN, SIGNUP } from '../../utils/urls'\r\nimport { USER_UPDATE, USER_PREFS_UPDATE, UI_LOGIN_MODAL_CLOSE } from '../actionTypes'\r\nimport _ from 'lodash'\r\n// import axios from 'axios'\r\nimport { ajaxPost } from '../../utils/ajax'\r\n// import { saveVar } from '../../utils/varStore'\r\nimport { setToSession } from '../../services/session.service'\r\nimport { updateUserPrefs } from '../../services/user.service'\r\nimport { CONST_SESSION_USER } from '../../utils/constants'\r\nimport { TUser, TUserPrefs, TWindow } from '../../types'\r\nimport { Dispatch } from 'react'\r\nconst { notify, showLoader, hideLoader } = window as TWindow\r\n\r\nexport const actionLogin = (user: TUser) => {\r\n    const { email, pswd } = user\r\n    showLoader()\r\n    return (dispatch: Dispatch<any>) => {\r\n        ajaxPost(LOGIN, { email, pswd })\r\n            .then(res => {\r\n                const { status, user, tok, msg } = res.data\r\n                if (status === 200) {\r\n                    setToSession(CONST_SESSION_USER, { user, tok })\r\n\r\n                    // update the user in redux store\r\n                    dispatch({\r\n                        type: USER_UPDATE,\r\n                        payload: { user }\r\n                    })\r\n\r\n                    // Close the popup\r\n                    dispatch({ type: UI_LOGIN_MODAL_CLOSE })\r\n\r\n                    notify(msg)\r\n                }\r\n                else {\r\n                    notify(msg)\r\n                }\r\n            })\r\n            .catch(err => {\r\n                console.log(err)\r\n                notify('Sign in failed...')\r\n            })\r\n            .finally(() => hideLoader())\r\n    }\r\n}\r\n\r\nexport const actionSignup = (user: TUser) => {\r\n    const { email, pswd, firstname, lastname } = user\r\n    showLoader()\r\n    return (dispatch: Dispatch<any>) => {\r\n        ajaxPost(SIGNUP, { email, pswd, firstname, lastname })\r\n            .then(res => {\r\n                const { status, msg } = res.data\r\n                notify(msg)\r\n            })\r\n            .catch(err => {\r\n                console.log(err)\r\n                notify('Sign up failed...')\r\n            })\r\n            .finally(() => hideLoader())\r\n    }\r\n}\r\n\r\n\r\nexport const actionUpdateUserPrefs = (partialPrefs: TUserPrefs) => {\r\n    return (dispatch: Dispatch<any>, getState: Function) => {\r\n\r\n        const email: string = getState().user.email\r\n\r\n        // if loggedIn, then save in DB\r\n        if(email) saveUserPref(email, partialPrefs)\r\n\r\n        // update the redux store, otherwise FE won't reflect\r\n        dispatch({\r\n            type: USER_PREFS_UPDATE,\r\n            payload: partialPrefs\r\n        })\r\n    }\r\n}\r\n\r\n/**\r\n * Save in DB, after debounce, incase someone keeps on checking/unchecking checkbox like a maniac :P\r\n */\r\nconst saveUserPref = _.debounce((email: string, prefs: TUserPrefs) => {\r\n    updateUserPrefs(email, prefs)\r\n}, 5000)","import { TWindow, TReactale, TUser, TUserPrefs } from '../../../types'\r\n\r\nimport React, { Dispatch, useState } from 'react'\r\nimport { RouteComponentProps } from 'react-router-dom'\r\nimport _ from 'lodash'\r\nimport { Paper, Tabs, Tab, Box, Typography } from '@material-ui/core'\r\nimport ReactoModal from '../../common/reactos/ReactoModal'\r\nimport ExportTaleModal from './ExportTaleModal'\r\nimport { ajaxPost } from '../../../utils/ajax'\r\nimport { ImportTaleModal, CreateTaleIntro, CreateTaleBody, CreateTaleFinish, Toolbelt, TopButtons} from '.'\r\nimport { connect } from 'react-redux'\r\nimport { actionSetTaleAsWIP } from '../../../redux/actionCreators/createTaleActions'\r\nimport { actionUpdateUserPrefs } from '../../../redux/actionCreators/userActions'\r\nimport { LOCAL_TALE_IDENTIFIER } from '../../../utils/constants' \r\nimport { CREATE_TALE } from \"../../../utils/urls\"\r\nimport { downloadAsFile } from \"../../../utils/util\"\r\nimport { saveOneOfflineSavedTales } from '../../../services/offlinesavedtales.service'\r\n\r\nimport { E_SAVE_TYPES } from '../../../types/enums'\r\n\r\nconst { notify, LZString, showLoader, hideLoader } = window as TWindow\r\n\r\ntype Props = RouteComponentProps & {\r\n    pageTitle: string\r\n    isLocalEdit: boolean\r\n    setTaleAsWIP: (tale: TReactale) => Dispatch<any>\r\n    updateUserPrefs: (partialPrefs: TUserPrefs) => Dispatch<any>\r\n    _wipTale: TReactale\r\n    _authorEmail: string,\r\n    _userPrefs: TUserPrefs\r\n}\r\n\r\nconst CreateEditCommon: React.FC<Props> = (props: Props) => {\r\n\r\n    const { pageTitle, isLocalEdit, setTaleAsWIP, history, _wipTale, _authorEmail, _userPrefs, updateUserPrefs } = props\r\n\r\n    const [visibleTabIndex, setVisibleTab] = useState(0)\r\n    const [isImportModalOpen, setIsImportModalOpen] = useState(false)\r\n    const [expTale, setExpTale] = useState('')\r\n    const [isExpTaleModalVisible, setExpTModalVis] = useState(false)\r\n    // const [saveDefault, setSaveDefault] = useState(E_SAVE_TYPES.OFFLINE)   // 'OFFLINE' / 'ONLINE' / 'EXPORT'\r\n\r\n    const markSaveDefault = (saveType = E_SAVE_TYPES.OFFLINE) => updateUserPrefs({defaultSave: saveType})\r\n\r\n    const handleTabSwitch = (e: React.ChangeEvent<any>, newValue: number | any) => {\r\n        setVisibleTab(newValue)\r\n    }\r\n\r\n    const goTo = (url: string) => history.push(url)\r\n\r\n    const setImportedTaleForEditing = (tale: TReactale) => {\r\n        setTaleAsWIP(tale)\r\n        setIsImportModalOpen(false)\r\n    }\r\n\r\n    const getWIPTale = () => {\r\n        const { storyboard, ...tale } = _wipTale\r\n        return tale\r\n    }\r\n\r\n    const exportWIPTale = () => {\r\n        if(!areFieldsValid()) return\r\n\r\n        const tale = getWIPTale()\r\n        // console.log(tale)\r\n        // const content = btoa(encodeURIComponent(JSON.stringify(tale)))\r\n        const content = LZString.compressToEncodedURIComponent(JSON.stringify(tale))\r\n        downloadAsFile(`${tale.info.name.replace(/\\s+/g, '-')}-${tale.id}.rtl`, content)\r\n        setExpTale(content)\r\n        setExpTModalVis(true)\r\n    }\r\n\r\n    const saveTaleLocal = (e?: Event | null, rtl?: TReactale) => {\r\n        if(!areFieldsValid()) return false\r\n        const tale = rtl || getWIPTale()\r\n        saveOneOfflineSavedTales(tale)\r\n        // notify(\"Saved succesfully. \" + getLocalStorageSpace())\r\n        notify('Successfully saved in device memory')\r\n        return true\r\n    }\r\n\r\n    const saveTaleOnline = async () => {\r\n        if(!areFieldsValid()) return\r\n\r\n        if(!_authorEmail) {\r\n            notify(\"Please login to save online...\")\r\n            return\r\n        }\r\n\r\n        let tale = getWIPTale()\r\n        // console.log(\"WIP Tale = \", tale)\r\n        tale.info.authorEmail = _authorEmail\r\n\r\n        // This variable controls whether a redirection is required to /edit-tale/\r\n        // because of creating new unique storyUrl\r\n        // may be because local / offline tales are being saved for the 1st time\r\n        let needsRedirection = false\r\n        // console.log(tale)\r\n\r\n        // If StoryUrl has never been set\r\n        if (!tale.info.storyUrl) {\r\n            // let res = await ajaxPost(CREATE_STORYURL, {storyUrl: tale.info.desiredUrl || ''})\r\n            \r\n            // tale.info.storyUrl = res.data.suggestedUrl\r\n            needsRedirection = true\r\n        }\r\n\r\n        showLoader()\r\n        ajaxPost(CREATE_TALE, tale)\r\n        .then(res => {\r\n            // console.log(res.data)\r\n            let { status, submittedTale, msg } = res.data\r\n            if(status === 200) {\r\n                notify('Tale saved online successfully...')\r\n                // tale = JSON.parse(tale)\r\n                console.log('Setting as WIP', submittedTale)\r\n                submittedTale.info.tags = submittedTale.info.tags.join(', ')\r\n                setTaleAsWIP(submittedTale)\r\n\r\n                // IF online save started from editing a local saved tale\r\n                // Then update that local tale too, for sync\r\n                console.log('isLocalEdit = ', isLocalEdit)\r\n                \r\n                if(isLocalEdit) {\r\n                    console.log('Also saving in local tale =', submittedTale)\r\n                    saveTaleLocal(null, submittedTale)\r\n                }\r\n                if (needsRedirection) {\r\n                    history.push(`/edit-tale/${submittedTale.info.storyUrl}`)\r\n                }\r\n            }\r\n            else {\r\n                console.log(\"most probably some error occurred\")\r\n                notify(msg)\r\n            }\r\n        })\r\n        .catch(err =>{\r\n            console.log(err)\r\n        })\r\n        .finally(() => hideLoader())\r\n    }\r\n\r\n    /**\r\n     * Dynamic Save Shortchut which will\r\n     * either online/offline/export depending on \r\n     * user's preferred selected value\r\n     */\r\n    const doSaveDefault = () => {\r\n        if(_userPrefs.defaultSave === E_SAVE_TYPES.OFFLINE) {\r\n            saveTaleLocal()\r\n        }\r\n        else if (_userPrefs.defaultSave === E_SAVE_TYPES.ONLINE) {\r\n            saveTaleOnline()\r\n        }\r\n        else if(_userPrefs.defaultSave === E_SAVE_TYPES.EXPORT) {\r\n            exportWIPTale()\r\n        }\r\n    }\r\n\r\n    /**\r\n     * If user wants to see the full tale while edting\r\n     * he can click on preview button\r\n     * We will save it in local and use it for the preview\r\n     */\r\n    const previewTale = () => {\r\n        if(!saveTaleLocal()) return\r\n        const tale = getWIPTale()\r\n        goTo(`/preview/${LOCAL_TALE_IDENTIFIER}${tale.id}`)\r\n    }\r\n\r\n    /**\r\n     * It will check throught all the field validation\r\n     * And show message + return boolean depending on it\r\n     */\r\n    const areFieldsValid = (rtl?: TReactale) => {\r\n        const tale = rtl || getWIPTale()\r\n        const { name, description, genre, lang, tags } = tale.info\r\n\r\n        if(!name || !description || !genre || !lang || !tags) {\r\n            notify('Fill all the mandatory fields viz. name, description, genre, language, tags')\r\n            return false\r\n        }\r\n        return true\r\n    }\r\n\r\n    \r\n    return (\r\n        <Box py={2}>\r\n            \r\n            <Typography variant=\"h4\" component=\"h1\">\r\n                {pageTitle} Reactale\r\n            </Typography>\r\n            \r\n            <Box mt={2} mb={2} className=\"flex-space-between\">\r\n                <Typography variant=\"subtitle1\">\r\n                    {pageTitle} a Reactale or import one (using the right hand menu) to edit it.\r\n                </Typography>\r\n            </Box>\r\n\r\n            {/* The Floating Toolbelt on Right */}\r\n            <Toolbelt \r\n                openImportModal={() => setIsImportModalOpen(true)}\r\n                previewTale={previewTale}\r\n                doSaveDefault={doSaveDefault}\r\n                goToTalesFlow={() => goTo('/tales-flow')}\r\n            />\r\n\r\n            {/* The Fixed TopButtons */}\r\n            <TopButtons \r\n                openImportModal={() => setIsImportModalOpen(true)}\r\n                previewTale={previewTale}\r\n                doSaveDefault={doSaveDefault}\r\n                goToTalesFlow={() => goTo('/tales-flow')}\r\n            />\r\n\r\n            <Paper square>\r\n                <Tabs\r\n                    value={visibleTabIndex}\r\n                    indicatorColor=\"primary\"\r\n                    textColor=\"primary\"\r\n                    onChange={handleTabSwitch}\r\n                    centered\r\n                    aria-label=\"tabs to create the story\"\r\n                >\r\n                    <Tab label=\"Intro\" />\r\n                    <Tab label=\"Body\" />\r\n                    <Tab label=\"Finish\" />\r\n                </Tabs>\r\n            </Paper>\r\n            \r\n            <Box className={visibleTabIndex !== 0 ? 'hide' : ''}>\r\n                <CreateTaleIntro />\r\n            </Box>\r\n\r\n            <Box className={visibleTabIndex !== 1 ? 'hide' : ''}>\r\n                <CreateTaleBody />\r\n            </Box>\r\n\r\n            <Box className={visibleTabIndex !== 2 ? 'hide' : ''}>\r\n                <CreateTaleFinish \r\n                    exportWIPTale={exportWIPTale}\r\n                    saveTaleOnline={saveTaleOnline}\r\n                    saveTaleLocal={saveTaleLocal}\r\n                    // expTale={expTale}\r\n                    // isExpTaleModalVisible={isExpTaleModalVisible}\r\n                    // setExpTModalVis={setExpTModalVis}\r\n                    markSaveDefault={markSaveDefault}\r\n                    saveDefault={_userPrefs.defaultSave || E_SAVE_TYPES.OFFLINE}\r\n                />\r\n            </Box>\r\n\r\n            {/* Import Tale Modal */}\r\n            <ImportTaleModal \r\n                isOpen={isImportModalOpen} \r\n                handleClose = {() => setIsImportModalOpen(false)}\r\n                setForEditing = {setImportedTaleForEditing}\r\n            />\r\n\r\n            {/* Export Tale Modal */}\r\n            <ExportTaleModal \r\n                isOpen = {isExpTaleModalVisible}\r\n                handleClose = {() => setExpTModalVis(false)}\r\n                expTaleContent = {expTale}\r\n            />\r\n\r\n            <ReactoModal />\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = (state: {wipTale: TReactale, user: TUser }) => ({\r\n    _wipTale: state.wipTale,\r\n    _authorEmail: state.user.email,\r\n    _userPrefs: state.user.prefs\r\n})\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => ({\r\n    setTaleAsWIP: (tale: TReactale) => dispatch(actionSetTaleAsWIP(tale)),\r\n    updateUserPrefs: (partialPrefs: TUserPrefs) => dispatch(actionUpdateUserPrefs(partialPrefs))\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateEditCommon as any)","import React, { useEffect } from 'react'\r\nimport CreateEditCommon from '../createEditCommon/CreateEditCommon'\r\nimport { connect } from 'react-redux'\r\nimport {\r\n    actionCreateNewTale\r\n} from '../../../redux/actionCreators/createTaleActions'\r\nimport { CONST_TITLE } from '../../../utils/constants'\r\n\r\n\r\nconst CreateTale = props => {\r\n    const { createNewTale, history, _id } = props\r\n\r\n    useEffect(() => {\r\n        // console.log(\"Inside CreateTale useEffect...\")\r\n\r\n        document.title = 'Create Tale | ' + CONST_TITLE\r\n\r\n        // this !_id checking is mandatory, otherwise if user tries to go from\r\n        // from create tale to create tale, then storylets will be blank\r\n        if (!_id) { \r\n            createNewTale()\r\n        }\r\n\r\n        window.hideLoader()\r\n\r\n        return (() => {\r\n            console.log(\"Leaving Story Create Page... Now is a good time to save changes so far...\")\r\n        })\r\n    }, [createNewTale, _id])\r\n\r\n\r\n    return (\r\n        <CreateEditCommon \r\n            pageTitle = \"Create\"\r\n            history = {history}\r\n        />\r\n    )\r\n}\r\nconst mapStateToProps = state => ({\r\n    _id: state.wipTale.id\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    createNewTale: () => dispatch(actionCreateNewTale())\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateTale)","import React, { useState, useEffect } from 'react'\r\nimport CreateEditCommon from '../createEditCommon/CreateEditCommon'\r\nimport { connect } from 'react-redux'\r\nimport { actionSetTaleAsWIP } from '../../../redux/actionCreators/createTaleActions'\r\nimport { LOCAL_TALE_IDENTIFIER, CONST_TITLE } from '../../../utils/constants' \r\nimport { getOneOfflineSavedTales } from '../../../services/offlinesavedtales.service'\r\nimport {  GET_MYSTORY } from \"../../../utils/urls\"\r\nimport { ajaxGetWPathParams } from '../../../utils/ajax'\r\nconst notify = window['notify']\r\n\r\nconst EditTale = props => {\r\n    const [isLocalEdit, setIsLocalEdit] = useState(false)\r\n\r\n    const { setTaleAsWIP, _storyUrl, match, history } = props\r\n\r\n    useEffect(() => {\r\n        // update title\r\n        document.title = 'Edit Tale | ' + CONST_TITLE\r\n\r\n        let storyUrl = match.params.id\r\n        \r\n        if (storyUrl === 'current') {\r\n            //do nothing\r\n            window.hideLoader()\r\n        }\r\n        // If it is a local story\r\n        // Then the ID should start with \"local\"\r\n        else if (storyUrl.indexOf(LOCAL_TALE_IDENTIFIER) >= 0) {\r\n            setIsLocalEdit(true)\r\n            storyUrl = storyUrl.trim().replace(LOCAL_TALE_IDENTIFIER, \"\")\r\n            const theTale = getOneOfflineSavedTales(storyUrl)\r\n            // console.log('calling setTaleWIP, offline tale = ', theTale)\r\n            setTaleAsWIP(theTale)\r\n            window.hideLoader()\r\n        }\r\n\r\n        // Else fetch it online\r\n        else {\r\n            // If we already have the data, no need to call BE\r\n            if(_storyUrl === storyUrl) {\r\n                return window.hideLoader()\r\n            }\r\n\r\n            // else call BE\r\n            window.showLoader()\r\n            ajaxGetWPathParams(GET_MYSTORY, [storyUrl])\r\n            .then(res => {\r\n                console.log(res.data)\r\n                let {status, tale, msg} = res.data\r\n                if(status === 200) {\r\n                    // let tale = wrapperTale.tale\r\n                    // tale = JSON.parse(tale)\r\n                    // tale.isPublished = (wrapperTale.isPublished == 1) ? 1 : 0\r\n                    console.log('calling setTaleAsWIP online tale', tale)\r\n                    setTaleAsWIP(tale)\r\n                }\r\n                else {\r\n                    // console.log(\"most probably some error occurred\")\r\n                    notify(msg)\r\n                }\r\n            })\r\n            .catch(err =>{\r\n                console.log(err)\r\n            })\r\n            .finally(() => window.hideLoader())\r\n        }\r\n        \r\n\r\n        return (() => {\r\n            console.log(\"Leaving Story Edit Page... Now is a good time to save changes so far...\")\r\n        })\r\n    }, [setTaleAsWIP, _storyUrl, match])\r\n\r\n\r\n    return (\r\n        <CreateEditCommon \r\n            pageTitle = \"Edit\"\r\n            isLocalEdit={isLocalEdit}\r\n            history = {history}\r\n        />\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    _storyUrl: state.wipTale.info.storyUrl\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    setTaleAsWIP: tale => dispatch(actionSetTaleAsWIP(tale))\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditTale)\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Box from '@material-ui/core/Box'\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\r\nimport ZoomOutMapIcon from '@material-ui/icons/ZoomOutMap'\r\nimport AddBoxIcon from '@material-ui/icons/AddBox'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\nimport SaveIcon from '@material-ui/icons/Save'\r\nimport OpenWithIcon from '@material-ui/icons/OpenWith';\r\nimport { red } from '@material-ui/core/colors'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faEye, faMagic, faMousePointer, faPencilAlt } from '@fortawesome/free-solid-svg-icons'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    panel: {\r\n        width: 40,\r\n        backgroundImage: `linear-gradient(${theme.palette.primary.main}, ${theme.palette.primary.dark})`,\r\n        position: 'absolute',\r\n        left: 0,\r\n        top: 50,\r\n        height: \"calc(100vh - 60px)\",\r\n        overflow: \"auto\"\r\n    },\r\n    btnPane: {\r\n        color: '#fff',\r\n        padding: `${theme.spacing(2)}px 0`,\r\n        '& li': {\r\n            height: 44,\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            alignItems: 'center'\r\n        },\r\n        '& li+li': {\r\n            borderTop: '1px solid #fff'\r\n        },\r\n        '& li:active': {\r\n            backgroundColor: red.A400\r\n        },\r\n        '& li svg': {\r\n            fontSize: 27\r\n        }\r\n    },\r\n    fa: {\r\n        fontSize: '22px !important'\r\n    },\r\n    autoMagic: {\r\n        transform: 'rotate(-90deg)'\r\n    },\r\n    toggleJStick: {\r\n        // transform: 'rotate(45deg)',\r\n        // fontSize: '26px !important' \r\n    }\r\n}))\r\n\r\nconst ControlPanel = props => {\r\n    const classes = useStyles()\r\n    const { history, deleteComponent, paintFlowboard, toggleJStick, openFSE, \r\n        openCreateComponent } = props\r\n    // const backToEdit = () => history.push('/edit-tale/current')\r\n    const goTo = url => history.push(url)\r\n\r\n    return (\r\n        <Box className={classes.panel}>\r\n            <ul className={classes.btnPane}>\r\n                <li title=\"Back to Editor\" onClick={() => goTo('/edit-tale/current')}><ArrowBackIcon /></li>\r\n                <li title=\"Add component\" onClick={openCreateComponent}><AddBoxIcon /></li>\r\n                {/* <li title=\"Select component\"><FontAwesomeIcon icon={faMousePointer} className={classes.fa} /></li> */}\r\n                <li title=\"Edit component\" onClick={openFSE}><FontAwesomeIcon icon={faPencilAlt} className={classes.fa} /></li>\r\n                <li title=\"View component\" onClick={e => openFSE(e, \"PREVIEW\")}><FontAwesomeIcon icon={faEye} className={classes.fa} /></li>\r\n                {/* <li title=\"Save all\"><SaveIcon /></li> */}\r\n                <li title=\"Toggle joystick\" onClick={toggleJStick}><OpenWithIcon className={classes.toggleJStick} /></li>\r\n               \r\n                <li title=\"Auto format\" onClick={paintFlowboard}><FontAwesomeIcon icon={faMagic} className={clsx(classes.fa, classes.autoMagic)} /></li>\r\n                <li title=\"Increase draw area\"><ZoomOutMapIcon /></li>\r\n                <li title=\"Delete selected\" onClick={deleteComponent}><DeleteIcon /></li>\r\n            </ul>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default ControlPanel","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Left from '@material-ui/icons/KeyboardArrowLeft'\r\nimport Right from '@material-ui/icons/KeyboardArrowRight'\r\nimport Up from '@material-ui/icons/KeyboardArrowUp'\r\nimport Down from '@material-ui/icons/KeyboardArrowDown'\r\nimport { red } from '@material-ui/core/colors'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    container: {\r\n        position: \"absolute\"\r\n    },\r\n    btn: {\r\n        position: \"absolute\",\r\n        fontSize: 30,\r\n        backgroundColor: red[100],\r\n        borderRadius: 6,\r\n        '&:active': {\r\n            backgroundColor: red[300]\r\n        }\r\n    },\r\n    left: {\r\n        left: 0,\r\n        top: 0\r\n    },\r\n    right: {\r\n        left: 60,\r\n        top: 0\r\n    },\r\n    up: {\r\n        left: 30,\r\n        top: -30\r\n    },\r\n    down: {\r\n        left: 30,\r\n        top: 30\r\n    }\r\n}))\r\n\r\nconst JoyStick = props => {\r\n    const classes = useStyles()\r\n    const { moveLeft, moveRight, moveUp, moveDown } = props\r\n    return (\r\n        <div className={classes.container}>\r\n            <Left className={clsx(classes.btn, classes.left)} onClick={moveLeft} />\r\n            <Right className={clsx(classes.btn, classes.right)} onClick={moveRight} />\r\n            <Up className={clsx(classes.btn, classes.up)} onClick={moveUp} />\r\n            <Down className={clsx(classes.btn, classes.down)} onClick={moveDown} />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default JoyStick","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport { \r\n    FLOW_ST_WIDTH, \r\n    FLOW_ST_HEIGHT,\r\n    FLOW_KNOW_RAD,\r\n    FLOW_KNOT_IN_X,\r\n    FLOW_KNOT_IN_Y,\r\n    FLOW_KNOT_OUT_X,\r\n    FLOW_KNOT_OUT_Y\r\n} from '../../../utils/constants'\r\nimport { red } from '@material-ui/core/colors'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    cg: {\r\n        transform: \"translate(100px, 100px)\"\r\n    },\r\n    knot: {\r\n        fill: red[500],\r\n        strokeWidth: 1,\r\n        stroke: red[500]\r\n    },\r\n    selectedKnot: {\r\n        // fill: '#000',\r\n        strokeWidth: 3,\r\n        stroke: '#000'\r\n    },\r\n    selectedEl: {\r\n        stroke: '#00f'\r\n    },\r\n    rect: {\r\n        fill: \"#fff\",\r\n        strokeWidth: 1,\r\n        stroke: theme.palette.primary.main\r\n    },\r\n    selectedST: {\r\n        '& rect': {\r\n            fill: red[500],\r\n            stroke: red[500]\r\n        },\r\n        '& text': {\r\n            fill: '#fff'\r\n        }\r\n    },\r\n    title: {\r\n        fontSize: 14\r\n    },\r\n    stid: {\r\n        fontSize: 14,\r\n        fill: \"#000\"\r\n    }\r\n}))\r\n\r\nconst FlowST = props => {\r\n    const classes = useStyles()\r\n    const { stid, title, transformStyle, start, selectedObj, handleSelection, handleMouseDown, handleMouseUp, handleMouseMove } = props\r\n    const markSelected = (e, type) => {\r\n        e.stopPropagation()\r\n        handleSelection(stid, type)\r\n    }\r\n    return (\r\n        <g \r\n            id={stid} \r\n            className={classes.cg} \r\n            style={transformStyle}\r\n            onMouseDown={e => handleMouseDown(e, stid)}\r\n            onMouseUp={e => handleMouseUp(e)}\r\n            onMouseMove={e => handleMouseMove(e)}\r\n        >\r\n\r\n            {(stid === start) && <text x=\"55\" y=\"-3\" fill=\"blue\">START</text>}\r\n            \r\n            {(stid !== start) \r\n                && \r\n                <circle \r\n                    className={clsx(classes.knot, ((selectedObj.id===stid && 'IN'===selectedObj.type) && classes.selectedKnot))} \r\n                    cx={FLOW_KNOT_IN_X} \r\n                    cy={FLOW_KNOT_IN_Y} \r\n                    r={FLOW_KNOW_RAD}\r\n                    onClick={e => markSelected(e, 'IN')}\r\n                >\r\n                </circle>}\r\n            \r\n            <circle \r\n                className={clsx(classes.knot, ((selectedObj.id===stid && 'OUT'===selectedObj.type) && classes.selectedKnot))} \r\n                cx={FLOW_KNOT_OUT_X} \r\n                cy={FLOW_KNOT_OUT_Y} \r\n                r={FLOW_KNOW_RAD}\r\n                onClick={e => markSelected(e, 'OUT')}\r\n            >\r\n            </circle>\r\n            \r\n            <g className={clsx((selectedObj.id===stid && 'ST'===selectedObj.type) && classes.selectedST)} onClick={e => markSelected(e, 'ST')}>\r\n                <rect \r\n                    className={classes.rect}\r\n                    width={FLOW_ST_WIDTH} \r\n                    height={FLOW_ST_HEIGHT}>\r\n                </rect>\r\n\r\n                <text x=\"5\" y=\"15\" className={classes.title}>{title.substr(0, 20) || 'Click Edit to add text'}</text>\r\n                <text x=\"5\" y=\"30\" className={classes.title}>{title.substr(20, 20)}</text>\r\n                {/* <text x=\"5\" y=\"32\" class=\"title el\">{st.title.substr(44, 22)}</text> */}\r\n\r\n                <text x=\"5\" y=\"45\" className={classes.stid}>{stid}</text>\r\n            </g>\r\n        </g>\r\n    )\r\n}\r\n\r\nexport default FlowST","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport { red } from '@material-ui/core/colors'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    connector: {\r\n        strokeWidth: 4,\r\n        stroke: red[200]\r\n    },\r\n    cid: {\r\n        fontSize: 16,\r\n        fontWeight: 'bold',\r\n        fill: red[500]\r\n    },\r\n    selectedConnector: {\r\n        '& line': {\r\n            stroke: red[900]\r\n        },\r\n        '& text': {\r\n            fill: '#000'\r\n        }\r\n    }\r\n}))\r\n\r\nconst FlowConnector = props => {\r\n    const classes = useStyles()\r\n    const { c, selectedObj, handleSelection } = props\r\n    const markSelected = e => {\r\n        e.stopPropagation()\r\n        handleSelection(c.cid, 'CH')\r\n    }\r\n    return (\r\n        <g \r\n            className={clsx((c.cid === selectedObj.id && 'CH' === selectedObj.type) && classes.selectedConnector)}\r\n            onClick={markSelected}\r\n        >\r\n            \r\n            <line \r\n            id={c.id}\r\n            x1={c.x1} y1={c.y1} \r\n            x2={c.x2} y2={c.y2}\r\n            className={classes.connector}>\r\n            </line>\r\n\r\n            <text className={classes.cid} \r\n            x={(c.x1 + c.x2) / 2} \r\n            y={(c.y1 + c.y2) / 2}>\r\n                {c.cid}\r\n            </text>\r\n        </g>\r\n    )\r\n}\r\n\r\nexport default FlowConnector","/**\r\n * When user clicks on a \"From Node\" and then a \"To Node\",\r\n * Then this modal opens, and lets user create (or edit if exists already)\r\n * a connector(choice) between fromNode to toNode\r\n */\r\nimport React, { useState, useEffect } from 'react'\r\nimport { makeStyles, TextField, Box, Grid, Button } from '@material-ui/core'\r\nimport SimpleModal from '../../common/modal/SimpleModal'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    modelST: {\r\n        height: 70,\r\n        border: `2px solid ${theme.palette.primary.main}`,\r\n        padding: theme.spacing(1),\r\n        textAlign: \"center\",\r\n        fontSize: 14,\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        justifyContent: 'center',\r\n        borderRadius: 4\r\n    },\r\n    modelCon: {\r\n        height: 50,\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        justifyContent: 'center',\r\n        textAlign: 'center',\r\n        '& .con': {\r\n            height: 1,\r\n            borderTop: `2px dashed ${theme.palette.primary.main}`\r\n        }\r\n    },\r\n    btnPanel: {\r\n        display: 'flex',\r\n        marginTop: theme.spacing(2),\r\n        '& button': {\r\n            flex: 1\r\n        },\r\n        '& button+button': {\r\n            marginLeft: theme.spacing(2)\r\n        }\r\n    }\r\n}))\r\n\r\nexport const ModalEditChoice = props => {\r\n    const classes = useStyles()\r\n    const { fromStID, toStID, type, text, handleSave, handleClose } = props\r\n    // console.log(props)\r\n    const [txt, setTxt] = useState('')\r\n    useEffect(() => setTxt(text), [text])\r\n    const title = type + \" Choice\"\r\n    return (\r\n        <SimpleModal\r\n            {...props}\r\n            title={title}\r\n        >\r\n            <Box mb={3} mt={1}>\r\n                <Grid container>\r\n                    <Grid item xs>\r\n                        <div className={classes.modelST}>Storylet {fromStID}</div>\r\n                    </Grid>\r\n                    <Grid item xs className={classes.modelCon}>\r\n                        <span>to</span>\r\n                        <div className=\"con\"></div>\r\n                    </Grid>\r\n                    <Grid item xs>\r\n                        <div className={classes.modelST}>Storylet {toStID}</div>\r\n                    </Grid>\r\n                </Grid>\r\n            </Box>\r\n            {/* <Box mt={1} mb={2}>\r\n                {t} (connector) from storylet {fromStID} to storylet {toStID}\r\n            </Box> */}\r\n            <TextField label=\"Choice Text\" \r\n                value={txt} onChange={e => setTxt(e.target.value)}\r\n                variant=\"outlined\" fullWidth \r\n            />\r\n\r\n            <Box className={classes.btnPanel}>\r\n                <Button variant=\"outlined\" color=\"primary\" \r\n                    onClick={handleClose}\r\n                >\r\n                    Cancel\r\n                </Button>\r\n\r\n                <Button variant=\"contained\" color=\"primary\" \r\n                    onClick={() => handleSave(fromStID, toStID, txt, type)}\r\n                >\r\n                    Done\r\n                </Button>\r\n            </Box>\r\n\r\n        </SimpleModal>\r\n    )\r\n}\r\n\r\nexport default ModalEditChoice","/**\r\n * When user clicks on the create (+) button on the left panel\r\n * of TalesFlow, this modal will appear enabling user to create \r\n * either a Storylet(rectangle) or a Choice(connector)\r\n */\r\nimport React, { useState, useEffect } from 'react'\r\nimport { makeStyles, Box, Button, FormControl, InputLabel, Select, MenuItem } from '@material-ui/core'\r\nimport SimpleModal from '../../../common/modal/SimpleModal'\r\nconst notify = window.notify\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    btnPanel: {\r\n        display: 'flex',\r\n        marginTop: theme.spacing(2),\r\n        '& button': {\r\n            flex: 1\r\n        },\r\n        '& button+button': {\r\n            marginLeft: theme.spacing(2)\r\n        }\r\n    }\r\n}))\r\n\r\nconst initData = {\r\n    compType: '',    // S or C for Storylet or Connector\r\n    fromSTID: '',\r\n    toSTID: ''\r\n}\r\n\r\nexport const ModalCreateComponent = props => {\r\n    const classes = useStyles()\r\n    const { handleClose, storylets, isOpen, openEditChoiceModal, createNewChoice } = props\r\n    const [data, setData] = useState(initData)  // data for creating New Component\r\n\r\n    useEffect(() => {\r\n        // Reset the data after every open/close\r\n        setData(initData)\r\n    },\r\n        [isOpen])\r\n\r\n    const handleChange = e => {\r\n        const { name, value } = e.target\r\n        setData({\r\n            ...data,\r\n            [name]: value\r\n        })\r\n    }\r\n\r\n\r\n    /**\r\n     * When the full form is filled, user will click \r\n     * on the create button to create the New Component\r\n     * @param {Event} e \r\n     */\r\n    const handleCreate = e => {\r\n        // Check all fields are filled\r\n        if(!data.compType || !data.fromSTID || \r\n            ((data.compType === 'CH') && !data.toSTID)\r\n        ) {\r\n            notify(\"Please fill all the fields ...\")\r\n            return\r\n        }\r\n\r\n        // If user wants to create a Choice\r\n        if(data.compType === 'CH') {\r\n            if(data.fromSTID === data.toSTID) {\r\n                notify(\"FROM storylet and TO storylet cannot be same ...\")\r\n                return\r\n            }\r\n\r\n            // If everything is fine\r\n            // close this modal and open the\r\n            // create-edit-chocie-modal\r\n            handleClose()\r\n            openEditChoiceModal(data.fromSTID, data.toSTID)\r\n            return\r\n        }\r\n\r\n        // If user wants to create a new Storylet\r\n        else if (data.compType === 'ST') {\r\n            // Interesting thing is -\r\n            // WE NEVER CREATE A STORYLET ON ITS OWN\r\n            // we create a connector from an existing storylet\r\n            // and it automatically creates a NEW storylet at its other end\r\n            createNewChoice(data.fromSTID)\r\n            handleClose()\r\n        }\r\n    }\r\n\r\n    return (\r\n        <SimpleModal\r\n            {...props}\r\n            title=\"Create a Component\"\r\n        >\r\n            <Box mb={3} mt={1}>\r\n                {/* Select Storylet or Choice */}\r\n                <FormControl variant=\"outlined\" className=\"flex\">\r\n                    <InputLabel id=\"select-comp-type\">Select type</InputLabel>\r\n                    <Select\r\n                        labelId=\"select-comp-type\"\r\n                        value={data.compType}\r\n                        onChange={handleChange}\r\n                        label=\"Component Type\"\r\n                        name=\"compType\"\r\n                        fullWidth\r\n                        size=\"small\"\r\n                    >\r\n                        <MenuItem value=\"\">\r\n                            <em>None</em>\r\n                        </MenuItem>\r\n                        <MenuItem value=\"ST\">Storylet</MenuItem>\r\n                        <MenuItem value=\"CH\">Choice</MenuItem>\r\n                    </Select>\r\n                </FormControl>\r\n\r\n                {/* FROM STORYLET */}\r\n                <FormControl variant=\"outlined\" className=\"flex mt-15\">\r\n                    <InputLabel id=\"select-from-storylet\">From storylet</InputLabel>\r\n                    <Select\r\n                        labelId=\"select-from-storylet\"\r\n                        value={data.fromSTID}\r\n                        onChange={handleChange}\r\n                        label=\"From storylet\"\r\n                        name=\"fromSTID\"\r\n                        fullWidth\r\n                        size=\"small\"\r\n                    >\r\n                        <MenuItem value=\"\">\r\n                            <em>None</em>\r\n                        </MenuItem>\r\n                        {\r\n                            Object.values(storylets).map(st =>\r\n                                <MenuItem key={st.id} value={st.id}>\r\n                                    {`${st.id} - ${st.title}`}\r\n                                </MenuItem>)\r\n                        }\r\n                    </Select>\r\n                </FormControl>\r\n\r\n                {/* TO STORYLET, ONLY AVAILABLE DURING CHOICE CREATION */}\r\n                {\r\n                    (data.compType === 'CH') &&\r\n                    <FormControl variant=\"outlined\" className=\"flex mt-15\">\r\n                        <InputLabel id=\"select-to-storylet\">To storylet</InputLabel>\r\n                        <Select\r\n                            labelId=\"select-to-storylet\"\r\n                            value={data.toSTID}\r\n                            onChange={handleChange}\r\n                            label=\"To storylet\"\r\n                            name=\"toSTID\"\r\n                            fullWidth\r\n                            size=\"small\"\r\n                        >\r\n                            <MenuItem value=\"\">\r\n                                <em>None</em>\r\n                            </MenuItem>\r\n                            {\r\n                                Object.values(storylets).map(st =>\r\n                                    <MenuItem key={st.id} value={st.id}>\r\n                                        {`${st.id} - ${st.title}`}\r\n                                    </MenuItem>)\r\n                            }\r\n                        </Select>\r\n                    </FormControl>\r\n                }\r\n            </Box>\r\n\r\n            <Box className={classes.btnPanel}>\r\n                <Button variant=\"outlined\" color=\"primary\"\r\n                    onClick={handleClose}\r\n                >\r\n                    Cancel\r\n                </Button>\r\n\r\n                <Button variant=\"contained\" color=\"primary\"\r\n                    onClick={handleCreate}\r\n                >\r\n                    Create\r\n                </Button>\r\n            </Box>\r\n\r\n        </SimpleModal>\r\n    )\r\n}\r\n\r\nexport default ModalCreateComponent","import {\r\n    FLOW_ST_WIDTH,\r\n    FLOW_ST_HEIGHT,\r\n    FLOW_WIRE_SHIFT_X,\r\n    FLOW_WIRE_SHIFT_FROM_Y,\r\n    FLOW_WIRE_SHIFT_TO_Y,\r\n    FLOW_H_GAP,\r\n    FLOW_V_GAP,\r\n    FLOW_H_SHIFT,\r\n    FLOW_V_SHIFT\r\n} from '../../../utils/constants'\r\n\r\nexport {\r\n    createFlowboard, \r\n    getTransformStyle,\r\n    createFlowConnectors\r\n}\r\n\r\nfunction createFlowboard (storylets, choices) {\r\n    let levelsSTMap = createLevelSTMap(storylets, choices)\r\n    let stxy = setStoryletXY(levelsSTMap, true)\r\n\r\n    return stxy\r\n}   \r\n\r\n/**\r\n * Create a Level Map, to help paint Storylet Boxes on screen\r\n * {\r\n *      1: [stID1, stID9],\r\n *      2: [stID3, stID5, stID7, stID11]\r\n *      3: [stID23, stID77, stID89, stID99, stID100]\r\n * }\r\n */\r\nfunction createLevelSTMap (storylets, choices) {\r\n    let levelsSTMap = {}\r\n\r\n    // get the Entry Storylets\r\n    // This entry-storylets each will start a new tree\r\n    // and then following next of each one we can draw their trees\r\n    let allStIDs = Object.keys(storylets)\r\n    let entryStIDs = getEntryStIDs(allStIDs, choices)\r\n\r\n    // Let's declare a helper function to put Storylets into Levels, recurssively\r\n    const putStIntoLevels = (st, level) => {\r\n        levelsSTMap[level] = levelsSTMap[level] || []\r\n        levelsSTMap[level].push(st.id)\r\n\r\n        for (let cid of st.choices) {\r\n            let c = choices[cid]\r\n            putStIntoLevels(storylets[c.next], level + 1)\r\n        }\r\n    }\r\n\r\n    // Now go thru each entry points and seek out their tree\r\n    // and put them in levelMaps\r\n    for (let id of entryStIDs) {\r\n        //Increase level by 1\r\n        let currentLevel = Object.keys(levelsSTMap).length + 1\r\n\r\n        putStIntoLevels(storylets[id], currentLevel)\r\n    }\r\n\r\n    // Now there can be cases where 2 different levels are containing same IDs\r\n    // In these case we will keep them only in the highest level\r\n    let alreadyFoundStIDs = []\r\n    let levelsDecending = Object.keys(levelsSTMap).sort().reverse()\r\n\r\n    for (let l of levelsDecending) {\r\n        //cleanup duplicate in each level\r\n        levelsSTMap[l] = Array.from(new Set(levelsSTMap[l]))\r\n\r\n        // go thru each stIDs of this level\r\n        // if it was already found in higher levels, delete it from this level\r\n        // else mark it as found\r\n        for (let stID of levelsSTMap[l]) {\r\n            if (alreadyFoundStIDs.indexOf(stID) > -1) {\r\n                levelsSTMap[l].splice(levelsSTMap[l].indexOf(stID), 1)\r\n            }\r\n            else {\r\n                alreadyFoundStIDs.push(stID)\r\n            }\r\n        }\r\n    }\r\n\r\n    return levelsSTMap\r\n}\r\n\r\n// Storylets are Not pointed by any choice\r\n// returns array of STIDs\r\nfunction getEntryStIDs(allStIDs, choices) {\r\n    let entryStIDs = [...allStIDs]\r\n    // now loop thru all the choices\r\n    // remove the choice.next IDs from allStIDs\r\n    // the rests are EntrySTID\r\n    for (let i in choices) {\r\n        let idx = entryStIDs.indexOf(choices[i].next)\r\n        if (idx > -1) {\r\n            entryStIDs.splice(idx, 1)\r\n        }\r\n    }\r\n\r\n    return entryStIDs\r\n}\r\n\r\n/*\r\n* Set X, Y for the storylets VERSION 2\r\n* This v2 function will try position them better\r\n* with proper middle alignments for the row which have lesser number of rectangles\r\n*/\r\nfunction setStoryletXY (levelsSTMap, isAutoFormatting) {\r\n    //go level by level\r\n    let level = 0\r\n    const stWidth = FLOW_ST_WIDTH\r\n    const stHeight = FLOW_ST_HEIGHT\r\n    const horizontalGap = FLOW_H_GAP\r\n    const verticalGap = FLOW_V_GAP\r\n    const verticalShift = FLOW_V_SHIFT\r\n    const horizontalShift = FLOW_H_SHIFT\r\n    const stxy = {}              // { id1: {x1,y1}, id2: {x2,y2} }\r\n\r\n    let maxRecInALevel = Object.values(levelsSTMap).reduce(\r\n        (maxLength, l) => maxLength > l.length ? maxLength : l.length\r\n    , 0)\r\n\r\n    //first we need to find the longest possible row\r\n    // for (let i in levelsSTMap) {\r\n    //     maxRecInALevel = (levelsSTMap[i].length > maxRecInALevel) ? levelsSTMap[i].length : maxRecInALevel\r\n    // }\r\n\r\n    const longestRowWidth = (maxRecInALevel * stWidth) + (horizontalGap * (maxRecInALevel - 1));\r\n\r\n    while (true) {\r\n        ++level\r\n        //since there cannot be a jump in level\r\n        //if any number is missing, that means there are\r\n        //no more higher levels\r\n        if (!levelsSTMap[level]) {\r\n            break;\r\n        }\r\n\r\n        let recsInThisLevel = levelsSTMap[level].length;\r\n\r\n        // if less than max, then \r\n        // 1st rec of that row (or level) will have a spacing at its left\r\n        // And last rec will have a spacing at its right\r\n        // so total spacing will be recsInThisLevel+1\r\n        if (recsInThisLevel < maxRecInALevel) {\r\n            let hGap = (longestRowWidth - (recsInThisLevel * stWidth)) / (recsInThisLevel + 1);\r\n            for (let i = 0; i < levelsSTMap[level].length; i++) {\r\n                let stID = levelsSTMap[level][i]\r\n                stxy[stID] = { id: stID }\r\n\r\n                // if autoformatting, then override the x, y values set by user dragging\r\n                if (!isAutoFormatting && stxy[stID].x && stxy[stID].y) { continue; }\r\n                stxy[stID].x = (i * stWidth) + ((i + 1) * hGap) + horizontalShift\r\n                stxy[stID].y = (level - 1) * (stHeight + verticalGap) + verticalShift\r\n                //setTransformStyle(stID)\r\n            }\r\n        }\r\n        // else for the longest row, there will be no gap with on left of 1st or right of last\r\n        else {\r\n            for (let i = 0; i < levelsSTMap[level].length; i++) {\r\n                let stID = levelsSTMap[level][i]\r\n                stxy[stID] = { id: stID }\r\n\r\n                if (!isAutoFormatting && stxy[stID].x && stxy[stID].y) { continue; }\r\n                stxy[stID].x = (i * stWidth) + (i * horizontalGap) + horizontalShift;\r\n                stxy[stID].y = (level - 1) * (stHeight + verticalGap) + verticalShift;\r\n                //setTransformStyle(stID);\r\n            }\r\n        }\r\n    }\r\n\r\n    setTransformStyle(stxy)\r\n\r\n    //this.flowboard = objToArray(this.stObj);\r\n    // console.log(\"this.storylets = \");\r\n    // console.log(this.storylets);\r\n    \r\n    //this.recreateConnectorsObj();\r\n    return stxy\r\n}\r\n\r\n// provided it has x,y\r\n// this function sets the transformStyle\r\nfunction setTransformStyle(stxy) {\r\n    for (let i in stxy) {\r\n        stxy[i].transformStyle =  getTransformStyle(stxy[i])\r\n    }\r\n}\r\n\r\n// fbi = Flowboard Item\r\nfunction getTransformStyle (fbi) {\r\n    return { transform: \"matrix(1, 0, 0, 1, \" + fbi.x + \", \" + fbi.y + \")\" }\r\n}\r\n\r\n/**\r\n * \r\n * @param {*} storylets \r\n * @param {*} choices \r\n * @param {*} fb => flowboard, a json onject containing stID, x,y, transformStyle\r\n */\r\nfunction createFlowConnectors (storylets, choices, fb) {\r\n    const connectorsObj = {}\r\n    const wireShiftFTX = FLOW_WIRE_SHIFT_X\r\n\tconst wireShiftFY = FLOW_WIRE_SHIFT_FROM_Y\r\n    const wireShiftTY = FLOW_WIRE_SHIFT_TO_Y\r\n\r\n    for(let i in storylets) {\r\n        let st = storylets[i]\r\n        for(let cID of st.choices) {\r\n            let ch = choices[cID]\r\n\r\n            let fromX = fb[st.id].x + wireShiftFTX\r\n            let fromY = fb[st.id].y + wireShiftFY\r\n            let toX = fb[ch.next].x + wireShiftFTX\r\n            let toY = fb[ch.next].y + wireShiftTY\r\n\r\n            let ftid = st.id + '---' + ch.next\r\n\r\n            connectorsObj[ftid] = {\r\n                id: ftid,\r\n                cid: cID,\r\n                x1: fromX,\r\n                y1: fromY,\r\n                x2: toX,\r\n                y2: toY\r\n            }\r\n        }\r\n    }\r\n\r\n    return connectorsObj\r\n}","export enum E_NOTIF_TYPE {\r\n    SIMPLE=\"SIMPLE\", ACTION=\"ACTION\"\r\n}\r\n\r\nexport enum E_NOTIF_NAME {\r\n    SOMEONE_FOLLOWED_YOU = 'SOMEONE_FOLLOWED_YOU',\r\n    FAV_AUTHOR_PUBLISHED = 'FAV_AUTHOR_PUBLISHED',\r\n    LINK_A_TALE_REQUEST = 'LINK_A_TALE_REQUEST'\r\n}\r\n\r\ntype TNotifBaseType = {\r\n    _id: string\r\n    doC: number,\r\n    name: E_NOTIF_NAME,\r\n    type: E_NOTIF_TYPE,\r\n    forEmails: string[]   // All the emailIDs from whom this notification is applicable \r\n}\r\n\r\nexport type TNotifSomeoneFollowed = TNotifBaseType & {\r\n    followerName: string,\r\n    followerID: string\r\n}\r\n\r\nexport type TNotifFavAuthorPublished = TNotifBaseType & {\r\n    publisherName: string,\r\n    publisherID: string,\r\n    storyName: string,\r\n    storyUrl: string\r\n}\r\n\r\nexport type TNotifLinkATaleRequest = TNotifBaseType & {\r\n    requestorEmail: string,\r\n    requestorName: string,\r\n    requestorID: string,\r\n    fromUrl: string,\r\n    fromStoryName: string,\r\n    fromStoryUrl: string,\r\n    fromStID: string,\r\n    toUrl: string,\r\n    choiceTxt: string\r\n}\r\n\r\nexport type TNotif = TNotifLinkATaleRequest | TNotifFavAuthorPublished | TNotifSomeoneFollowed\r\n","import React, { useState, useEffect, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles, Box } from '@material-ui/core'\r\nimport _ from 'lodash'\r\nimport { connect } from 'react-redux'\r\nimport ControlPanel from './controlPanel/ControlPanel'\r\nimport JoyStick from './controlPanel/JoyStick'\r\nimport FlowST from './FlowST'\r\nimport FlowConnector from './FlowConnector'\r\nimport ModalEditChoice from './ModalEditChoice'\r\nimport ModalCreateComponent from './controlModals/ModalCreateComponent'\r\nimport FullScreenEdit from '../../common/modal/FullScreenEdit'\r\nimport { createFlowboard, getTransformStyle, createFlowConnectors } from './flowMaker'\r\nimport {\r\n    actionCreateNewTale,\r\n    actionCreateChoice,\r\n    actionUpdateCText\r\n} from '../../../redux/actionCreators/createTaleActions'\r\nimport {\r\n    FLOW_WIRE_SHIFT_X,\r\n    FLOW_WIRE_SHIFT_FROM_Y,\r\n    FLOW_WIRE_SHIFT_TO_Y,\r\n    FLOW_SPEED,\r\n    CONST_TITLE\r\n} from '../../../utils/constants'\r\nimport { STORYBOARD_INIT, STORYLET_DELETE, CHOICE_DELETE } from '../../../redux/actionTypes'\r\nconst { notify, hideLoader } = window\r\n\r\nconst MODAL_IDS = {\r\n    CREATE_COMPONENT: \"CREATE_COMPONENT\"\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    outerContainer: {\r\n        position: 'relative',\r\n        marginLeft: 35,\r\n        paddingTop: 7,\r\n        height: \"calc(100vh - 100px)\"\r\n    },\r\n    svgContainer: {\r\n        border: `7px double ${theme.palette.primary.main}`,\r\n        height: \"100%\",\r\n        overflow: \"auto\",\r\n        borderRadius: theme.spacing(1)\r\n    },\r\n    mainSVG: {\r\n        height: 2000,\r\n        minWidth: \"100%\",\r\n        width: 2000,\r\n        \"-webkit-user-select\": \"none\",  /* Chrome all / Safari all */\r\n        \"-moz-user-select\": \"none\",     /* Firefox all */\r\n        \"-ms-user-select\": \"none\",      /* IE 10+ */\r\n        userSelect: \"none\",\r\n        borderRadius: 15,\r\n        \"& *\": {\r\n            \"-webkit-user-select\": \"none\",  /* Chrome all / Safari all */\r\n            \"-moz-user-select\": \"none\",     /* Firefox all */\r\n            \"-ms-user-select\": \"none\",      /* IE 10+ */\r\n            userSelect: \"none\"\r\n        }\r\n    },\r\n    joystick: {\r\n        position: \"absolute\",\r\n        bottom: 83,\r\n        left: 30\r\n    }\r\n}))\r\n\r\nconst TalesFlow = props => {\r\n    const classes = useStyles()\r\n    const { storylets, choices, start, history, createNewTale, initStoryboard,\r\n        deleteStorylet, deleteChoice, createNewChoice, updateChoiceText } = props\r\n    const [fb, setFb] = useState({})    // fb is flowboard object\r\n    const [fbC, setFbC] = useState({})  // fbC is flowboardConnectors object\r\n    const [isJStickVis, setJStickVis] = useState(false)\r\n    const [draggedStID, setDraggedStID] = useState('')\r\n    const [prevMPos, setPrevMPos] = useState({ x: 0, y: 0 })\r\n    const [selectedObj, setSelectedObj] = useState({id: '', type: ''})  // type will be \"ST\" or \"CH\" or \"IN\" or \"OUT\"\r\n    const [editChoiceData, setEditChoiceData] = useState({})\r\n    const [visibleModalID, setVisibleModalID] = useState('') // Only 1 modal visible at once\r\n    const [fseParam, setFSEParam] = useState({})    // Full Screen Edit    \r\n    const closeFSE = () => setFSEParam({})\r\n\r\n    // Update the Page Title    \r\n    useEffect(() => {\r\n        document.title = 'TalesFlow | ' + CONST_TITLE\r\n    }, [])\r\n\r\n    // component is either a St or a Ch object\r\n    const openFSE = (e, activeMode = \"EDIT\") => {\r\n        //console.log(component)\r\n        let component\r\n\r\n        if (!selectedObj.id || selectedObj.type==='IN' || selectedObj.type==='OUT') {\r\n            notify('Select a storylet or choice (connector) to ' + activeMode.toLowerCase())\r\n            return\r\n        }\r\n        else if(selectedObj.id[0] === 'S') component = storylets[selectedObj.id]\r\n        else if(selectedObj.id[0] === 'C') component = choices[selectedObj.id]\r\n\r\n        setFSEParam({\r\n            component, activeMode, isVisible: true\r\n        })\r\n    }\r\n    /**\r\n     * flowBoard: {\r\n     *      stID1: {\r\n     *                  id: stID1,\r\n     *                  x: value,\r\n     *                  y: value,\r\n     *                  transformStyle: someCSSTransformStyle\r\n     *             },\r\n     *      stID2: {\r\n     *                  id: stID2,\r\n     *                  x: value,\r\n     *                  y: value,\r\n     *                  transformStyle: someCSSTransformStyle\r\n     *              }\r\n     * }\r\n     */\r\n    const paintFlowboard = useCallback(() => {\r\n        let flowBoard = createFlowboard(storylets, choices)\r\n        let flowConnectors = createFlowConnectors(storylets, choices, flowBoard)\r\n        // console.log(\"Inside paintFlowboard ............................. flowBoard = \", flowBoard)\r\n        setFb(flowBoard)\r\n        setFbC(flowConnectors)\r\n        hideLoader()\r\n    }, [storylets, choices])\r\n\r\n    useEffect(() => {\r\n        //if a refresh is done on TalesFlow Page\r\n        // Then start creation process from here\r\n        if(!start) {\r\n            createNewTale()\r\n        }\r\n\r\n        paintFlowboard ()\r\n\r\n        // IMPORTANT: BUG FIX\r\n        // While leaving the TalesFlow and going back to the Flat Editor\r\n        // Clear out the Storyboard, because in TalesFlow user might delete a component\r\n        // That is still referenced in Storyboard, and that will cause an error\r\n        return () => initStoryboard()\r\n        \r\n    }, [createNewTale, start, paintFlowboard, initStoryboard])\r\n\r\n    /**\r\n     * It marks selected the entity where user clicks, i.e. rectangle, connector, bud...\r\n     * \r\n     * Sp. Case.\r\n     * When 2 nodes (the buds on rectangles where coonector connects) \r\n     * are clicked consecutively, this function is called.\r\n     * @param {*} id \r\n     * @param {*} type \r\n     */\r\n    const handleSelection = (id, type) => {\r\n        // Special Case:\r\n        // if prev selectedObj was 'out'\r\n        // and this is 'IN'\r\n        // Then create a choice (connection)\r\n        if (selectedObj.type === 'OUT' && type=== 'IN') {\r\n            openEditChoiceModal(selectedObj.id, id)\r\n        }\r\n\r\n        // Common Case:\r\n        // Now update the state i.e. mark this entity as selected\r\n        setSelectedObj({id, type})\r\n    }\r\n\r\n    /**\r\n     * This function opens a modal where user can create / edit \r\n     * the choice (connector) joining from `fromStID` to `toStID`\r\n     * @param {String} fromStID | from-storylet-ID\r\n     * @param {String} toStID | to-storylet-ID\r\n     */\r\n    const openEditChoiceModal = (fromStID, toStID) => {\r\n        let ftid = fromStID + '---' + toStID\r\n        setEditChoiceData({\r\n            isOpen: true,\r\n            fromStID,\r\n            toStID,\r\n            type: fbC[ftid] ? 'Edit' : 'Create',\r\n            text: fbC[ftid] ? choices[fbC[ftid].cid].text : ''\r\n        })\r\n    }\r\n\r\n    const saveEditCreateChoice = (fromStID, toStID, text, type) => {\r\n        // is it create new\r\n        if (type === 'Create') {\r\n            createNewChoice(fromStID, toStID, text)\r\n        }\r\n        else if (type === 'Edit') {\r\n            let ftid = fromStID + '---' + toStID\r\n            let cID = fbC[ftid].cid\r\n            updateChoiceText(cID, text)\r\n        }\r\n        else {\r\n            console.log('Could not understand the type in saveEditCreateChoice')\r\n        }\r\n\r\n        setEditChoiceData({})\r\n    }\r\n\r\n    /**\r\n     * Whenever an ST is dragged/moved, we need to update the associated connectors\r\n     * @param {*} fbi => the updated flowboard item\r\n     */\r\n    const updateConnectors = fbi => {\r\n        let newFBC = {...fbC}\r\n        let wireShiftFTX = FLOW_WIRE_SHIFT_X\r\n        let wireShiftFY = FLOW_WIRE_SHIFT_FROM_Y\r\n        let wireShiftTY = FLOW_WIRE_SHIFT_TO_Y\r\n        // Go thru all the flowboard-Connectors\r\n        // to see with whom this stID is connected\r\n        for(let i in newFBC) {\r\n            let c = newFBC[i]\r\n            let ftidParts = c.id.split('---')   // id is basically ftid\r\n            let fromStID = ftidParts[0]\r\n            let toStID = ftidParts[1]\r\n\r\n            // if from id is this ST\r\n            if (fbi.id === fromStID) {\r\n                c = {...c}\r\n                c.x1 = fbi.x + wireShiftFTX\r\n                c.y1 = fbi.y + wireShiftFY\r\n\r\n                newFBC = {\r\n                    ...newFBC,\r\n                    [c.id]: c\r\n                }\r\n            }\r\n            // elseif to id is this ST\r\n            else if (fbi.id === toStID) {\r\n                c = {...c}\r\n                c.x2 = fbi.x + wireShiftFTX\r\n                c.y2 = fbi.y + wireShiftTY\r\n\r\n                newFBC = {\r\n                    ...newFBC,\r\n                    [c.id]: c\r\n                }\r\n            }\r\n        }\r\n\r\n        setFbC(newFBC)\r\n    }\r\n    \r\n    const markDraggedStID = (ev, stID) => {\r\n        ev.stopPropagation()\r\n        // console.log('setDraggedStID')\r\n        setDraggedStID(stID)\r\n        setPrevMPos({ x: ev.pageX,  y: ev.pageY })\r\n    }\r\n\r\n    const unmarkDraggedStID = ev => {\r\n        ev.stopPropagation()\r\n        // console.log('unsetDraggedStID')\r\n        setDraggedStID('')\r\n        setPrevMPos({ x: 0,  y: 0 })\r\n    }\r\n\r\n    const moveST = (stID, xDisplace, yDisplace) => {\r\n        if (!stID || !fb[stID]) return   // Important, don't remove\r\n        let prevElX = fb[stID].x\r\n        let prevElY = fb[stID].y\r\n        let newFBI = {\r\n            id: stID,\r\n            x: prevElX + xDisplace,\r\n            y: prevElY + yDisplace\r\n        }\r\n        newFBI.transformStyle = getTransformStyle(newFBI)\r\n        let newFB = {\r\n            ...fb,\r\n            [stID]: newFBI\r\n        }\r\n        setFb(newFB)\r\n\r\n        //ALSO NEED TO UPDATE THE CONNECTORS POSITION\r\n        updateConnectors(newFBI)\r\n    }\r\n\r\n    const moveDraggetST = _.throttle(ev => {\r\n        //ev.stopPropagation()\r\n        // console.log(\"moving 1\")\r\n        if (draggedStID) {\r\n            // console.log(\"moving 2\")\r\n            let mouseDiffX = ev.pageX - prevMPos.x\r\n            let mouseDiffY = ev.pageY - prevMPos.y\r\n            moveST(draggedStID, mouseDiffX, mouseDiffY)\r\n            setPrevMPos({ x: ev.pageX,  y: ev.pageY })\r\n        }\r\n    }, 1000)\r\n\r\n    const moveWithJStick = (xDisplace, yDisplace) => {\r\n        if (selectedObj.type === 'ST') {\r\n            moveST(selectedObj.id, xDisplace, yDisplace)\r\n        }\r\n    }\r\n\r\n    const moveLeft = () => moveWithJStick(-FLOW_SPEED, 0)\r\n    const moveRight = () => moveWithJStick(FLOW_SPEED, 0)\r\n    const moveUp = () => moveWithJStick(0, -FLOW_SPEED)\r\n    const moveDown = () => moveWithJStick(0, FLOW_SPEED)\r\n\r\n    const deleteComponent = () => {\r\n        if (!selectedObj.id || selectedObj.type==='IN' || selectedObj.type==='OUT') {\r\n            notify('Select a storylet or choice (connector) first. Then click on delete.')\r\n        }\r\n        else if(selectedObj.id === start) {\r\n            notify('Start storylet can not be deleted. Please edit it to your choice.')\r\n        }\r\n        else {\r\n            let comName = ''\r\n            if(selectedObj.id[0] === 'S') comName = 'STORYLET'\r\n            else if(selectedObj.id[0] === 'C') comName = 'CHOICE'\r\n\r\n            let r = window.confirm(`Are you sure you want to delete ${comName} ${selectedObj.id}. Once deleted, it may not be recovered back.`)\r\n\r\n            if (r) {\r\n                if(comName === 'STORYLET') deleteStorylet(selectedObj.id)\r\n                else if (comName === 'CHOICE') deleteChoice(selectedObj.id)\r\n            }\r\n        }\r\n    }\r\n\r\n    // If props have changed, but useEffect has not updated flowboard yet\r\n    // stop the rendering\r\n    if (\r\n            Object.keys(storylets).length !== Object.keys(fb).length\r\n            ||\r\n            Object.keys(choices).length !== Object.keys(fbC).length\r\n        ) {\r\n        return (\r\n            <Box>\r\n                {/* {console.log('Stopping early rendering...')} */}\r\n                Updating ...\r\n            </Box>\r\n        )\r\n    }\r\n\r\n    // Else return\r\n    return (\r\n        <Box>\r\n            <ControlPanel \r\n                history={history} \r\n                deleteComponent={deleteComponent} \r\n                paintFlowboard={paintFlowboard}\r\n                toggleJStick={() => setJStickVis(!isJStickVis)}\r\n                openFSE={openFSE}\r\n                openCreateComponent={() => setVisibleModalID(MODAL_IDS.CREATE_COMPONENT)}\r\n            />\r\n\r\n            <div className={classes.outerContainer}>\r\n                <div className={classes.svgContainer} onClick={() => setSelectedObj({})}>\r\n                    <svg \r\n                        className={classes.mainSVG} \r\n                        onMouseUp={e => unmarkDraggedStID(e)}\r\n                    >\r\n                        {\r\n                            Object.values(fbC).map(c => \r\n                                <FlowConnector \r\n                                    c={c} key={c.id} \r\n                                    selectedObj={selectedObj}\r\n                                    handleSelection={handleSelection}\r\n                                />\r\n                            )\r\n                        }\r\n                        \r\n                        {\r\n                            //console.log(\"props.storylets\", storylets)\r\n                            Object.values(fb).map(fbi => {\r\n                                let st = storylets[fbi.id]\r\n                                return (<FlowST \r\n                                            stid={st.id} \r\n                                            title={st.title} \r\n                                            transformStyle={fbi.transformStyle}\r\n                                            start={start} \r\n                                            key={st.id}\r\n                                            selectedObj={selectedObj}\r\n                                            handleSelection={handleSelection}\r\n                                            handleMouseDown={markDraggedStID}\r\n                                            handleMouseUp={unmarkDraggedStID}\r\n                                            handleMouseMove={moveDraggetST}\r\n                                        />)\r\n                            })\r\n                        }\r\n                    </svg>\r\n                </div>\r\n\r\n                <div className={clsx(classes.joystick, !isJStickVis && 'hide')}>\r\n                    <JoyStick \r\n                        moveLeft={moveLeft}\r\n                        moveRight={moveRight}\r\n                        moveUp={moveUp}\r\n                        moveDown={moveDown}\r\n                    />\r\n                </div>\r\n            </div>\r\n        \r\n            <ModalEditChoice \r\n                isOpen={editChoiceData.isOpen} \r\n                {...editChoiceData}\r\n                handleClose={()=>setEditChoiceData({})}\r\n                handleSave={saveEditCreateChoice}\r\n            />\r\n\r\n            <FullScreenEdit \r\n                isOpen={fseParam.isVisible}\r\n                activeMode={fseParam.activeMode}\r\n                handleClose={closeFSE}\r\n                component={fseParam.component}\r\n            />\r\n\r\n            <ModalCreateComponent \r\n                isOpen={visibleModalID === MODAL_IDS.CREATE_COMPONENT}\r\n                handleClose={() => setVisibleModalID('')}\r\n                storylets={storylets}\r\n                openEditChoiceModal={openEditChoiceModal}\r\n                createNewChoice={createNewChoice}\r\n            />\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    start: state.wipTale.start,\r\n    storylets: state.wipTale.storylets,\r\n    choices: state.wipTale.choices\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    createNewTale: () => dispatch(actionCreateNewTale()),\r\n    initStoryboard: () => dispatch({ type: STORYBOARD_INIT }),\r\n    deleteStorylet: stID => dispatch({ type: STORYLET_DELETE, payload: stID }),\r\n    deleteChoice: cID => dispatch({type: CHOICE_DELETE, payload: cID}),\r\n    createNewChoice: (fromStID, toStID, text) => dispatch(actionCreateChoice(fromStID, toStID, text)),\r\n    updateChoiceText: (cID, value) => dispatch(actionUpdateCText(cID, value))\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TalesFlow)","import React, { useState, useEffect } from 'react'\r\nimport { TextField, Box, Grid}  from '@material-ui/core'\r\nimport ComplexCard from '../../common/cards/ComplexCard'\r\nimport { LOCAL_TALE_IDENTIFIER } from '../../../utils/constants'\r\nimport { getOfflineSavedTales, deleteOneOfflineSavedTales } from '../../../services/offlinesavedtales.service'\r\nconst notify = window['notify']\r\n\r\nconst MyLocalTales = props => {\r\n    // const classes = useStyles()\r\n    const [localTales, setLocalTales] = useState([])\r\n    const [filterTxt, setFilterTxt] = useState('')\r\n    const {history} = props\r\n    \r\n    const localLocalTales = () => {\r\n        const allReactales = getOfflineSavedTales()\r\n        setLocalTales(Object.values(allReactales))\r\n    }\r\n\r\n    useEffect(() => {\r\n        localLocalTales()\r\n    }, [])\r\n\r\n    const goTo = url => history.push(url)\r\n    const goToTale = id => goTo(`/preview/${LOCAL_TALE_IDENTIFIER}${id}`, '/preview/[id]')\r\n    const goToEditTale = id => goTo(`/edit-tale/${LOCAL_TALE_IDENTIFIER}${id}`, '/edit-tale/[id]')\r\n\r\n    const deleteTale = id => {\r\n        if(!window.confirm('Are you sure you want to delete this local tale. It can not be recovered later (unless you have exported it and import it later)')) return\r\n        \r\n        let allReactales = deleteOneOfflineSavedTales(id)\r\n        setLocalTales(Object.values(allReactales))\r\n        notify('Local tale deleted successfully')\r\n    }\r\n\r\n    return (\r\n        <Box py={3}>\r\n            <Grid container spacing={2}>\r\n                {\r\n                    localTales.length <= 0 &&\r\n                    <h2>Oops! Looks like you have not saved any tales in your local device</h2>\r\n                }\r\n                {\r\n                    localTales.length > 0 &&\r\n                    <>  \r\n                        <Grid item xs={12}>\r\n                            <form noValidate autoComplete=\"off\" className=\"filter-form\">\r\n                                <TextField \r\n                                    placeholder=\"Type in to filter\"\r\n                                    fullWidth\r\n                                    value={filterTxt}\r\n                                    onChange={e => setFilterTxt(e.target.value)}\r\n                                />\r\n                            </form>\r\n                        </Grid>\r\n                        {\r\n                            localTales\r\n                            .filter(t => \r\n                                Object.values(t.info).join(' ')\r\n                                .toLocaleLowerCase()\r\n                                .includes(filterTxt.toLocaleLowerCase())\r\n                            )\r\n                            .map (t => (\r\n                                <Grid item xs={12} sm={6} md={4} lg={3} key={t.id}>\r\n                                    <ComplexCard \r\n                                        // id={t.id}\r\n                                        info={t.info} \r\n                                        expandable={false} \r\n                                        handleReadTale={() => goToTale(t.id)}\r\n                                        handleEdit={() => goToEditTale(t.id)}\r\n                                        handleDelete={() => deleteTale(t.id)}  />\r\n                                </Grid>\r\n                            ))\r\n                        }\r\n                    </>\r\n                }\r\n            </Grid>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default MyLocalTales","import React, { useState, useEffect } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { TextField, Box, Grid, Button }  from '@material-ui/core'\r\nimport ComplexCard from '../../common/cards/ComplexCard'\r\nimport { ONLINE_DATA_SAVE_MY_TALES } from  '../../../redux/actionTypes'\r\nimport { GET_MYSTORIES, DELETE_MYTALE } from '../../../utils/urls'\r\nimport { ajaxGet, ajaxPost } from '../../../utils/ajax'\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\nconst { notify, showLoader, hideLoader } = window\r\n\r\n\r\nconst MyOnlineTales = props => {\r\n    // const classes = useStyles()\r\n    // const [localTales, setLocalTales] = useState([])\r\n    const { history, authorEmail, myOnlineTales, cacheMyTales } = props\r\n    const [filterTxt, setFilterTxt] = useState('')\r\n    \r\n    useEffect(() => {\r\n        if(myOnlineTales.length > 0) return\r\n        // if user logs in, check if he has any tales saved online\r\n        if (authorEmail) {\r\n            refreshOnlineTales()\r\n        }\r\n    }, \r\n    [authorEmail])\r\n\r\n    const refreshOnlineTales = () => {\r\n        showLoader()\r\n        ajaxGet(GET_MYSTORIES)\r\n        .then(res => {\r\n            console.log(res.data);\r\n            let { status, tales, msg } = res.data\r\n            if(status === 200) {\r\n                cacheMyTales(tales)\r\n            }\r\n            else {\r\n                notify(msg)\r\n            }\r\n        })\r\n        .finally(() => hideLoader())\r\n    }\r\n\r\n    const goTo = url => history.push(url)\r\n    const goToTale = storyUrl => {\r\n        window.location.href = window.location.origin + '/read/' + storyUrl\r\n    }\r\n    const goToEditTale = id => goTo(`/edit-tale/${id}`)\r\n\r\n    /**\r\n     * When user wants to delet one of his online tale\r\n     * @param {*} storyUrl \r\n     */\r\n    const deleteTale = storyUrl => {\r\n        if(!window.confirm(\"Are you sure you want to delete this tale? Once deleted, it may not be recovered back. (Better export and keep a copy before deleting ...)\")) return\r\n        showLoader()\r\n        ajaxPost(DELETE_MYTALE, { storyUrl })\r\n        .then(res => {\r\n            const { status, msg } = res.data\r\n            notify(msg)\r\n\r\n            // if delete successfull\r\n            // or not found (i.e. previously deleted)\r\n            if(status === 200 || status === 1500) refreshOnlineTales()\r\n        })\r\n        .finally(() => hideLoader())\r\n    }\r\n\r\n    return (\r\n        <Box py={3}>\r\n            { !authorEmail &&\r\n                <h2>Please login to see your online tales ...</h2>\r\n            }\r\n            { authorEmail && myOnlineTales.length <= 0 && \r\n                <h2>Sorry you do not have any tales saved online ...</h2>\r\n            }\r\n            {\r\n                authorEmail && myOnlineTales.length > 0 && \r\n                <Grid container spacing={2}>\r\n                    <Grid item xs={12}>\r\n                        <form noValidate autoComplete=\"off\" className=\"filter-form\">\r\n                            <TextField \r\n                                placeholder=\"Type in to filter\"\r\n                                fullWidth\r\n                                value={filterTxt}\r\n                                onChange={e => setFilterTxt(e.target.value)}\r\n                            />\r\n                        </form>\r\n                    </Grid>\r\n                    <Grid item xs={12} className=\"text-right\">\r\n                        <Button\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            size=\"small\"\r\n                            startIcon={<RefreshIcon />}\r\n                            onClick={refreshOnlineTales}\r\n                        >\r\n                            Refresh\r\n                        </Button>\r\n                    </Grid>\r\n                    {\r\n                        myOnlineTales\r\n                        .filter(t => \r\n                            Object.values(t.info).join(' ')\r\n                            .toLocaleLowerCase()\r\n                            .includes(filterTxt.toLocaleLowerCase())\r\n                        )\r\n                        .map (t => (\r\n                            <Grid item xs={12} sm={6} md={4} lg={3} key={t.info.storyUrl}>\r\n                                <ComplexCard \r\n                                    id={t.info.storyUrl}\r\n                                    info={t.info}\r\n                                    expandable={false} \r\n                                    handleReadTale={() => goToTale(t.info.storyUrl)}\r\n                                    handleEdit={() => goToEditTale(t.info.storyUrl)}\r\n                                    handleDelete={() => deleteTale(t.info.storyUrl)} \r\n                                />\r\n                            </Grid>\r\n                        ))\r\n                    }\r\n                </Grid>\r\n            }\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    myOnlineTales: state.od.myTales\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    cacheMyTales: tales => dispatch({type: ONLINE_DATA_SAVE_MY_TALES, payload: tales})\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MyOnlineTales)","import React, { useState, useEffect } from 'react'\r\nimport { Paper, Tab, Tabs, Box, Typography } from '@material-ui/core'\r\nimport { connect } from 'react-redux'\r\nimport MyLocalTales from './MyLocalTales'\r\nimport MyOnlineTales from './MyOnlineTales'\r\nimport { CONST_TITLE } from '../../../utils/constants'\r\n\r\nconst MyTales = props => {\r\n    const [visibleTabIndex, setVisibleTab] = useState(0)\r\n    const { history, authorEmail } = props\r\n    \r\n    const handleTabSwitch = (event, newValue) => {\r\n        setVisibleTab(newValue)\r\n    }\r\n\r\n    useEffect(() => {\r\n        document.title = 'My Tales | ' + CONST_TITLE\r\n\r\n        // If user is logged in\r\n        // then default tab is My Online Tales\r\n        if (authorEmail) {\r\n            setVisibleTab(1)\r\n        }\r\n\r\n        window.hideLoader()\r\n    }, [])\r\n\r\n    return (\r\n        <Box py={2}>\r\n            \r\n            <Typography variant=\"h4\" component=\"h1\">\r\n                My Tales\r\n            </Typography>\r\n            \r\n            <Box mt={2} mb={4} className=\"flex-space-between\">\r\n                <Typography variant=\"subtitle1\">\r\n                    Here you will find all the tales created by you\r\n                </Typography>\r\n            </Box>\r\n\r\n            <Paper square>\r\n                <Tabs\r\n                    value={visibleTabIndex}\r\n                    indicatorColor=\"primary\"\r\n                    textColor=\"primary\"\r\n                    onChange={handleTabSwitch}\r\n                    centered\r\n                    aria-label=\"tabs to create the story\"\r\n                >\r\n                    <Tab label=\"Local\" />\r\n                    <Tab label=\"Online\" />\r\n                </Tabs>\r\n            </Paper>\r\n            \r\n            <Box className={visibleTabIndex !== 0 ? 'hide' : ''}>\r\n                <MyLocalTales history={history}/>\r\n            </Box>\r\n\r\n            <Box className={visibleTabIndex !== 1 ? 'hide' : ''}>\r\n                <MyOnlineTales history={history} authorEmail={authorEmail} />\r\n            </Box>\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    authorEmail: state.user.email\r\n})\r\nexport default connect(mapStateToProps)(MyTales)","import React, { useState } from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles, Grid, Button } from '@material-ui/core'\r\nimport LocalOfferIcon from '@material-ui/icons/LocalOffer'\r\nimport { config } from '../../../utils/urls'\r\nimport UpArrow from '@material-ui/icons/KeyboardArrowUp'\r\nimport DownArrow from '@material-ui/icons/KeyboardArrowDown'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    bannerImg: {\r\n        maxWidth: '100%',\r\n        maxHeight: 300,\r\n        margin: '0 auto',\r\n        display: 'block',\r\n        background: '#000',\r\n        borderRadius: 4\r\n    },\r\n    titleLine: {\r\n        fontSize: 25,\r\n        margin: '0 0 10px 0'\r\n    },\r\n    genre: {\r\n        borderTop: '1px solid #d5000040',\r\n        paddingTop: 10,\r\n        marginTop: 5\r\n    },\r\n    tags: {\r\n        listStyle: 'none',\r\n        padding: '5px 0 0',\r\n        margin: 0,\r\n        '& > li': {\r\n            padding: '3px 8px',\r\n            margin: '2px 3px',\r\n            background: 'rgba(213, 0, 0, 0.6)',\r\n            color: '#fff',\r\n            fontSize: 12,\r\n            borderRadius: 8,\r\n            display: 'inline-flex',\r\n            alignItems: 'center'\r\n        },\r\n        '& > li > svg': {\r\n            fontSize: 15,\r\n            marginRight: 3\r\n        }\r\n    },\r\n    descSec: {\r\n        position: 'relative',\r\n        margin: '30px 0',\r\n        borderTop: '1px solid #d5000040',\r\n        borderBottom: '10px solid #ffcdd2',\r\n        '& .ico': {\r\n            position: 'absolute',\r\n            top: 25,\r\n            right: 0\r\n        },\r\n        '& .desc': {\r\n            display: 'none'\r\n        },\r\n        '&.open .desc': {\r\n            display: 'block'\r\n        }\r\n    }\r\n}))\r\n\r\n\r\nconst Banner = props => {\r\n    const classes = useStyles()\r\n    const [isDescOpen, setDescOpen] = useState(false)\r\n    const { info, isCutomizable, onCustomize } = props\r\n    \r\n    return (\r\n        <div>\r\n            <Grid container spacing={3}>\r\n                <Grid item xs={12} md={7}>\r\n                    <img src={info.imgUrl ? `/ups/banners/${info.imgUrl}` : config.defaultImg} className={classes.bannerImg} alt=\"Tale Banner Image\" />\r\n                </Grid>\r\n                <Grid item xs={12} md={5}>\r\n                    <h1 className={classes.titleLine}>\r\n                        <span>{info.name}</span>\r\n                    </h1>\r\n                    <div>\r\n                        <div>{info.authorDisplayName || 'Reactale Author'}</div>\r\n                        <div className={classes.genre}>Genre: {info.genre}</div>\r\n\r\n                        <ul className={classes.tags}>\r\n                            {\r\n                                (Array.isArray(info.tags) ? info.tags : info.tags.split(',')).map(tag =>\r\n                                    <li key={tag}>\r\n                                        <LocalOfferIcon />\r\n                                        {tag}\r\n                                    </li>\r\n                                )\r\n                            }\r\n                        </ul>\r\n                    </div>\r\n                    <div>\r\n                        { isCutomizable &&\r\n                        <Button\r\n                            variant=\"outlined\"\r\n                            color=\"primary\"\r\n                            className=\"mt-15\"\r\n                            fullWidth\r\n                            size=\"small\"\r\n                            onClick={onCustomize}\r\n                        >\r\n                            Customize and Gift\r\n                        </Button>\r\n                        }\r\n                    </div>\r\n                </Grid>\r\n            </Grid>\r\n            <div className={clsx(classes.descSec, isDescOpen && 'open')}>\r\n                <h2 onClick={() => setDescOpen(!isDescOpen)}>Description</h2>\r\n                <span className=\"ico\">\r\n                    {isDescOpen && <UpArrow className='up' />}\r\n                    {!isDescOpen && <DownArrow className='down' />}\r\n                </span>\r\n                <p className=\"desc\">{info.description}</p>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Banner","import React, { useState, useEffect } from 'react'\r\nimport clsx from 'clsx'\r\nimport { Box, TextField, Button, Grid, makeStyles } from '@material-ui/core'\r\nimport { LOCAL_TALE_IDENTIFIER, CONST_TITLE } from '../../../utils/constants'\r\nimport { GET_STORY } from \"../../../utils/urls\";\r\nimport { ajaxGetWPathParams } from '../../../utils/ajax'\r\nimport Banner from './Banner'\r\nimport SimpleModal from '../../common/modal/SimpleModal'\r\nimport {Accordion} from '../../common/misc'\r\nimport KeyboardBackspaceIcon from '@material-ui/icons/KeyboardBackspace';\r\nimport { getOneOfflineSavedTales } from '../../../services/offlinesavedtales.service'\r\nconst notify = window['notify']\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        position: 'relative'\r\n    },\r\n    backBtn: {\r\n        position: 'absolute',\r\n        top: 18,\r\n        left: 2,\r\n        width: 32,\r\n        height: 34,\r\n        borderRadius: '50%',\r\n        background: theme.palette.primary.main,\r\n        color: '#fff'\r\n    }\r\n}))\r\n\r\nconst PreviewTale = props => {\r\n    const [tale, setTale] = useState(null)\r\n    // const [sb, setSB] = useState([])    // sb = Storyboard, sbI[], sbI = { stID, selectedCID }\r\n    const { match, history } = props\r\n    const classes = useStyles()\r\n    // const goTo = (url, as) => history ? history.push(url) : NextRouter.push(as || url, url)\r\n    const [customVars, setCustomVars] = useState({})\r\n    const [isCstmModalVisible, setIsCstmModalVisible] = useState(false)\r\n    const [modifiedVars, setModifiedVars] = useState({})\r\n\r\n    // Update the Page Title    \r\n    useEffect(() => {\r\n        document.title = 'Preview Tale | ' + CONST_TITLE\r\n    }, [])\r\n\r\n    /**\r\n     * When user is entering new value for custom variables\r\n     */\r\n    const onChangeMVar = e => {\r\n        setModifiedVars({\r\n            ...modifiedVars,\r\n            [e.target.name]: e.target.value\r\n        })\r\n    }\r\n\r\n    const applyChangedVars = () => {\r\n        window.rto.setAllVars(modifiedVars)\r\n        //LET THE DOM STABILIZE\r\n        setTimeout(() => {\r\n            window.rto.createTimeline('timelineContainer', tale)\r\n        }, 500)\r\n        notify('Customization successfull ...')\r\n        setIsCstmModalVisible(false)\r\n    }\r\n\r\n    const addStoredReactos = tale => {\r\n        if(tale.reactos && tale.reactos.vars) {\r\n            /**\r\n             * tale.reactos.vars has a structure of\r\n             * vars = {\r\n             *  k1: {\r\n             *       name: 'k1', value: 'v1', userCustomizable: true / false\r\n             *      },\r\n             *  k2: {\r\n             *       name: 'k2', value: 'v2', userCustomizable: true / false\r\n             *      }\r\n             * \r\n             * we need to convert it to\r\n             * vars = { k1: 'v1', k2: 'v2' }\r\n             */\r\n            let vars = {}\r\n            let customizableVars = {}\r\n            Object.values(tale.reactos.vars).forEach(v => {\r\n                vars[v.name] = v.val\r\n\r\n                // also pickup the customizable vars\r\n                if (v.userCustomizable) {\r\n                    customizableVars[v.name] = v\r\n                }\r\n            })\r\n            setCustomVars(customizableVars)\r\n            window.rto.setAllVars(vars)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        // let storyUrl = match.params.id\r\n        let storyUrl = match.params.id\r\n        // If it is a local story\r\n        // Then the ID should start with \"local\"\r\n        if (storyUrl.indexOf(LOCAL_TALE_IDENTIFIER) >= 0) {\r\n            storyUrl = storyUrl.trim().replace(LOCAL_TALE_IDENTIFIER, \"\")\r\n            const theTale = getOneOfflineSavedTales(storyUrl)\r\n            // console.log(theTale)\r\n            setTale(theTale)\r\n            // setSB([{ stID: theTale.id }])\r\n            addStoredReactos(theTale)\r\n            // if(theTale.reactos && theTale.reactos.vars) {\r\n            //     window.rto.setAllVars(theTale.reactos.vars)\r\n            // }\r\n\r\n            //LET THE DOM STABILIZE\r\n            setTimeout(() => {\r\n                document.title = `Preview Tale | ${theTale.info.name} | ` + CONST_TITLE\r\n                window.rto.createTimeline('timelineContainer', theTale)\r\n                window.hideLoader()\r\n            }, 500)\r\n        }\r\n\r\n        // Else fetch it online\r\n        else {\r\n            window.showLoader()\r\n            ajaxGetWPathParams(GET_STORY, [storyUrl])\r\n            .then(res => {\r\n                // console.log(res.data)\r\n                let {status, tale, msg} = res.data\r\n                // console.log(wrapperTale)\r\n                if(status === 200) {\r\n                    // let tale = wrapperTale.tale\r\n                    // tale = JSON.parse(tale)\r\n                    // console.log(tale)\r\n                    setTale(tale)\r\n                    addStoredReactos(tale)\r\n                    // if(tale.reactos && tale.reactos.vars) {\r\n                    //     window.rto.setAllVars(tale.reactos.vars)\r\n                    // }\r\n\r\n                    //LET THE DOM STABILIZE\r\n                    setTimeout(() => {\r\n                        document.title = `Preview Tale | ${tale.info.name} | ` + CONST_TITLE\r\n                        window.rto.createTimeline('timelineContainer', tale)\r\n                    }, 500)\r\n                }\r\n                else {\r\n                    // console.log(\"most probably some error occurred\")\r\n                    notify(msg)\r\n                }\r\n            })\r\n            .catch(err =>{\r\n                console.log(err)\r\n            })\r\n            .finally(() => window.hideLoader())\r\n        }\r\n    },\r\n    [match])\r\n\r\n    const goBack = () => history.goBack()\r\n\r\n    if(!tale) return <div>Loading tale ...</div>\r\n\r\n    return (\r\n        <Box py={2} mb={5} className={clsx(classes.root, 'dev-mode')}>\r\n            {\r\n                <Banner \r\n                    info={tale.info} \r\n                    isCutomizable={Object.values(customVars).length > 0}\r\n                    onCustomize={() => setIsCstmModalVisible(true)}\r\n                />\r\n            }\r\n\r\n            <KeyboardBackspaceIcon onClick={goBack} className={classes.backBtn} />\r\n\r\n            <h2>{tale.info.name}</h2>\r\n            <div id=\"timelineContainer\"></div>\r\n\r\n            {/* Gift a tale feature */}\r\n            <SimpleModal \r\n                isOpen={isCstmModalVisible}\r\n                handleClose={() => setIsCstmModalVisible(false)}\r\n                title=\"Gift-a-Tale\"\r\n                // className={classes.loginModal}\r\n            >\r\n                {\r\n                    Object.values(customVars).map( (cv, i) => (\r\n                        <Accordion title={'Custom Variable ' + (i+1) } className=\"mt-5\" key={cv.name}>\r\n                            <Box>{cv.helptext}</Box>\r\n                            <Box mt={1}>Current Value: {cv.val}</Box>\r\n                            <Box mt={1}>\r\n                                <div>New Value</div>\r\n                                <TextField\r\n                                    multiline\r\n                                    name={cv.name}\r\n                                    rows=\"2\"\r\n                                    variant=\"outlined\"\r\n                                    fullWidth\r\n                                    value={modifiedVars[cv.name]}\r\n                                    onChange={onChangeMVar}\r\n                                />\r\n                            </Box>\r\n                        </Accordion>\r\n                    ))\r\n                }\r\n\r\n                <Grid container spacing={1}>\r\n                        <Grid item xs>\r\n                            <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                className=\"mt-15\"\r\n                                fullWidth\r\n                                size=\"small\"\r\n                                onClick={applyChangedVars}\r\n                            >\r\n                                Apply\r\n                            </Button>\r\n                        </Grid>\r\n                        <Grid item xs>\r\n                            <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                className=\"mt-15\"\r\n                                fullWidth\r\n                                size=\"small\"\r\n                                onClick={() => notify('Sorry, this feature is not available in Preview Mode')}\r\n                            >\r\n                                Get URL\r\n                            </Button>\r\n                        </Grid>\r\n                    </Grid>\r\n                \r\n            </SimpleModal>\r\n            \r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default PreviewTale","import React, { useEffect, useState } from 'react'\r\nimport clsx from 'clsx'\r\nimport { InputAdornment, Box, Grid, TextField, Select, Button, Typography,\r\n            FormControl, InputLabel, MenuItem, makeStyles, Tooltip, IconButton\r\n        } from '@material-ui/core'\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline'\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport { COUNTRIES, LANGUAGES, CONST_TITLE } from '../../../utils/constants'\r\nimport { connect } from 'react-redux'\r\nimport { USER_UPDATE } from '../../../redux/actionTypes'\r\nimport { ajaxPost } from '../../../utils/ajax'\r\nimport { UPDATE_USERNAME, UPDATE_MYPROFILE } from '../../../utils/urls'\r\nconst { hideLoader, notify } = window\r\n\r\nconst rtlIDTxt = `ReactaleID is your publicly visible ID (as displaying email publicly is not recommendable). It should be 6 to 20 characters long, can contain letters a to z, numbers 0 to 9, hyphen(-) and underscore(_). Since people will know you by this ID, it is advisable to change it only once and then stick to it forever.`\r\n\r\n// const initUser = {\r\n//     firstname: '',\r\n//     lastname: '',\r\n//     lang1: '',\r\n//     lang2: '',\r\n//     country: '',\r\n//     gender: ''\r\n// }\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    sectionHead: {\r\n        fontSize: 22,\r\n        marginTop: 40,\r\n        borderBottom: `1px solid ${theme.palette.primary.main}`,\r\n        position: 'relative',\r\n        '& .title': {\r\n            position: 'absolute',\r\n            left: 0,\r\n            top: -16,\r\n            background: '#fff',\r\n            paddingRight: 9\r\n        },\r\n        '& .ico': {\r\n            position: 'absolute',\r\n            right: 0,\r\n            top: -22,\r\n            background: '#fff',\r\n            color: theme.palette.primary.main,\r\n            padding: 9,\r\n            cursor: 'pointer'\r\n        }\r\n    },\r\n    usernameTextboxWrap: {\r\n        position: 'relative',\r\n        '& .ico-clear': {\r\n            position: 'absolute',\r\n            top: 6,\r\n            right: 6,\r\n            padding: 4,\r\n            opacity: .6,\r\n            cursor: 'default'\r\n        }\r\n    }\r\n}))\r\n\r\nconst MyProfile = props => {\r\n    const { user, updateUser } = props\r\n    const [tempUser, setTempUser] = useState({})  // in page, unsaved verion of user\r\n    const [isUncollapsed, setIsUnCollapsed] = useState({})\r\n    const classes = useStyles()\r\n\r\n    useEffect(() => {\r\n        document.title = 'My Profile | ' + CONST_TITLE\r\n        hideLoader()\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        setTempUser({ ...user })\r\n    },\r\n    [user])\r\n\r\n    const handleChange = e => {\r\n        let { name, value } = e.target\r\n\r\n        // about me can be only 500 Chars long\r\n        if(name === 'aboutme' && value.length > 500) {\r\n            value = value.substr(0, 500)\r\n        }\r\n        // DOB must be numbers, hyphen and total 10 chars\r\n        // DD-MM-YYYY\r\n        // retain old value\r\n        else if (name === \"dob\" && !/^[0-9-]{0,10}$/.test(value)) {\r\n            value = tempUser[name] || ''\r\n        }\r\n\r\n        setTempUser({\r\n            ...tempUser,\r\n            [name]: value\r\n        })\r\n    }\r\n\r\n    const toggleCollapse = id => {\r\n        setIsUnCollapsed({\r\n            ...isUncollapsed,\r\n            [id]: !isUncollapsed[id]\r\n        })\r\n    }\r\n\r\n    const saveprofile = () => {\r\n        // STEP 1: Call API to save User Online\r\n        console.log('tempUser = ', tempUser)\r\n\r\n        // STEP 2: Then update the redux store\r\n        ajaxPost(UPDATE_MYPROFILE, { user: tempUser, email: tempUser.email })\r\n        .then(res => {\r\n            const { status, updatedUserData, msg } = res.data\r\n            notify(msg)\r\n            if(status === 200) {\r\n                // Update the redux store also...\r\n                updateUser({\r\n                    ...user,\r\n                    ...updatedUserData\r\n                })\r\n            }\r\n        })\r\n        .catch(err => notify(err))\r\n    }\r\n\r\n    const saveUsername = () => {\r\n        const { email, username } = tempUser\r\n        ajaxPost(UPDATE_USERNAME, { email, username })\r\n            .then(res => {\r\n                const { status, info, msg } = res.data\r\n                notify(msg)\r\n\r\n                if (status === 200 && info) {\r\n                    // Update this page's state\r\n                    setTempUser({\r\n                        ...tempUser,\r\n                        username: info.newUsername\r\n                    })\r\n\r\n                    // Update the redux store also...\r\n                    updateUser({\r\n                        ...user,\r\n                        username: info.newUsername\r\n                    })\r\n                }\r\n            })\r\n            .catch(err => notify(err))\r\n    }\r\n\r\n    const clearUsername = () => {\r\n        setTempUser({\r\n            ...tempUser,\r\n            username: user.username\r\n        })\r\n    }\r\n\r\n    return (\r\n        <Box py={2}>\r\n            <Typography variant=\"h4\" component=\"h1\">\r\n                User Profile\r\n            </Typography>\r\n\r\n            {\r\n                !tempUser.email &&\r\n                <Box>Please login to see this page</Box>\r\n            }\r\n\r\n            {\r\n                tempUser.email &&\r\n                <>\r\n                    {/* SECTION 0 */}\r\n                    <div className={classes.sectionHead} onClick={() => toggleCollapse('acc0')}>\r\n                        <span className=\"title\">Account</span>\r\n                        <span className=\"ico\">\r\n                            {!isUncollapsed['acc0'] && <i class=\"fas fa-chevron-up\"></i>}\r\n                            {isUncollapsed['acc0'] && <i class=\"fas fa-chevron-down\"></i>}\r\n                        </span>\r\n                    </div>\r\n                    { isUncollapsed['acc0'] &&\r\n                        <Grid container spacing={2} className=\"mt-25\">\r\n                            <Grid item xs={12}>\r\n                                Reactale ID\r\n                                <Tooltip disableFocusListener title={rtlIDTxt}>\r\n                                    <IconButton aria-label=\"info\">\r\n                                        <InfoIcon />\r\n                                    </IconButton>\r\n                                </Tooltip>\r\n                            </Grid>\r\n                            <Grid item xs={8} className={classes.usernameTextboxWrap}>\r\n                                <TextField\r\n                                    fullWidth\r\n                                    variant=\"outlined\"\r\n                                    value={tempUser.username}\r\n                                    label=\"ReactaleID\"\r\n                                    name=\"username\"\r\n                                    onChange={handleChange}\r\n                                    helperText={`@${tempUser.username}`}\r\n                                    InputProps={\r\n                                        tempUser.username\r\n                                        && !/^[a-z0-9-]{6,20}$/.test(tempUser.username)\r\n                                        && {\r\n                                            endAdornment: <InputAdornment position=\"end\"><ErrorOutlineIcon /></InputAdornment>,\r\n                                        }\r\n                                    }\r\n                                />\r\n                                <CloseIcon className={clsx(\"ico-clear\", user.username === tempUser.username && 'hidden')} onClick={clearUsername} />\r\n                            </Grid>\r\n                            <Grid item xs={4}>\r\n                                <Button\r\n                                    variant=\"contained\"\r\n                                    color=\"primary\"\r\n                                    onClick={saveUsername}\r\n                                    fullWidth\r\n                                    disabled={!/^[a-zA-Z0-9-_]{6,20}$/.test(tempUser.username)}\r\n                                >\r\n                                    Update\r\n                                </Button>\r\n                            </Grid>\r\n                        </Grid>\r\n                    }\r\n\r\n                    {/* SECTION 1 */}\r\n                    <div className={classes.sectionHead} onClick={() => toggleCollapse('acc1')}>\r\n                        <span className=\"title\">Basics</span>\r\n                        <span className=\"ico\">\r\n                            {!isUncollapsed['acc1'] && <i class=\"fas fa-chevron-up\"></i>}\r\n                            {isUncollapsed['acc1'] && <i class=\"fas fa-chevron-down\"></i>}\r\n                        </span>\r\n                    </div>\r\n                    { isUncollapsed['acc1'] &&\r\n                        <Grid container spacing={2} className=\"mt-25\">\r\n                            <Grid item xs={12} sm={6} md={3}>\r\n                                <TextField\r\n                                    fullWidth\r\n                                    variant=\"outlined\"\r\n                                    value={tempUser.firstname}\r\n                                    label=\"First name\"\r\n                                    required\r\n                                    name=\"firstname\"\r\n                                    onChange={handleChange}\r\n                                    InputProps={tempUser.firstname && tempUser.firstname.length <= 0 && {\r\n                                        endAdornment: <InputAdornment position=\"end\"><ErrorOutlineIcon /></InputAdornment>,\r\n                                    }}\r\n                                />\r\n                            </Grid>\r\n                            <Grid item xs={12} sm={6} md={3}>\r\n                                <TextField\r\n                                    fullWidth\r\n                                    variant=\"outlined\"\r\n                                    value={tempUser.lastname}\r\n                                    label=\"Last name\"\r\n                                    required\r\n                                    name=\"lastname\"\r\n                                    onChange={handleChange}\r\n                                    InputProps={tempUser.lastname && tempUser.lastname.length <= 0 && {\r\n                                        endAdornment: <InputAdornment position=\"end\"><ErrorOutlineIcon /></InputAdornment>,\r\n                                    }}\r\n                                />\r\n                            </Grid>\r\n\r\n                            <Grid item xs={12} sm={6} md={3}>\r\n                                <FormControl variant=\"outlined\" fullWidth>\r\n                                    <InputLabel required>\r\n                                        Gender\r\n                            </InputLabel>\r\n                                    <Select\r\n                                        value={tempUser.gender}\r\n                                        fullWidth\r\n                                        onChange={handleChange}\r\n                                        name=\"gender\"\r\n                                    >\r\n                                        <MenuItem value='M'>Male</MenuItem>\r\n                                        <MenuItem value='F'>Female</MenuItem>\r\n                                        <MenuItem value='O'>Other</MenuItem>\r\n                                    </Select>\r\n                                </FormControl>\r\n                            </Grid>\r\n                            <Grid item xs={12} sm={6} md={3}>\r\n                                <FormControl variant=\"outlined\" fullWidth>\r\n                                    <InputLabel required>\r\n                                        Country\r\n                            </InputLabel>\r\n                                    <Select\r\n                                        value={tempUser.country}\r\n                                        fullWidth\r\n                                        onChange={handleChange}\r\n                                        name=\"country\"\r\n                                    >\r\n                                        {\r\n                                            COUNTRIES.map(c => (\r\n                                                <MenuItem value={c} key={c}>\r\n                                                    {c}\r\n                                                </MenuItem>\r\n                                            ))\r\n                                        }\r\n                                    </Select>\r\n                                </FormControl>\r\n                            </Grid>\r\n                            <Grid item xs={12} sm={6} md={3}>\r\n                                <FormControl variant=\"outlined\" fullWidth>\r\n                                    <InputLabel>\r\n                                        Language 1\r\n                            </InputLabel>\r\n                                    <Select\r\n                                        value={tempUser.lang1}\r\n                                        fullWidth\r\n                                        onChange={handleChange}\r\n                                        name=\"lang1\"\r\n                                    >\r\n                                        {\r\n                                            LANGUAGES.map(l => (\r\n                                                <MenuItem value={l} key={l}>\r\n                                                    {l}\r\n                                                </MenuItem>\r\n                                            ))\r\n                                        }\r\n                                    </Select>\r\n                                </FormControl>\r\n                            </Grid>\r\n                            <Grid item xs={12} sm={6} md={3}>\r\n                                <FormControl variant=\"outlined\" fullWidth>\r\n                                    <InputLabel>\r\n                                        Language 2\r\n                                    </InputLabel>\r\n                                    <Select\r\n                                        value={tempUser.lang2}\r\n                                        fullWidth\r\n                                        onChange={handleChange}\r\n                                        name=\"lang2\"\r\n                                    >\r\n                                        {\r\n                                            LANGUAGES.map(l => (\r\n                                                <MenuItem value={l} key={l}>\r\n                                                    {l}\r\n                                                </MenuItem>\r\n                                            ))\r\n                                        }\r\n                                    </Select>\r\n                                </FormControl>\r\n                            </Grid>\r\n                            <Grid item xs={12} sm={6} md={3}>\r\n                                <FormControl variant=\"outlined\" fullWidth>\r\n                                    <InputLabel>\r\n                                        Language 3\r\n                                    </InputLabel>\r\n                                    <Select\r\n                                        value={tempUser.lang3}\r\n                                        fullWidth\r\n                                        onChange={handleChange}\r\n                                        name=\"lang3\"\r\n                                    >\r\n                                        {\r\n                                            LANGUAGES.map(l => (\r\n                                                <MenuItem value={l} key={l}>\r\n                                                    {l}\r\n                                                </MenuItem>\r\n                                            ))\r\n                                        }\r\n                                    </Select>\r\n                                </FormControl>\r\n                            </Grid>\r\n\r\n                            <Grid item xs={12} sm={6} md={3}>\r\n                                <TextField\r\n                                    fullWidth\r\n                                    variant=\"outlined\"\r\n                                    value={tempUser.dob}\r\n                                    label=\"Date of Birth\"\r\n                                    name=\"dob\"\r\n                                    onChange={handleChange}\r\n                                    helperText=\"Only you can see it\"\r\n                                    placeholder=\"DD-MM-YYYY\"\r\n                                />\r\n                            </Grid>\r\n\r\n                            <Grid item xs={12}>\r\n                                <TextField\r\n                                    fullWidth\r\n                                    variant=\"outlined\"\r\n                                    value={tempUser.aboutme}\r\n                                    label=\"About me\"\r\n                                    name=\"aboutme\"\r\n                                    onChange={handleChange}\r\n                                    multiline\r\n                                    helperText={(tempUser.aboutme?.length || 0) + ' / 500'}\r\n                                />\r\n                            </Grid>\r\n                        </Grid>\r\n                    }\r\n\r\n                    {/* SECTION 2 */}\r\n                    <div className={classes.sectionHead} onClick={() => toggleCollapse('acc2')}>\r\n                        <span className=\"title\">Social</span>\r\n                        <span className=\"ico\">\r\n                            {!isUncollapsed['acc2'] && <i class=\"fas fa-chevron-up\"></i>}\r\n                            {isUncollapsed['acc2'] && <i class=\"fas fa-chevron-down\"></i>}\r\n                        </span>\r\n                    </div>\r\n                    { isUncollapsed['acc2'] &&\r\n                        <Grid container spacing={2} className=\"mt-25\">\r\n                            <Grid item xs={12} sm={6} className={classes.usernameTextboxWrap}>\r\n                                <TextField\r\n                                    fullWidth\r\n                                    variant=\"outlined\"\r\n                                    value={tempUser.facebookID}\r\n                                    label=\"Facebook ID\"\r\n                                    name=\"facebookID\"\r\n                                    onChange={handleChange}\r\n                                    helperText={`https://facebook.com/${tempUser.facebookID || ''}`}\r\n                                />\r\n                            </Grid>\r\n                            <Grid item xs={12} sm={6} className={classes.usernameTextboxWrap}>\r\n                                <TextField\r\n                                    fullWidth\r\n                                    variant=\"outlined\"\r\n                                    value={tempUser.twitterID}\r\n                                    label=\"Twitter ID\"\r\n                                    name=\"twitterID\"\r\n                                    onChange={handleChange}\r\n                                    helperText={`https://twitter.com/${tempUser.twitterID || ''}`}\r\n                                />\r\n                            </Grid>\r\n                        </Grid>\r\n                    }\r\n\r\n                    <Box mt={4} className=\"text-right\">\r\n                        <Button\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            onClick={saveprofile}\r\n                        >\r\n                            Save Profile\r\n                        </Button>\r\n                    </Box>\r\n                </>\r\n            }\r\n\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    user: state.user\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    updateUser: user => dispatch({ type: USER_UPDATE, payload: { user } })\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MyProfile)","import { TWindow, TUser, TNotif, TNotifLinkATaleRequest, E_NOTIF_NAME } from '../../../types'\r\n\r\nimport React, { Dispatch, useEffect, useState } from 'react'\r\nimport clsx from 'clsx'\r\nimport { Paper, Box, Grid, Button, Typography, makeStyles } from '@material-ui/core'\r\nimport { connect } from 'react-redux'\r\nimport { USER_UPDATE } from '../../../redux/actionTypes'\r\nimport { EXEC_LINK_A_TALE } from '../../../utils/urls'\r\nimport { CONST_TITLE } from '../../../utils/constants'\r\nimport { ajaxPost } from '../../../utils/ajax'\r\n// import { UPDATE_USERNAME, UPDATE_MYPROFILE } from '../../../utils/urls'\r\nconst { showLoader, hideLoader, notify } = window as TWindow\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    notifBox: {\r\n        marginTop: 25,\r\n        '& .inner': {\r\n            padding: \"10px 15px\"\r\n        },\r\n        '& .title': {\r\n            fontSize: 20,\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'space-between',\r\n            '& .ico': {\r\n                fontSize: 16,\r\n                border: '1px solid #ddd',\r\n                height: 30,\r\n                width: 30,\r\n                display: 'inline-flex',\r\n                justifyContent: 'center',\r\n                alignItems: 'center',\r\n                marginRight: 7,\r\n                color: '#fff',\r\n                background: 'var(--primary-color)',\r\n                borderRadius: 4\r\n            },\r\n            '& .date': {\r\n                color: 'rgb(0 0 0 / 70%)',\r\n                fontSize: 16\r\n            }\r\n        },\r\n        '& .body': {\r\n            lineHeight: '24px',\r\n            '& a': {\r\n                textDecoration: 'none'\r\n            },\r\n            '& .detailed-list': {\r\n                margin: '20px 0 20px 20px',\r\n                '& li': {\r\n                    marginTop: 3,\r\n                    '& .label': {\r\n                        color: 'rgba(0 0 0 / 50%)',\r\n                        fontWeight: 'bold',\r\n                        marginRight: 5\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}))\r\n\r\ntype TProps = {\r\n    user: TUser\r\n}\r\n\r\nconst Notifications = (props: TProps) => {\r\n    const classes = useStyles()\r\n    const [notifs, setNotifs] = useState([] as TNotif[])\r\n    const { user } = props \r\n\r\n    useEffect(() => {\r\n        document.title = 'Notifications | ' + CONST_TITLE\r\n        hideLoader()\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        setNotifs(user.notifs || [])\r\n    },\r\n    [user])\r\n\r\n    const formatDate = (dateInMs: number) => {\r\n        const d = new Date(dateInMs)\r\n        return `${(d.getDate()).toString().padStart(2, '0')}-${(d.getMonth()+1).toString().padStart(2, '0')}/${d.getFullYear()}`\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param { string } execCode \r\n     */\r\n    const executeLinkATale = (id: string, execCode: 'APPROVE' | 'DENY') => {\r\n        const isConfirmed = window.confirm(`Are you sure to ${execCode} ?`)\r\n\r\n        if(isConfirmed) {\r\n            showLoader()\r\n            ajaxPost(EXEC_LINK_A_TALE, { id, execCode })\r\n            .then(res => {\r\n                const { status, msg, _id } = res.data\r\n\r\n                // if the operation is successful,\r\n                // the remove the id returned from the state\r\n                if(_id) setNotifs(notifs.filter(n => n._id !== _id))\r\n\r\n                notify(msg)\r\n            })\r\n            .catch(err => notify(\"Some error occurred ...\"))\r\n            .finally(() => hideLoader())\r\n        }\r\n        \r\n    }\r\n    \r\n\r\n    return (\r\n        <Box py={2}>\r\n            <Typography variant=\"h4\" component=\"h1\">\r\n                Notifications\r\n            </Typography>\r\n\r\n            <Box mt={2}>\r\n                Currently you have {notifs.length} notification(s)!\r\n            </Box>\r\n\r\n            <Box mt={2}>\r\n            {\r\n                notifs.map(notif => <div className={classes.notifBox}>\r\n                    <Paper className=\"inner\" elevation={3}>\r\n                        <Grid container spacing={1}>\r\n                            <Grid item xs={12} className=\"title\">\r\n                                {\r\n                                    notif.name === E_NOTIF_NAME.LINK_A_TALE_REQUEST && \r\n                                    <span>\r\n                                        <i className=\"fas fa-code-branch ico\"></i>\r\n                                        <span>Link A Tale</span>\r\n                                    </span>\r\n                                }\r\n                                <span className=\"date\">\r\n                                    {formatDate(notif.doC)}\r\n                                </span>\r\n                            </Grid>\r\n\r\n                            <Grid item xs={12} className=\"body\">\r\n                                {\r\n                                    notif.name === E_NOTIF_NAME.LINK_A_TALE_REQUEST && \r\n                                    <>\r\n                                        <p>\r\n                                            Hey, you have got a link request !!!\r\n                                        </p>\r\n                                        <p>\r\n                                            <ul className=\"detailed-list\">\r\n                                                <li>\r\n                                                    <span className=\"label\">Sender: </span>\r\n                                                    <a href={`/user/${(notif as TNotifLinkATaleRequest).requestorID}`}>\r\n                                                        {(notif as TNotifLinkATaleRequest).requestorName}\r\n                                                    </a>\r\n                                                </li>\r\n                                                <li>\r\n                                                    <span className=\"label\">From Story: </span>\r\n                                                    <span>{(notif as TNotifLinkATaleRequest).fromStoryName}</span>\r\n                                                </li>\r\n                                                <li>\r\n                                                    <span className=\"label\">From Storylet ID: </span>\r\n                                                    <span>{(notif as TNotifLinkATaleRequest).fromStID}</span>\r\n                                                </li>\r\n                                                <li>\r\n                                                    <span className=\"label\">Start point: </span>\r\n                                                    <a href={`${(notif as TNotifLinkATaleRequest).fromUrl}`} target=\"_blank\">\r\n                                                        Click here to see\r\n                                                    </a>\r\n                                                </li>\r\n                                                <li>\r\n                                                    <span className=\"label\">Choice text: </span>\r\n                                                    <span>{(notif as TNotifLinkATaleRequest).choiceTxt}</span>\r\n                                                </li>\r\n                                                <li>\r\n                                                    <span className=\"label\">End point: </span>\r\n                                                    <a href={`${(notif as TNotifLinkATaleRequest).toUrl}`} target=\"_blank\">\r\n                                                        Click here to see\r\n                                                    </a>\r\n                                                </li>\r\n                                            </ul>\r\n                                        </p>\r\n                                        \r\n                                        <div className=\"text-right\">\r\n                                            <Button \r\n                                                variant=\"contained\" \r\n                                                color=\"primary\"\r\n                                                onClick={() => executeLinkATale(notif._id, 'APPROVE')}\r\n                                            >\r\n                                                Approve\r\n                                            </Button>\r\n                                            <Button \r\n                                                variant=\"outlined\" \r\n                                                color=\"primary\" \r\n                                                className=\"ml-5\"\r\n                                                onClick={() => executeLinkATale(notif._id, 'DENY')}\r\n                                            >\r\n                                                Deny\r\n                                            </Button>\r\n                                        </div>\r\n                                    </>\r\n                                }\r\n                            </Grid>\r\n                        </Grid>\r\n                    </Paper>\r\n                </div>)\r\n            }\r\n            </Box>\r\n\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = (state: { user: TUser }) => ({\r\n    user: state.user\r\n})\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => ({\r\n    updateUser: (user: TUser) => dispatch({ type: USER_UPDATE, payload: { user } })\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Notifications)","import { \r\n    Home, \r\n    CreateTale,\r\n    EditTale, \r\n    TalesFlow, \r\n    MyTales, \r\n    PreviewTale,\r\n    MyProfile,\r\n    Notifications \r\n} from '../components/page-modules'\r\n\r\nconst routes = [\r\n    {\r\n        path: \"/home\",\r\n        component: Home,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/my-profile\",\r\n        component: MyProfile,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/create-tale\",\r\n        component: CreateTale,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/preview/:id\",\r\n        component: PreviewTale,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/edit-tale/:id\",\r\n        component: EditTale,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/tales-flow\",\r\n        component: TalesFlow,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/my-tales\",\r\n        component: MyTales,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/notifications\",\r\n        component: Notifications,\r\n        exact: true\r\n    }\r\n]\r\n\r\nexport default routes","import { VERIFY_EMAIL, RESEND_OTP, UPDATE_NEWPSWD } from '../../../utils/urls'\r\nimport { ajaxPost } from '../../../utils/ajax'\r\n\r\nexport const verfyEmail = async (email, otp) => {\r\n    try {\r\n        const res = await ajaxPost(VERIFY_EMAIL, {email, otp})\r\n        return res.data\r\n    }\r\n    catch(err) {\r\n        return { status: 'FAILED', msg: 'Verification failed' }\r\n    }\r\n}\r\n\r\nexport const resendOTP = async (email, otpType) => {\r\n    try {\r\n        const res = await ajaxPost(RESEND_OTP, {email, otpType})\r\n        return res.data\r\n    }\r\n    catch(err) {\r\n        return { status: 'FAILED', msg: 'Some error occured. Please try again later' }\r\n    }\r\n}\r\n\r\nexport const updateNewPswd = async (email, pswdchangeotp, newpswd) => {\r\n    try {\r\n        const res = await ajaxPost(UPDATE_NEWPSWD, {email, pswdchangeotp, newpswd})\r\n        return res.data\r\n    }\r\n    catch(err) {\r\n        return { status: 'FAILED', msg: 'Some error occured. Please try again later' }\r\n    }\r\n}\r\n","export const OTP_TYPES = {\r\n    SIGNUP_EMAIL_VERIFICATION: 'SIGNUP_EMAIL_VERIFICATION',\r\n    FORGOT_PASSWORD: 'FORGOT_PASSWORD'\r\n}","import React, { useState, useEffect } from 'react'\r\nimport SimpleModal from '../../common/modal/SimpleModal'\r\nimport {\r\n    TextField, Paper, Tabs, Tab, Box, makeStyles, Button,\r\n    Accordion, AccordionSummary, AccordionDetails, Typography\r\n} from '@material-ui/core'\r\nimport { connect } from 'react-redux'\r\nimport { UI_LOGIN_MODAL_CLOSE, UI_LOGIN_SET_ACT_TAB } from '../../../redux/actionTypes'\r\nimport { actionLogin, actionSignup } from '../../../redux/actionCreators/userActions'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport { verfyEmail, resendOTP, updateNewPswd } from './login.service'\r\nimport { OTP_TYPES } from '../../../utils/enums'\r\nimport { isEmailValid, isPasswordValid } from '../../../utils/util'\r\n\r\nconst notify = window['notify']\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    menuButton: {\r\n        marginRight: theme.spacing(2),\r\n    },\r\n    // loginModal: {\r\n    //     maxWidth: 600,\r\n    //     padding: 0\r\n    // },\r\n    heading: {\r\n        fontSize: theme.typography.pxToRem(16),\r\n        fontWeight: theme.typography.fontWeightRegular,\r\n        color: theme.palette.primary.main\r\n    }\r\n}))\r\n\r\nconst LoginModal = props => {\r\n    const classes = useStyles()\r\n    const { isOpen, handleClose, visibleTabIndex, title, changeTab, user, doLogin, doSignup } = props\r\n    const handleTabSwitch = (e, tabIndex) => changeTab(tabIndex)\r\n    const [localUser, setLocalUser] = useState(user || {})\r\n    const [emailVerifyMSG, setEmailVerifyMSG] = useState('')\r\n\r\n    useEffect(() => {\r\n        // console.log(\"Inside useEffect, user changed\")\r\n        if (user) {\r\n            setLocalUser(user)\r\n        }\r\n    }, [user])\r\n\r\n    const isEmailPswdValid = (email, pswd) => {\r\n        if(!email || !isEmailValid(email)) {\r\n            notify('Please enter a valid email address')\r\n            return false\r\n        }\r\n\r\n        if(!pswd || !isPasswordValid(pswd)) {\r\n            return notify('Please enter a valid password of length between 8 to 20 and must have atleast 1 uppercase letter, 1 lowercase, 1 number and 1 special character.')\r\n        }\r\n\r\n        return true\r\n    }\r\n\r\n    const handleLogin = e => {\r\n        e.preventDefault()\r\n        const { email, pswd } = localUser\r\n\r\n        if(isEmailPswdValid(email, pswd)) {\r\n            doLogin({ email, pswd })\r\n        }\r\n    }\r\n\r\n    const handleSignup = e => {\r\n        e.preventDefault()\r\n        const { email, pswd, firstname, lastname } = localUser\r\n        if (!email || !pswd || !firstname || !lastname) {\r\n            notify('Enter Firstname, Lastname Email, Password to login...')\r\n            return\r\n        }\r\n\r\n        if(isEmailPswdValid(email, pswd)) {\r\n            doSignup({ email, pswd, firstname, lastname })\r\n        }\r\n    }\r\n\r\n    const handleVerifyEmail = () => {\r\n        if(!localUser.email || !localUser.emailverifyotp) return notify('Both email and otp are mandatory ...')\r\n            \r\n        else if(isNaN(localUser.emailverifyotp)) return notify('OTP must be numeric')\r\n\r\n        else if(!isEmailValid(localUser.email)) return notify('Enter a valid email address')\r\n\r\n        window.showLoader()\r\n        verfyEmail(localUser.email, localUser.emailverifyotp)\r\n        .then(r => notify(r.msg))\r\n        .catch(err => notify('Some error occured. Please try again later ...'))\r\n        .finally(r => {\r\n            // Hide Loader\r\n            window.hideLoader()\r\n        })\r\n    }\r\n\r\n    const updateLocalUser = e => {\r\n        setLocalUser({\r\n            ...localUser,\r\n            [e.target.name]: e.target.value\r\n        })\r\n    }\r\n\r\n    const sendSignupEmailOTP = e => {\r\n        if(!localUser.email || !isEmailValid(localUser.email)) return notify('Please enter your email address and try again.')\r\n        // SHOW LOADER\r\n        window.showLoader()\r\n        resendOTP(localUser.email, OTP_TYPES.SIGNUP_EMAIL_VERIFICATION)\r\n        .then(r => notify(r.msg))\r\n        .catch(err => notify('Some error occured ...'))\r\n        .finally(() => window.hideLoader())\r\n    }\r\n\r\n    const sendForgotPswdOTP = e => {\r\n        if(!localUser.email || !isEmailValid(localUser.email)) return notify('Please enter your email address and try again.')\r\n        // SHOW LOADER\r\n        window.showLoader()\r\n        resendOTP(localUser.email, OTP_TYPES.FORGOT_PASSWORD)\r\n        .then(r => notify(r.msg))\r\n        .catch(err => notify('Some error occured ...'))\r\n        .finally(() => window.hideLoader())\r\n    }\r\n\r\n    const saveNewPswd = e => {\r\n        if(!localUser.email || !localUser.pswdchangeotp || !localUser.newpswd || !localUser.newpswd1) {\r\n            return notify('Email, OTP, Password and Re-password - all 4 fields are Mandatory to change password.')\r\n        }\r\n\r\n        if(!isEmailPswdValid(localUser.email, localUser.newpswd)) return\r\n\r\n        if(isNaN(localUser.pswdchangeotp)) {\r\n            return notify('OTP must be numeric.')\r\n        }\r\n\r\n        if(localUser.newpswd !== localUser.newpswd1) {\r\n            return notify('Password and Re-password is not matching. Please type again.')\r\n        }\r\n\r\n        window.showLoader()\r\n        updateNewPswd(localUser.email, localUser.pswdchangeotp, localUser.newpswd)\r\n        .then(r => notify(r.msg))\r\n        .catch(err => notify('Some error occured ...'))\r\n        .finally(() => window.hideLoader())\r\n    }\r\n\r\n    return (\r\n        <SimpleModal\r\n            isOpen={isOpen}\r\n            handleClose={handleClose}\r\n            title={title || \"Hi There!\"}\r\n            // className={classes.loginModal}\r\n        >\r\n            <Paper square>\r\n                <Tabs\r\n                    value={visibleTabIndex}\r\n                    indicatorColor=\"primary\"\r\n                    textColor=\"primary\"\r\n                    onChange={handleTabSwitch}\r\n                    centered\r\n                    aria-label=\"tabs to create the story\"\r\n                >\r\n                    <Tab label=\"Sign in\" />\r\n                    <Tab label=\"Sign up\" />\r\n                    <Tab label=\"Manage\" />\r\n                </Tabs>\r\n            </Paper>\r\n\r\n            {/* Sign In Section */}\r\n            <Box className={visibleTabIndex !== 0 ? 'hide' : ''}>\r\n                <form onSubmit={handleLogin}>\r\n                    <TextField label=\"Email\" name=\"email\" value={localUser.email} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" fullWidth className=\"mt-15\" />\r\n                    <TextField label=\"Password\" name=\"pswd\" value={localUser.pswd} onChange={updateLocalUser} type=\"password\" variant=\"outlined\" size=\"small\" fullWidth className=\"mt-15\" />\r\n                    <Button\r\n                        type=\"submit\"\r\n                        variant=\"outlined\"\r\n                        color=\"primary\"\r\n                        className=\"mt-15\"\r\n                        fullWidth\r\n                        onClick={handleLogin}\r\n                    >\r\n                        Sign in\r\n                    </Button>\r\n                </form>\r\n            </Box>\r\n\r\n            {/* Sign Up Section */}\r\n            <Box className={visibleTabIndex !== 1 ? 'hide' : ''}>\r\n                <form onSubmit={handleSignup}>\r\n                    <TextField label=\"First name\" name=\"firstname\" value={localUser.firstname} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" fullWidth className=\"mt-15\" />\r\n                    <TextField label=\"Last name\" name=\"lastname\" value={localUser.lastname} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" fullWidth className=\"mt-15\" />\r\n                    <TextField label=\"Email\" name=\"email\" value={localUser.email} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" fullWidth className=\"mt-15\" />\r\n                    <TextField label=\"Password\" name=\"pswd\" value={localUser.pswd} onChange={updateLocalUser} type=\"password\" variant=\"outlined\" size=\"small\" fullWidth className=\"mt-15\" />\r\n                    <Button\r\n                        type=\"submit\"\r\n                        variant=\"outlined\"\r\n                        color=\"primary\"\r\n                        className=\"mt-15\"\r\n                        fullWidth\r\n                        onClick={handleSignup}\r\n                    >\r\n                        Sign up\r\n                    </Button>\r\n                </form>\r\n            </Box>\r\n\r\n            {/* Manage Section */}\r\n            <Box className={visibleTabIndex !== 2 ? 'hide' : ''}>\r\n\r\n                <Accordion className=\"mui-accordion-override-1 mt-15\">\r\n                    <AccordionSummary expandIcon={<ExpandMoreIcon />}>\r\n                        <Typography className={classes.heading}>\r\n                            Email Verification\r\n                        </Typography>\r\n                    </AccordionSummary>\r\n                    <AccordionDetails>\r\n                        <Box className=\"width-100\" pt={1}>\r\n                            <TextField label=\"Email to Verify\" name=\"email\" value={localUser.email} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" fullWidth />\r\n                            <div className=\"mt-15 flex\" >\r\n                                <TextField label=\"OTP\" name=\"emailverifyotp\" value={localUser.emailverifyotp} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" />\r\n                                <Button\r\n                                    variant=\"contained\"\r\n                                    className=\"ml-5\"\r\n                                    color=\"primary\"\r\n                                    onClick={handleVerifyEmail}\r\n                                >\r\n                                    Verify\r\n                                </Button>\r\n                            </div>\r\n                            <div className=\"mt-15\">\r\n                                Did not receive OTP? <span onClick={sendSignupEmailOTP}><u>Click here</u></span> to resend.\r\n                            </div>\r\n                            { emailVerifyMSG && <div>{emailVerifyMSG}</div> }\r\n                        </Box>\r\n                    </AccordionDetails>\r\n                </Accordion>\r\n\r\n                <Accordion className=\"mui-accordion-override-1\">\r\n                    <AccordionSummary expandIcon={<ExpandMoreIcon />}>\r\n                        <Typography className={classes.heading}>\r\n                            Password Recovery\r\n                        </Typography>\r\n                    </AccordionSummary>\r\n                    <AccordionDetails>\r\n                        <Box className=\"width-100\">\r\n                            <TextField label=\"Signup Email\" name=\"email\" value={localUser.email} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" fullWidth className=\"mt-15\" />\r\n                            <Button\r\n                                variant=\"outlined\"\r\n                                className=\"mt-15\"\r\n                                color=\"primary\"\r\n                                fullWidth\r\n                                onClick={sendForgotPswdOTP}\r\n                            >\r\n                                Send OTP\r\n                            </Button>\r\n\r\n                            <Box className=\"width-100\">\r\n                                <TextField label=\"Enter OTP\" name=\"pswdchangeotp\" value={localUser.pswdchangeotp} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" fullWidth className=\"mt-15\" />\r\n                                <TextField label=\"Type New Password\" name=\"newpswd\" value={localUser.newpswd} onChange={updateLocalUser} type=\"password\" variant=\"outlined\" size=\"small\" fullWidth  className=\"mt-15\" />\r\n                                <TextField label=\"Retype New Password\" name=\"newpswd1\" value={localUser.newpswd1} onChange={updateLocalUser} type=\"password\" variant=\"outlined\" size=\"small\" fullWidth  className=\"mt-15\" />\r\n                                <Button\r\n                                    variant=\"contained\"\r\n                                    className=\"mt-15\"\r\n                                    color=\"primary\"\r\n                                    fullWidth\r\n                                    onClick={saveNewPswd}\r\n                                >\r\n                                    Change Password\r\n                                </Button>\r\n                            </Box>\r\n                        </Box>\r\n                    </AccordionDetails>\r\n                </Accordion>\r\n            </Box>\r\n\r\n        </SimpleModal>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    isOpen: state.ui.isLoginModalOpen,\r\n    visibleTabIndex: state.ui.loginActiveTab,\r\n    user: state.user\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    handleClose: () => dispatch({ type: UI_LOGIN_MODAL_CLOSE }),\r\n    changeTab: tabIndex => dispatch({ type: UI_LOGIN_SET_ACT_TAB, payload: { tabIndex } }),\r\n    doLogin: u => dispatch(actionLogin(u)),\r\n    doSignup: u => dispatch(actionSignup(u))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(LoginModal)","import React from 'react'\r\nimport { ThemeProvider } from '@material-ui/core/styles'\r\nimport Container from '@material-ui/core/Container'\r\nimport { BrowserRouter as Router, Switch, Route, Redirect } from 'react-router-dom'\r\nimport { PersistGate } from 'redux-persist/integration/react'\r\nimport { Provider } from 'react-redux'\r\nimport { store, persistor } from './redux/configStore'\r\nimport theme from './utils/theme'\r\nimport { Header, Sidebard, Footer, Wrapper } from './components/layout'\r\nimport routes from './utils/routes'\r\nimport LoginModal from './components/common/login/LoginModal'\r\n\r\nconst purgePersistedData = () => persistor.purge()\r\n\r\nconst App = () => {\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <Provider store={store}>\r\n        <PersistGate loading={null} persistor={persistor}>\r\n          <Wrapper>\r\n            <Router basename='/r'>\r\n              <header>\r\n                <Header />\r\n              </header>\r\n              <nav>\r\n                <Sidebard purgePersistedData={purgePersistedData} />\r\n              </nav>\r\n              <LoginModal />\r\n              <Container maxWidth=\"lg\" className=\"appbody\">\r\n                <Switch>\r\n                  {\r\n                    routes.map(r =>\r\n                      <Route {...r} key={r.path} />\r\n                    )\r\n                  }\r\n                  <Route path=\"*\">\r\n                    <Redirect to=\"/home\" />\r\n                  </Route>\r\n                </Switch>\r\n              </Container>\r\n              <footer>\r\n                <Footer />\r\n              </footer>\r\n            </Router>\r\n          </Wrapper>\r\n        </PersistGate>\r\n      </Provider>\r\n    </ThemeProvider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n// import * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\n// serviceWorker.unregister();\r\n"],"sourceRoot":""}